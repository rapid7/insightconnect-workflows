# Description

Lookup an AttackerKB exploit to receive exploit details, including a description, exploit references, vulnerable software versions, attacker value, and exploitability score from Microsoft Teams.

Sample Trigger Commands:

`!lookup-vuln CVE-2020-0674`

# Key Features

* Lookup vulnerability exploit information from Microsoft Teams
* Find all vulnerabilities that match a search term
* Get description, disclosure date, attack vector, and vulnerable software versions in an easy to consume Microsoft Teams message

# Requirements

* InsightConnect License
* [Microsoft Teams](https://insightconnect.help.rapid7.com/docs/microsoft-teams)

# Documentation

## Setup

Import the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.

This workflow leverages InsightConnect's Parameters feature. This feature allows variables used multiple times throughout a workflow to be entered once and then referenced throughout the workflow.

There are three parameters you will need to configure in order to complete setup of your workflow:

* Team Name: The Microsoft Teams team name in your environment where the workflow should be triggered and respond
* Channel Name: The Microsoft Teams channel name in your environment where the workflow should be triggered and respond (the channel should exist in the aforementioned team)
* Max Exploits: The number of AttackerKB exploits returned

To begin, select "Parameters" either from the Workflow Control Panel or from the Builder to begin configuration.

After configuring the parameters, activate the workflow in order to trigger it.

## Usage

*This workflow will only trigger in the channel specified in the Microsoft Teams workflow steps.*

To run the workflow, in the channel you are monitoring send a message to Insight Connect using `!lookup-vuln <search term>`.

For example:
* `!lookup-vuln CVE-2020-0674`

## Technical Details

Plugins utilized by workflow:

|Plugin|Version|Count|
|----|----|--------|
|Rapid7 AttackerKB|1.0.3|1|
|Microsoft Teams|3.1.2|7|
|HTML|1.2.2|1|

## Troubleshooting

_There is no troubleshooting information at this time_

# Version History

* 2.0.0 - Leverage Parameters Feature | Remove Settings step | Update documentation | Update screenshots | Update Microsoft Teams plugin to version 3.1.2 | Update HTML plugin to version 1.2.2 | Update Rapid7 AttackerKB plugin to version 1.0.3
* 1.1.0 - Replace the preset text of "change_me" with automatic team and channel name extraction in all Microsoft Teams steps except the first one | Update Microsoft Teams to version 3.1.0 | Update documentation
* 1.0.1 - Update to make Microsoft Teams plugin the latest version
* 1.0.0 - Initial workflow

# Links

## References

* [Rapid7 AttackerKB](https://attackerkb.com)
* [Microsoft Teams](https://teams.microsoft.com)
* [Microsoft Teams Setup](https://insightconnect.help.rapid7.com/docs/microsoft-teams)
