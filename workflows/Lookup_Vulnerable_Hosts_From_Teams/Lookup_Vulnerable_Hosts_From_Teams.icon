{
  "kom": {
    "komandVersion": "1.51.1-0-g1c294",
    "komFileVersion": "2.0.0",
    "exportedAt": "2020-05-28T20:36:28.634674518Z",
    "workflowVersions": [
      {
        "name": "Lookup Vulnerable Hosts from Teams",
        "type": "runnable",
        "version": "",
        "description": "Lookup vulnerability details, including a summary of the vulnerability, the affected software package, the remediation or mitigation step, and a list of affected hosts (up to 100) in the user's environment, from a simple Microsoft Teams message.\n\nCommand to run in any channel that includes your InsightConnect Teams chat bot:\n!lookup-vuln-assets <vulnerability>\n\n<vulnerability> in the command can be any InsightVM vulnerability reference including the following:\n* Vulnerability Name\n* KB Number\n* CVE ID\n* Nexpose ID\n* Other references InsightVM knows",
        "graph": {
          "edges": {
            "048633cb-b96e-4387-a7c8-5f727dbc4d68": {
              "id": "048633cb-b96e-4387-a7c8-5f727dbc4d68",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "aba0b6ae-4529-4827-a085-aeb46aa6affe",
              "toNodeId": "7688a93d-120d-4ca1-b995-46f923398468"
            },
            "061f4ce6-2833-4b31-97b1-78dbbb58fb3e": {
              "id": "061f4ce6-2833-4b31-97b1-78dbbb58fb3e",
              "name": "",
              "description": "",
              "parentNodeId": "db592e51-daa5-44e6-9084-3439b7f09b85",
              "fromNodeId": "db592e51-daa5-44e6-9084-3439b7f09b85",
              "toNodeId": "fb358b1f-bc73-40fb-94bd-e8cc542b1a1f"
            },
            "0abf765e-97aa-419e-aa6a-955c8c9a86ce": {
              "id": "0abf765e-97aa-419e-aa6a-955c8c9a86ce",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "d599008b-dfa4-480b-b370-626dda54dc9e",
              "toNodeId": ""
            },
            "0be91353-c13d-43cc-b755-866e9a00774f": {
              "id": "0be91353-c13d-43cc-b755-866e9a00774f",
              "name": "",
              "description": "",
              "parentNodeId": "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0",
              "fromNodeId": "2da85341-69e4-4009-a565-f5206e4a957b",
              "toNodeId": "b10fffe3-10c1-43fe-86cb-1d089e261ec8"
            },
            "161c157f-a476-49f3-b579-f7b6d46af475": {
              "id": "161c157f-a476-49f3-b579-f7b6d46af475",
              "name": "",
              "description": "",
              "parentNodeId": "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0",
              "fromNodeId": "c760fe51-5590-4129-949f-6caff63ef3b6",
              "toNodeId": "2da85341-69e4-4009-a565-f5206e4a957b"
            },
            "1a5a0ce5-2178-4c10-a8fd-8ae093361292": {
              "id": "1a5a0ce5-2178-4c10-a8fd-8ae093361292",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "7f8e9fef-d3eb-44bb-810f-ed95fa08fc3a",
              "toNodeId": "a5434f0d-592d-4815-8fe9-8719e47ddc43"
            },
            "1c6ca850-5c1d-44bf-becb-a8955e67513f": {
              "id": "1c6ca850-5c1d-44bf-becb-a8955e67513f",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "320f400b-ada3-4f7c-8f57-9b583c6a3b46",
              "toNodeId": "bbf37066-6157-4c03-b44e-780fb223445d"
            },
            "1f327e80-c913-4bf4-bb5d-08e6be449b36": {
              "id": "1f327e80-c913-4bf4-bb5d-08e6be449b36",
              "name": "",
              "description": "",
              "parentNodeId": "db592e51-daa5-44e6-9084-3439b7f09b85",
              "fromNodeId": "fb358b1f-bc73-40fb-94bd-e8cc542b1a1f",
              "toNodeId": "c8f054ac-027f-4183-bf23-a56c692d9e51"
            },
            "20984180-8c91-4bd2-b027-0f6ad0150ffc": {
              "id": "20984180-8c91-4bd2-b027-0f6ad0150ffc",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "674a674b-acec-4bf5-920e-b0fda77e8e86",
              "toNodeId": ""
            },
            "20ab3e84-1edd-498c-aaca-b6a031b1bd44": {
              "id": "20ab3e84-1edd-498c-aaca-b6a031b1bd44",
              "name": "",
              "description": "",
              "parentNodeId": "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0",
              "fromNodeId": "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0",
              "toNodeId": "c760fe51-5590-4129-949f-6caff63ef3b6"
            },
            "2191ca16-d08e-4022-89c6-17d1da13cb9f": {
              "id": "2191ca16-d08e-4022-89c6-17d1da13cb9f",
              "name": "",
              "description": "",
              "parentNodeId": "db592e51-daa5-44e6-9084-3439b7f09b85",
              "fromNodeId": "c8f054ac-027f-4183-bf23-a56c692d9e51",
              "toNodeId": "3070b398-e684-471b-ade0-57f4bea6195c"
            },
            "278aeedf-6481-4d0c-8589-20a51253bf4c": {
              "id": "278aeedf-6481-4d0c-8589-20a51253bf4c",
              "name": "",
              "description": "",
              "parentNodeId": "0d368b5b-d7d0-4041-be73-b1db53a3895a",
              "fromNodeId": "da6747ef-bfcf-46a0-9043-8064c51e8e4a",
              "toNodeId": ""
            },
            "30787b4d-5efa-442a-a77a-7497e34e5afb": {
              "id": "30787b4d-5efa-442a-a77a-7497e34e5afb",
              "name": "Don't Have Vulns",
              "description": "",
              "parentNodeId": "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0",
              "fromNodeId": "3f6935b0-fd23-4af2-8c9f-8d488b967a1f",
              "toNodeId": ""
            },
            "30e4a6c0-a628-44ae-b47a-00e6d4e2cc1d": {
              "id": "30e4a6c0-a628-44ae-b47a-00e6d4e2cc1d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "0d368b5b-d7d0-4041-be73-b1db53a3895a",
              "toNodeId": "053214d3-42db-45b5-a31b-8e1b0d349a47"
            },
            "34f898d3-537a-42f3-b763-07231a2c6c37": {
              "id": "34f898d3-537a-42f3-b763-07231a2c6c37",
              "name": "no",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "24960792-15a3-4df7-b872-d61dc21c4aab",
              "toNodeId": "54fc682b-13f6-4dff-9203-eda074930a20"
            },
            "360a2b6a-8c82-45ce-9b04-26e7edd6747a": {
              "id": "360a2b6a-8c82-45ce-9b04-26e7edd6747a",
              "name": "",
              "description": "",
              "parentNodeId": "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0",
              "fromNodeId": "b10fffe3-10c1-43fe-86cb-1d089e261ec8",
              "toNodeId": "50cd9c41-770d-404c-8571-596254ccd42c"
            },
            "3e4dbe3f-249a-4b1a-9e4f-c884245a126c": {
              "id": "3e4dbe3f-249a-4b1a-9e4f-c884245a126c",
              "name": "yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "027079bd-2f07-4a81-802c-9285225031da",
              "toNodeId": "f36c1b8a-9374-473a-aca3-cd908110529b"
            },
            "3eff898a-1afa-4077-b882-4c47f5b4aebd": {
              "id": "3eff898a-1afa-4077-b882-4c47f5b4aebd",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "54fc682b-13f6-4dff-9203-eda074930a20",
              "toNodeId": ""
            },
            "4727216b-ffcb-4750-896d-5f3136579ebd": {
              "id": "4727216b-ffcb-4750-896d-5f3136579ebd",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "739f03c2-ff98-4e0a-b1a6-f95f240556a8",
              "toNodeId": "5d83b3cc-4351-4b18-aa49-fe7e124319ad"
            },
            "4ff2a8b9-d859-44a2-a2c1-42abee472d49": {
              "id": "4ff2a8b9-d859-44a2-a2c1-42abee472d49",
              "name": "",
              "description": "",
              "parentNodeId": "db592e51-daa5-44e6-9084-3439b7f09b85",
              "fromNodeId": "3070b398-e684-471b-ade0-57f4bea6195c",
              "toNodeId": ""
            },
            "5262e62f-69e5-4885-9c51-2e99b9654416": {
              "id": "5262e62f-69e5-4885-9c51-2e99b9654416",
              "name": "no",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "027079bd-2f07-4a81-802c-9285225031da",
              "toNodeId": "0d368b5b-d7d0-4041-be73-b1db53a3895a"
            },
            "5456e9de-f270-42cf-a467-f4ee456cf75f": {
              "id": "5456e9de-f270-42cf-a467-f4ee456cf75f",
              "name": "Have Vulns",
              "description": "",
              "parentNodeId": "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0",
              "fromNodeId": "3f6935b0-fd23-4af2-8c9f-8d488b967a1f",
              "toNodeId": "db592e51-daa5-44e6-9084-3439b7f09b85"
            },
            "5981c960-9a62-4f14-8bea-2aa0d871abd2": {
              "id": "5981c960-9a62-4f14-8bea-2aa0d871abd2",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a106410d-01bb-4fe6-aebf-4481868efd99",
              "toNodeId": "c87511b7-9abd-4be9-a2b5-7fedcb8a7d70"
            },
            "599b303e-e117-4e70-814b-c62030bda71b": {
              "id": "599b303e-e117-4e70-814b-c62030bda71b",
              "name": "no",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "cef2135a-e641-4c80-8a7b-a0cf5fc464e0",
              "toNodeId": "9f271d1c-aa6d-425d-97e8-2b45449a2eba"
            },
            "59a3e673-03f3-435d-b4c8-ecf6eee4febc": {
              "id": "59a3e673-03f3-435d-b4c8-ecf6eee4febc",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e19ba80b-5d1a-4646-bcdb-3844a9dd04cf",
              "toNodeId": "053214d3-42db-45b5-a31b-8e1b0d349a47"
            },
            "71ecbaac-f2a8-4b26-aa3b-fb1ff55bbd3c": {
              "id": "71ecbaac-f2a8-4b26-aa3b-fb1ff55bbd3c",
              "name": "",
              "description": "",
              "parentNodeId": "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0",
              "fromNodeId": "db592e51-daa5-44e6-9084-3439b7f09b85",
              "toNodeId": "716883b8-7e02-47c7-b261-5791dd1b838f"
            },
            "790fa4e8-9c28-400d-a785-a445db35d39d": {
              "id": "790fa4e8-9c28-400d-a785-a445db35d39d",
              "name": "yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "91f352b5-30eb-4abc-a491-82d860f5de1b",
              "toNodeId": "e19ba80b-5d1a-4646-bcdb-3844a9dd04cf"
            },
            "7c7e9077-5e4f-462d-a0f3-c9a31e1322c1": {
              "id": "7c7e9077-5e4f-462d-a0f3-c9a31e1322c1",
              "name": "yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "24960792-15a3-4df7-b872-d61dc21c4aab",
              "toNodeId": "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0"
            },
            "7dd20817-b45b-4804-a4a3-3eb7b76d2b37": {
              "id": "7dd20817-b45b-4804-a4a3-3eb7b76d2b37",
              "name": "",
              "description": "",
              "parentNodeId": "0d368b5b-d7d0-4041-be73-b1db53a3895a",
              "fromNodeId": "0d368b5b-d7d0-4041-be73-b1db53a3895a",
              "toNodeId": "da6747ef-bfcf-46a0-9043-8064c51e8e4a"
            },
            "7eeea971-1c01-4be9-9953-80df688f2806": {
              "id": "7eeea971-1c01-4be9-9953-80df688f2806",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f36c1b8a-9374-473a-aca3-cd908110529b",
              "toNodeId": ""
            },
            "8c0e3542-315a-4ae9-b32d-d0029fcca528": {
              "id": "8c0e3542-315a-4ae9-b32d-d0029fcca528",
              "name": "yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "cef2135a-e641-4c80-8a7b-a0cf5fc464e0",
              "toNodeId": "053214d3-42db-45b5-a31b-8e1b0d349a47"
            },
            "907cf389-90a8-438c-bde0-b85fdf096ee9": {
              "id": "907cf389-90a8-438c-bde0-b85fdf096ee9",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "7688a93d-120d-4ca1-b995-46f923398468",
              "toNodeId": "a106410d-01bb-4fe6-aebf-4481868efd99"
            },
            "91b8c947-434c-4101-be2b-6e45d0d5d15d": {
              "id": "91b8c947-434c-4101-be2b-6e45d0d5d15d",
              "name": "no",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "91f352b5-30eb-4abc-a491-82d860f5de1b",
              "toNodeId": "739f03c2-ff98-4e0a-b1a6-f95f240556a8"
            },
            "920611f0-4e8f-4b5b-b83f-6ea7bd945be2": {
              "id": "920611f0-4e8f-4b5b-b83f-6ea7bd945be2",
              "name": "",
              "description": "",
              "parentNodeId": "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0",
              "fromNodeId": "50cd9c41-770d-404c-8571-596254ccd42c",
              "toNodeId": "3f6935b0-fd23-4af2-8c9f-8d488b967a1f"
            },
            "9a093cea-35c8-42fa-a98f-738377db6c54": {
              "id": "9a093cea-35c8-42fa-a98f-738377db6c54",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "5d83b3cc-4351-4b18-aa49-fe7e124319ad",
              "toNodeId": "cef2135a-e641-4c80-8a7b-a0cf5fc464e0"
            },
            "a325af35-b95f-4014-9f88-2e1f37e8e24d": {
              "id": "a325af35-b95f-4014-9f88-2e1f37e8e24d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0",
              "toNodeId": "d599008b-dfa4-480b-b370-626dda54dc9e"
            },
            "a7556330-e50d-4738-8f9a-253d026a34d9": {
              "id": "a7556330-e50d-4738-8f9a-253d026a34d9",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a5434f0d-592d-4815-8fe9-8719e47ddc43",
              "toNodeId": "91f352b5-30eb-4abc-a491-82d860f5de1b"
            },
            "b6efd95f-c8e7-4200-93b8-a16baf5e4e45": {
              "id": "b6efd95f-c8e7-4200-93b8-a16baf5e4e45",
              "name": "yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "bbf37066-6157-4c03-b44e-780fb223445d",
              "toNodeId": "7f8e9fef-d3eb-44bb-810f-ed95fa08fc3a"
            },
            "b75e510a-0c8f-4ebc-ba58-0deb1ae762ce": {
              "id": "b75e510a-0c8f-4ebc-ba58-0deb1ae762ce",
              "name": "",
              "description": "",
              "parentNodeId": "b10fffe3-10c1-43fe-86cb-1d089e261ec8",
              "fromNodeId": "b10fffe3-10c1-43fe-86cb-1d089e261ec8",
              "toNodeId": ""
            },
            "ba5a8004-0d56-429a-9f01-067d529f8703": {
              "id": "ba5a8004-0d56-429a-9f01-067d529f8703",
              "name": "no",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "bbf37066-6157-4c03-b44e-780fb223445d",
              "toNodeId": "674a674b-acec-4bf5-920e-b0fda77e8e86"
            },
            "c7118104-f71c-4d00-8bde-01c9f5a4ac06": {
              "id": "c7118104-f71c-4d00-8bde-01c9f5a4ac06",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "9f271d1c-aa6d-425d-97e8-2b45449a2eba",
              "toNodeId": "027079bd-2f07-4a81-802c-9285225031da"
            },
            "d214758d-e13b-4a15-b098-b4c8146017e1": {
              "id": "d214758d-e13b-4a15-b098-b4c8146017e1",
              "name": "",
              "description": "",
              "parentNodeId": "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0",
              "fromNodeId": "716883b8-7e02-47c7-b261-5791dd1b838f",
              "toNodeId": ""
            },
            "da308bf0-3f51-4f1e-977b-af9f4070a0cc": {
              "id": "da308bf0-3f51-4f1e-977b-af9f4070a0cc",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "053214d3-42db-45b5-a31b-8e1b0d349a47",
              "toNodeId": "24960792-15a3-4df7-b872-d61dc21c4aab"
            },
            "ecfb9775-4d3c-4a6d-b1a2-04ec0b902ee8": {
              "id": "ecfb9775-4d3c-4a6d-b1a2-04ec0b902ee8",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "c87511b7-9abd-4be9-a2b5-7fedcb8a7d70",
              "toNodeId": "320f400b-ada3-4f7c-8f57-9b583c6a3b46"
            }
          },
          "nodes": {
            "027079bd-2f07-4a81-802c-9285225031da": {
              "id": "027079bd-2f07-4a81-802c-9285225031da",
              "parentNodeId": ""
            },
            "053214d3-42db-45b5-a31b-8e1b0d349a47": {
              "id": "053214d3-42db-45b5-a31b-8e1b0d349a47",
              "parentNodeId": ""
            },
            "0d368b5b-d7d0-4041-be73-b1db53a3895a": {
              "id": "0d368b5b-d7d0-4041-be73-b1db53a3895a",
              "parentNodeId": ""
            },
            "24960792-15a3-4df7-b872-d61dc21c4aab": {
              "id": "24960792-15a3-4df7-b872-d61dc21c4aab",
              "parentNodeId": ""
            },
            "2da85341-69e4-4009-a565-f5206e4a957b": {
              "id": "2da85341-69e4-4009-a565-f5206e4a957b",
              "parentNodeId": "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0"
            },
            "3070b398-e684-471b-ade0-57f4bea6195c": {
              "id": "3070b398-e684-471b-ade0-57f4bea6195c",
              "parentNodeId": "db592e51-daa5-44e6-9084-3439b7f09b85"
            },
            "320f400b-ada3-4f7c-8f57-9b583c6a3b46": {
              "id": "320f400b-ada3-4f7c-8f57-9b583c6a3b46",
              "parentNodeId": ""
            },
            "3f6935b0-fd23-4af2-8c9f-8d488b967a1f": {
              "id": "3f6935b0-fd23-4af2-8c9f-8d488b967a1f",
              "parentNodeId": "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0"
            },
            "50cd9c41-770d-404c-8571-596254ccd42c": {
              "id": "50cd9c41-770d-404c-8571-596254ccd42c",
              "parentNodeId": "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0"
            },
            "54fc682b-13f6-4dff-9203-eda074930a20": {
              "id": "54fc682b-13f6-4dff-9203-eda074930a20",
              "parentNodeId": ""
            },
            "5d83b3cc-4351-4b18-aa49-fe7e124319ad": {
              "id": "5d83b3cc-4351-4b18-aa49-fe7e124319ad",
              "parentNodeId": ""
            },
            "674a674b-acec-4bf5-920e-b0fda77e8e86": {
              "id": "674a674b-acec-4bf5-920e-b0fda77e8e86",
              "parentNodeId": ""
            },
            "716883b8-7e02-47c7-b261-5791dd1b838f": {
              "id": "716883b8-7e02-47c7-b261-5791dd1b838f",
              "parentNodeId": "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0"
            },
            "739f03c2-ff98-4e0a-b1a6-f95f240556a8": {
              "id": "739f03c2-ff98-4e0a-b1a6-f95f240556a8",
              "parentNodeId": ""
            },
            "7688a93d-120d-4ca1-b995-46f923398468": {
              "id": "7688a93d-120d-4ca1-b995-46f923398468",
              "parentNodeId": ""
            },
            "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0": {
              "id": "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0",
              "parentNodeId": ""
            },
            "7f8e9fef-d3eb-44bb-810f-ed95fa08fc3a": {
              "id": "7f8e9fef-d3eb-44bb-810f-ed95fa08fc3a",
              "parentNodeId": ""
            },
            "91f352b5-30eb-4abc-a491-82d860f5de1b": {
              "id": "91f352b5-30eb-4abc-a491-82d860f5de1b",
              "parentNodeId": ""
            },
            "9f271d1c-aa6d-425d-97e8-2b45449a2eba": {
              "id": "9f271d1c-aa6d-425d-97e8-2b45449a2eba",
              "parentNodeId": ""
            },
            "a106410d-01bb-4fe6-aebf-4481868efd99": {
              "id": "a106410d-01bb-4fe6-aebf-4481868efd99",
              "parentNodeId": ""
            },
            "a5434f0d-592d-4815-8fe9-8719e47ddc43": {
              "id": "a5434f0d-592d-4815-8fe9-8719e47ddc43",
              "parentNodeId": ""
            },
            "aba0b6ae-4529-4827-a085-aeb46aa6affe": {
              "id": "aba0b6ae-4529-4827-a085-aeb46aa6affe",
              "parentNodeId": ""
            },
            "b10fffe3-10c1-43fe-86cb-1d089e261ec8": {
              "id": "b10fffe3-10c1-43fe-86cb-1d089e261ec8",
              "parentNodeId": "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0"
            },
            "bbf37066-6157-4c03-b44e-780fb223445d": {
              "id": "bbf37066-6157-4c03-b44e-780fb223445d",
              "parentNodeId": ""
            },
            "c760fe51-5590-4129-949f-6caff63ef3b6": {
              "id": "c760fe51-5590-4129-949f-6caff63ef3b6",
              "parentNodeId": "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0"
            },
            "c87511b7-9abd-4be9-a2b5-7fedcb8a7d70": {
              "id": "c87511b7-9abd-4be9-a2b5-7fedcb8a7d70",
              "parentNodeId": ""
            },
            "c8f054ac-027f-4183-bf23-a56c692d9e51": {
              "id": "c8f054ac-027f-4183-bf23-a56c692d9e51",
              "parentNodeId": "db592e51-daa5-44e6-9084-3439b7f09b85"
            },
            "cef2135a-e641-4c80-8a7b-a0cf5fc464e0": {
              "id": "cef2135a-e641-4c80-8a7b-a0cf5fc464e0",
              "parentNodeId": ""
            },
            "d599008b-dfa4-480b-b370-626dda54dc9e": {
              "id": "d599008b-dfa4-480b-b370-626dda54dc9e",
              "parentNodeId": ""
            },
            "da6747ef-bfcf-46a0-9043-8064c51e8e4a": {
              "id": "da6747ef-bfcf-46a0-9043-8064c51e8e4a",
              "parentNodeId": "0d368b5b-d7d0-4041-be73-b1db53a3895a"
            },
            "db592e51-daa5-44e6-9084-3439b7f09b85": {
              "id": "db592e51-daa5-44e6-9084-3439b7f09b85",
              "parentNodeId": "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0"
            },
            "e19ba80b-5d1a-4646-bcdb-3844a9dd04cf": {
              "id": "e19ba80b-5d1a-4646-bcdb-3844a9dd04cf",
              "parentNodeId": ""
            },
            "f36c1b8a-9374-473a-aca3-cd908110529b": {
              "id": "f36c1b8a-9374-473a-aca3-cd908110529b",
              "parentNodeId": ""
            },
            "fb358b1f-bc73-40fb-94bd-e8cc542b1a1f": {
              "id": "fb358b1f-bc73-40fb-94bd-e8cc542b1a1f",
              "parentNodeId": "db592e51-daa5-44e6-9084-3439b7f09b85"
            }
          }
        },
        "steps": {
          "027079bd-2f07-4a81-802c-9285225031da": {
            "nodeId": "027079bd-2f07-4a81-802c-9285225031da",
            "name": "Did we get too many results?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "3e4dbe3f-249a-4b1a-9e4f-c884245a126c",
              "stepControlParams": [
                {
                  "edgeId": "3e4dbe3f-249a-4b1a-9e4f-c884245a126c",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "5262e62f-69e5-4885-9c51-2e99b9654416",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "9f271d1c-aa6d-425d-97e8-2b45449a2eba.search_results",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": "<=",
                    "right": {
                      "type": "literal",
                      "value": 50
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[9f271d1c-aa6d-425d-97e8-2b45449a2eba].[search_results]}}) <= 50"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "053214d3-42db-45b5-a31b-8e1b0d349a47": {
            "nodeId": "053214d3-42db-45b5-a31b-8e1b0d349a47",
            "name": "IDs to Process",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "59a3e673-03f3-435d-b4c8-ecf6eee4febc",
                "8c0e3542-315a-4ae9-b32d-d0029fcca528",
                "30e4a6c0-a628-44ae-b47a-00e6d4e2cc1d"
              ],
              "variableSets": [
                {
                  "arrayType": "object",
                  "inputBuilderSchemas": null,
                  "name": "nexpose_ids",
                  "type": "array",
                  "variables": {
                    "30e4a6c0-a628-44ae-b47a-00e6d4e2cc1d": "{{[0d368b5b-d7d0-4041-be73-b1db53a3895a].[Vulnerabilities]}}",
                    "59a3e673-03f3-435d-b4c8-ecf6eee4febc": "{{[e19ba80b-5d1a-4646-bcdb-3844a9dd04cf].[output].[array]}}",
                    "8c0e3542-315a-4ae9-b32d-d0029fcca528": "{{[5d83b3cc-4351-4b18-aa49-fe7e124319ad].[json]}}"
                  }
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {
                "nexpose_ids": {
                  "description": "Emitted variable \"nexpose_ids\"",
                  "items": {
                    "type": "object"
                  },
                  "order": 1,
                  "title": "nexpose_ids",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {
                "nexpose_ids": {
                  "description": "Emitted variable \"nexpose_ids\"",
                  "items": {
                    "type": "object"
                  },
                  "order": 1,
                  "title": "nexpose_ids",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "0d368b5b-d7d0-4041-be73-b1db53a3895a": {
            "nodeId": "0d368b5b-d7d0-4041-be73-b1db53a3895a",
            "name": "Extract Vulnerability IDs from VulnDB",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "expression": null,
                    "value": "{{[da6747ef-bfcf-46a0-9043-8064c51e8e4a].[output]}}",
                    "valueType": "object"
                  },
                  "name": "Vulnerabilities",
                  "outputType": "array"
                }
              ],
              "innerEdgeId": "7dd20817-b45b-4804-a4a3-3eb7b76d2b37",
              "nextEdgeId": "30e4a6c0-a628-44ae-b47a-00e6d4e2cc1d",
              "repeatVariable": "{{[9f271d1c-aa6d-425d-97e8-2b45449a2eba].[search_results]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "Vulnerabilities": {
                  "description": "Custom output: \"Vulnerabilities\"",
                  "items": {
                    "properties": {},
                    "type": "object"
                  },
                  "title": "Vulnerabilities",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "24960792-15a3-4df7-b872-d61dc21c4aab": {
            "nodeId": "24960792-15a3-4df7-b872-d61dc21c4aab",
            "name": "Vulns Found?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "34f898d3-537a-42f3-b763-07231a2c6c37",
              "stepControlParams": [
                {
                  "edgeId": "34f898d3-537a-42f3-b763-07231a2c6c37",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "7c7e9077-5e4f-462d-a0f3-c9a31e1322c1",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "053214d3-42db-45b5-a31b-8e1b0d349a47.nexpose_ids",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": ">",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[053214d3-42db-45b5-a31b-8e1b0d349a47].[nexpose_ids]}}) > 0"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "2da85341-69e4-4009-a565-f5206e4a957b": {
            "nodeId": "2da85341-69e4-4009-a565-f5206e4a957b",
            "name": "Get Impacted Assets",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.0.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.0.0/icon.png"
            },
            "identifier": "get_vulnerability_affected_assets",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "vulnerability_id": "{{[7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0].[$item].[nexpose_id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "vulnerability_id": {
                  "description": "The identifier of the vulnerability e.g. jre-vuln-cve-2013-2471",
                  "order": 1,
                  "title": "Vulnerability ID",
                  "type": "string"
                }
              },
              "required": [
                "vulnerability_id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                }
              },
              "properties": {
                "links": {
                  "description": "Hypermedia links to corresponding or related resources",
                  "items": {
                    "$ref": "#/definitions/link"
                  },
                  "order": 1,
                  "title": "Links",
                  "type": "array"
                },
                "resources": {
                  "description": "The identifiers of the associated resources",
                  "items": {
                    "type": "integer"
                  },
                  "order": 2,
                  "title": "Resources",
                  "type": "array"
                }
              },
              "required": [
                "links",
                "resources"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "3070b398-e684-471b-ade0-57f4bea6195c": {
            "nodeId": "3070b398-e684-471b-ade0-57f4bea6195c",
            "name": "Check if we've reached our max host count",
            "type": "break",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "4ff2a8b9-d859-44a2-a2c1-42abee472d49",
                "expression": {
                  "left": {
                    "args": [
                      {
                        "name": "db592e51-daa5-44e6-9084-3439b7f09b85.$outputs",
                        "type": "variable"
                      }
                    ],
                    "name": "length",
                    "type": "function"
                  },
                  "op": ">=",
                  "right": {
                    "name": "7688a93d-120d-4ca1-b995-46f923398468.output.max hosts",
                    "type": "variable"
                  },
                  "type": "binary"
                },
                "expressionText": "length({{[db592e51-daa5-44e6-9084-3439b7f09b85].[$outputs]}}) >= {{[7688a93d-120d-4ca1-b995-46f923398468].[output].[max hosts]}}"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/break.svg",
            "connectionType": "NONE"
          },
          "320f400b-ada3-4f7c-8f57-9b583c6a3b46": {
            "nodeId": "320f400b-ada3-4f7c-8f57-9b583c6a3b46",
            "name": "Extract Vulnerability",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": false,
              "expressionText": "!lookup-vuln-hosts\\s+{{vulnerability:/\\S+/}}.*",
              "expressions": [
                {
                  "type": "text",
                  "value": "!lookup-vuln-hosts\\s+"
                },
                {
                  "type": "variable",
                  "value": {
                    "ident": "vulnerability",
                    "regex": "\\S+"
                  }
                },
                {
                  "type": "text",
                  "value": ".*"
                }
              ],
              "ignoreCase": true,
              "input": "{{[c87511b7-9abd-4be9-a2b5-7fedcb8a7d70].[text]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "3f6935b0-fd23-4af2-8c9f-8d488b967a1f": {
            "nodeId": "3f6935b0-fd23-4af2-8c9f-8d488b967a1f",
            "name": "Is count 0?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "30787b4d-5efa-442a-a77a-7497e34e5afb",
              "stepControlParams": [
                {
                  "edgeId": "30787b4d-5efa-442a-a77a-7497e34e5afb",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "5456e9de-f270-42cf-a467-f4ee456cf75f",
                  "expression": {
                    "args": [
                      {
                        "name": "b10fffe3-10c1-43fe-86cb-1d089e261ec8.count",
                        "type": "variable"
                      }
                    ],
                    "name": "is_defined",
                    "type": "function"
                  },
                  "expressionText": "is_defined({{[b10fffe3-10c1-43fe-86cb-1d089e261ec8].[count]}})"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "50cd9c41-770d-404c-8571-596254ccd42c": {
            "nodeId": "50cd9c41-770d-404c-8571-596254ccd42c",
            "name": "Report Vulnerability",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "2.0.4",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/2.0.4/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "{{[7688a93d-120d-4ca1-b995-46f923398468].[output].[channel]}}",
                "message_content": "<html>\nVulnerability Found:\n<b>{{[c760fe51-5590-4129-949f-6caff63ef3b6].[vulnerability].[title]}}</b>\n<i>Severity:</i> {{[c760fe51-5590-4129-949f-6caff63ef3b6].[vulnerability].[severity]}}\n<i>CVSS:</i> V2:{{[c760fe51-5590-4129-949f-6caff63ef3b6].[vulnerability].[cvss].[v2].[score]}} {{#if [c760fe51-5590-4129-949f-6caff63ef3b6].[vulnerability].[cvss].[v3].[score]}} |  V3:{{[c760fe51-5590-4129-949f-6caff63ef3b6].[vulnerability].[cvss].[v3].[score]}}{{/if}}\n<i>Risk Score:</i> {{[c760fe51-5590-4129-949f-6caff63ef3b6].[vulnerability].[riskScore]}}\n<i>Assets Impacted: {{#if [b10fffe3-10c1-43fe-86cb-1d089e261ec8].[count]}}{{[b10fffe3-10c1-43fe-86cb-1d089e261ec8].[count]}}{{else}}None{{/if}}</i>\n</html>",
                "team_name": "{{[7688a93d-120d-4ca1-b995-46f923398468].[output].[team]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 3,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "54fc682b-13f6-4dff-9203-eda074930a20": {
            "nodeId": "54fc682b-13f6-4dff-9203-eda074930a20",
            "name": "Report Not Found",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "2.0.4",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/2.0.4/icon.png"
            },
            "identifier": "send_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "{{[7688a93d-120d-4ca1-b995-46f923398468].[output].[channel]}}",
                "message": "Your query did not return any vulnerabilities - even in the Rapid7 VulnDB available at <https://www.rapid7.com/db|Rapid7 VulnDB> ",
                "team_name": "{{[7688a93d-120d-4ca1-b995-46f923398468].[output].[team]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "channel_name",
                "message",
                "team_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "5d83b3cc-4351-4b18-aa49-fe7e124319ad": {
            "nodeId": "5d83b3cc-4351-4b18-aa49-fe7e124319ad",
            "name": "Alternate Identifiers",
            "type": "action",
            "plugin": {
              "name": "CSV",
              "slugVendor": "rapid7",
              "slugName": "csv",
              "slugVersion": "1.1.5",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/csv/1.1.5/icon.png"
            },
            "identifier": "to_json",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "csv": "{{[739f03c2-ff98-4e0a-b1a6-f95f240556a8].[report].[content]}}",
                "validation": false
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "csv": {
                  "description": "Base64 encoded CSV file",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 1,
                  "title": "CSV",
                  "type": "string"
                },
                "validation": {
                  "default": false,
                  "description": "Validate CSV data, error if not valid",
                  "order": 2,
                  "title": "Validate",
                  "type": "boolean"
                }
              },
              "required": [
                "csv",
                "validation"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "json": {
                  "description": "List of objects",
                  "items": {
                    "type": "object"
                  },
                  "order": 1,
                  "title": "JSON",
                  "type": "array"
                }
              },
              "required": [
                "json"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "definitions": {
                "json": {
                  "properties": {
                    "nexpose_id": {
                      "type": "string"
                    }
                  },
                  "type": "object"
                }
              },
              "properties": {
                "json": {
                  "description": "List of objects",
                  "items": {
                    "$ref": "#/definitions/json"
                  },
                  "order": 1,
                  "title": "JSON",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "674a674b-acec-4bf5-920e-b0fda77e8e86": {
            "nodeId": "674a674b-acec-4bf5-920e-b0fda77e8e86",
            "name": "Report Malformed Command",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "2.0.4",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/2.0.4/icon.png"
            },
            "identifier": "send_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "{{[7688a93d-120d-4ca1-b995-46f923398468].[output].[channel]}}",
                "message": "*Malformed Command*\nCommand should be:\n!affected-assets <vulnerability>\n\n<vulnerability> in the command can be any InsightVM vulnerability reference including the following:\n* kb number\n* cve\n* nexpose id\n* other references InsightVM knows\n\nIn some cases, the alternate ID will correspond to multiple vulnerabilities in InsightVM.  In this case, results for each vulnerability will be returned separately.",
                "team_name": "{{[7688a93d-120d-4ca1-b995-46f923398468].[output].[team]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "channel_name",
                "message",
                "team_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "716883b8-7e02-47c7-b261-5791dd1b838f": {
            "nodeId": "716883b8-7e02-47c7-b261-5791dd1b838f",
            "name": "Report Asset Details",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "2.0.4",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/2.0.4/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "{{[7688a93d-120d-4ca1-b995-46f923398468].[output].[channel]}}",
                "message_content": "<html>\n<b>Vulnerable Assets</b>\n<ul>{{#each [db592e51-daa5-44e6-9084-3439b7f09b85].[Asset Information]}}\n<li> {{this}}\n{{/each}}</ul>\n</html>",
                "team_name": "{{[7688a93d-120d-4ca1-b995-46f923398468].[output].[team]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 3,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "739f03c2-ff98-4e0a-b1a6-f95f240556a8": {
            "nodeId": "739f03c2-ff98-4e0a-b1a6-f95f240556a8",
            "name": "Get Vulnerabilities By Alternate Identifiers",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.0.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.0.0/icon.png"
            },
            "identifier": "generate_adhoc_sql_report",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "filters": "{}",
                "query": "with prep as (select vulnerability_id,lower(reference) as reference from dim_vulnerability_reference)\nselect nexpose_id from prep join dim_vulnerability using (vulnerability_id) where reference=lower('{{[320f400b-ada3-4f7c-8f57-9b583c6a3b46].[vulnerability]}}')",
                "scope": "tags",
                "scope_ids": [
                  1
                ]
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "filters": {
                  "default": "{}",
                  "description": "Filters in JSON format to be applied to the contents of the report; review InsightVM API documentation for filter options",
                  "order": 4,
                  "title": "Report Filters",
                  "type": "string"
                },
                "query": {
                  "description": "Reporting Data Model SQL query",
                  "order": 1,
                  "title": "Query",
                  "type": "string"
                },
                "scope": {
                  "default": "none",
                  "description": "Scope context for generated report; if set, remediations will be scoped by each in scope ID, e.g Site ID, Tag ID, Asset Group ID; scan scope only supports single scan ID as input",
                  "enum": [
                    "none",
                    "assets",
                    "assetGroups",
                    "sites",
                    "tags",
                    "scan"
                  ],
                  "order": 2,
                  "title": "Scope",
                  "type": "string"
                },
                "scope_ids": {
                  "default": [],
                  "description": "Scope IDs for which tickets should be generated, by default all are included",
                  "items": {
                    "type": "integer"
                  },
                  "order": 3,
                  "title": "Scope IDs",
                  "type": "array"
                }
              },
              "required": [
                "query",
                "scope"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "configuration": {
                  "properties": {
                    "name": {
                      "description": "Name of the configuration value",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "value": {
                      "description": "Configuration value",
                      "order": 2,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Configuration",
                  "type": "object"
                },
                "file": {
                  "properties": {
                    "attributes": {
                      "description": "Attributes detected on the file",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 1,
                      "title": "Attributes",
                      "type": "array"
                    },
                    "content": {
                      "description": "Contents of the file",
                      "displayType": "bytes",
                      "format": "bytes",
                      "order": 5,
                      "title": "Contents",
                      "type": "string"
                    },
                    "name": {
                      "description": "Name of the file",
                      "order": 2,
                      "title": "Name",
                      "type": "string"
                    },
                    "size": {
                      "description": "Size of the regular file (in bytes). If the file is a directory, no value is returned",
                      "order": 3,
                      "title": "Size",
                      "type": "integer"
                    },
                    "type": {
                      "description": "Type of the file, e.g. file or directory",
                      "order": 4,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                }
              },
              "properties": {
                "report": {
                  "$ref": "#/definitions/file",
                  "description": "Base64 encoded file making up the report",
                  "order": 1,
                  "title": "Base64 Encoded Report"
                }
              },
              "required": [
                "report"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "7688a93d-120d-4ca1-b995-46f923398468": {
            "nodeId": "7688a93d-120d-4ca1-b995-46f923398468",
            "name": "Settings",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.5.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.5.1/icon.png"
            },
            "identifier": "string_to_object",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "input": "{\"team\": \"change_me\",\"channel\":\"change_me\",\"max hosts\":100}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "input": {
                  "description": "Input variable",
                  "order": 1,
                  "title": "Input",
                  "type": "string"
                }
              },
              "required": [
                "input"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "output": {
                  "description": "Type converted input",
                  "order": 1,
                  "title": "Output",
                  "type": "object"
                }
              },
              "required": [
                "output"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "definitions": {
                "output": {
                  "properties": {
                    "channel": {
                      "type": "string"
                    },
                    "max hosts": {
                      "type": "integer"
                    },
                    "team": {
                      "type": "string"
                    }
                  },
                  "type": "object"
                }
              },
              "properties": {
                "output": {
                  "$ref": "#/definitions/output",
                  "description": "Type converted input",
                  "order": 1,
                  "title": "Output"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0": {
            "nodeId": "7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0",
            "name": "Process Vulnerabilities",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "20ab3e84-1edd-498c-aaca-b6a031b1bd44",
              "nextEdgeId": "a325af35-b95f-4014-9f88-2e1f37e8e24d",
              "repeatVariable": "{{[053214d3-42db-45b5-a31b-8e1b0d349a47].[nexpose_ids]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "7f8e9fef-d3eb-44bb-810f-ed95fa08fc3a": {
            "nodeId": "7f8e9fef-d3eb-44bb-810f-ed95fa08fc3a",
            "name": "Searching Notification",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "2.0.4",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/2.0.4/icon.png"
            },
            "identifier": "send_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "{{[7688a93d-120d-4ca1-b995-46f923398468].[output].[channel]}}",
                "message": "Searching for `{{[320f400b-ada3-4f7c-8f57-9b583c6a3b46].[vulnerability]}}` vulnerabilities...",
                "team_name": "{{[7688a93d-120d-4ca1-b995-46f923398468].[output].[team]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "channel_name",
                "message",
                "team_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "91f352b5-30eb-4abc-a491-82d860f5de1b": {
            "nodeId": "91f352b5-30eb-4abc-a491-82d860f5de1b",
            "name": "Vulnerability Found?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "91b8c947-434c-4101-be2b-6e45d0d5d15d",
              "stepControlParams": [
                {
                  "edgeId": "790fa4e8-9c28-400d-a785-a445db35d39d",
                  "expression": {
                    "name": "a5434f0d-592d-4815-8fe9-8719e47ddc43.$success",
                    "type": "variable"
                  },
                  "expressionText": "{{[a5434f0d-592d-4815-8fe9-8719e47ddc43].[$success]}}"
                },
                {
                  "edgeId": "91b8c947-434c-4101-be2b-6e45d0d5d15d",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "9f271d1c-aa6d-425d-97e8-2b45449a2eba": {
            "nodeId": "9f271d1c-aa6d-425d-97e8-2b45449a2eba",
            "name": "Lookup Vuln in VulnDB",
            "type": "action",
            "plugin": {
              "name": "Rapid7 Vulnerability & Exploit Database",
              "slugVendor": "rapid7",
              "slugName": "rapid7_vulndb",
              "slugVersion": "2.0.4",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_vulndb/2.0.4/icon.png"
            },
            "identifier": "search_db",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "database": "Vulnerability Database",
                "search": "{{[320f400b-ada3-4f7c-8f57-9b583c6a3b46].[vulnerability]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "database": {
                  "description": "Name of the database",
                  "enum": [
                    "Vulnerability Database",
                    "Metasploit Modules"
                  ],
                  "order": 1,
                  "title": "Database",
                  "type": "string"
                },
                "search": {
                  "description": "Search parameter for database",
                  "order": 2,
                  "title": "Search",
                  "type": "string"
                }
              },
              "required": [
                "database",
                "search"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "search_result": {
                  "properties": {
                    "identifier": {
                      "description": "Content identifier for module or vulnerability",
                      "order": 4,
                      "title": "Content Identifier",
                      "type": "string"
                    },
                    "link": {
                      "description": "Link to vulnerability",
                      "order": 2,
                      "title": "Link",
                      "type": "string"
                    },
                    "published_at": {
                      "description": "Published date of vulnerability",
                      "order": 3,
                      "title": "Published At",
                      "type": "string"
                    },
                    "title": {
                      "description": "Title of vulnerability",
                      "order": 1,
                      "title": "Title",
                      "type": "string"
                    }
                  },
                  "title": "Search Result",
                  "type": "object"
                }
              },
              "properties": {
                "results_found": {
                  "description": "Will return false if no results are found",
                  "order": 2,
                  "title": "Results Found",
                  "type": "boolean"
                },
                "search_results": {
                  "description": "Vulnerability and exploits found",
                  "items": {
                    "$ref": "#/definitions/search_result"
                  },
                  "order": 1,
                  "title": "Results",
                  "type": "array"
                }
              },
              "required": [
                "results_found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "a106410d-01bb-4fe6-aebf-4481868efd99": {
            "nodeId": "a106410d-01bb-4fe6-aebf-4481868efd99",
            "name": "Overview",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Command to run:\n!lookup-vuln-assets <vulnerability>\n\n### Details\n<vulnerability> in the command can be any InsightVM vulnerability reference including the following:\n* KB Number\n* CVE ID\n* Nexpose ID\n* Other references InsightVM knows\n\nIn some cases, the alternate ID will correspond to multiple vulnerabilities InsightVM references.  In this case, the workflow will return results for each vulnerability separately.\n\n## Please note - the Get Vulnerable Assets step is expected to fail when using an alternate identifier or when there are no assets vulnerable to the vulnerability"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "a5434f0d-592d-4815-8fe9-8719e47ddc43": {
            "nodeId": "a5434f0d-592d-4815-8fe9-8719e47ddc43",
            "name": "Get Vulnerable Assets",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.0.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.0.0/icon.png"
            },
            "identifier": "get_vulnerability_affected_assets",
            "continueOnFailure": true,
            "isDisabled": false,
            "parameters": {
              "input": {
                "vulnerability_id": "{{[320f400b-ada3-4f7c-8f57-9b583c6a3b46].[vulnerability]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "vulnerability_id": {
                  "description": "The identifier of the vulnerability e.g. jre-vuln-cve-2013-2471",
                  "order": 1,
                  "title": "Vulnerability ID",
                  "type": "string"
                }
              },
              "required": [
                "vulnerability_id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                }
              },
              "properties": {
                "links": {
                  "description": "Hypermedia links to corresponding or related resources",
                  "items": {
                    "$ref": "#/definitions/link"
                  },
                  "order": 1,
                  "title": "Links",
                  "type": "array"
                },
                "resources": {
                  "description": "The identifiers of the associated resources",
                  "items": {
                    "type": "integer"
                  },
                  "order": 2,
                  "title": "Resources",
                  "type": "array"
                }
              },
              "required": [
                "links",
                "resources"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "aba0b6ae-4529-4827-a085-aeb46aa6affe": {
            "nodeId": "aba0b6ae-4529-4827-a085-aeb46aa6affe",
            "name": "!lookup-vuln-hosts Trigger",
            "description": "Trigger this workflow using the lookup-vuln-hosts command:\n\n!lookup-vuln-hosts bluekeep\n!lookup-vuln-hosts CVE-2019-0708",
            "type": "trigger",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "2.0.4",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/2.0.4/icon.png"
            },
            "identifier": "new_message_received",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "change_me",
                "message_content": "!lookup-vuln-hosts\\s+\\S+",
                "team_name": "change_me"
              }
            },
            "triggerId": "ab442ba5-50f4-47e2-a40e-cbcf61383fe8",
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "Regex to match new messages against",
                  "order": 3,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION"
          },
          "b10fffe3-10c1-43fe-86cb-1d089e261ec8": {
            "nodeId": "b10fffe3-10c1-43fe-86cb-1d089e261ec8",
            "name": "count",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "expression": {
                      "left": {
                        "type": "literal",
                        "value": 1
                      },
                      "op": "==",
                      "right": {
                        "type": "literal",
                        "value": 1
                      },
                      "type": "binary"
                    },
                    "expressionText": "1==1"
                  },
                  "name": "count",
                  "outputType": "count"
                }
              ],
              "innerEdgeId": "b75e510a-0c8f-4ebc-ba58-0deb1ae762ce",
              "nextEdgeId": "360a2b6a-8c82-45ce-9b04-26e7edd6747a",
              "repeatVariable": "{{[2da85341-69e4-4009-a565-f5206e4a957b].[resources]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "count": {
                  "description": "Custom output: \"count\"",
                  "title": "count",
                  "type": "integer"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "bbf37066-6157-4c03-b44e-780fb223445d": {
            "nodeId": "bbf37066-6157-4c03-b44e-780fb223445d",
            "name": "Is Input Good?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "ba5a8004-0d56-429a-9f01-067d529f8703",
              "stepControlParams": [
                {
                  "edgeId": "b6efd95f-c8e7-4200-93b8-a16baf5e4e45",
                  "expression": {
                    "name": "320f400b-ada3-4f7c-8f57-9b583c6a3b46.$matched",
                    "type": "variable"
                  },
                  "expressionText": "{{[320f400b-ada3-4f7c-8f57-9b583c6a3b46].[$matched]}}"
                },
                {
                  "edgeId": "ba5a8004-0d56-429a-9f01-067d529f8703",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "c760fe51-5590-4129-949f-6caff63ef3b6": {
            "nodeId": "c760fe51-5590-4129-949f-6caff63ef3b6",
            "name": "Vulnerability Information",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.0.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.0.0/icon.png"
            },
            "identifier": "get_vulnerability",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "id": "{{[7e9c87e4-ba06-40ad-ad26-ea05ec7c10f0].[$item].[nexpose_id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "id": {
                  "description": "The identifier of the vulnerability to retrieve from InsightVM",
                  "order": 1,
                  "title": "Vulnerability ID",
                  "type": "string"
                }
              },
              "required": [
                "id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "cvss": {
                  "properties": {
                    "links": {
                      "description": "List of hypermedia links to corresponding resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 1,
                      "title": "Links",
                      "type": "array"
                    },
                    "v2": {
                      "$ref": "#/definitions/cvss_v2",
                      "description": "CVSSv2 details",
                      "order": 2,
                      "title": "V2"
                    },
                    "v3": {
                      "$ref": "#/definitions/cvss_v3",
                      "description": "CVSSv3 details",
                      "order": 3,
                      "title": "V3"
                    }
                  },
                  "title": "Cvss",
                  "type": "object"
                },
                "cvss_v2": {
                  "properties": {
                    "accessComplexity": {
                      "description": "CVSSv2 access complexity metric",
                      "order": 1,
                      "title": "Access Complexity",
                      "type": "string"
                    },
                    "accessVector": {
                      "description": "CVSSv2 access vector metric",
                      "order": 2,
                      "title": "Access Vector",
                      "type": "string"
                    },
                    "authentication": {
                      "description": "CVSSv2 authentication metric",
                      "order": 3,
                      "title": "Authentication",
                      "type": "string"
                    },
                    "availabilityImpact": {
                      "description": "CVSSv2 availability impact metric",
                      "order": 4,
                      "title": "Availability Impact",
                      "type": "string"
                    },
                    "confidentialityImpact": {
                      "description": "CVSSv2 confidentiality impact metric",
                      "order": 5,
                      "title": "Confidentiality Impact",
                      "type": "string"
                    },
                    "exploitScore": {
                      "description": "CVSSv2 combined exploit metric score (Access Complexity/Access Vector/Authentication)",
                      "order": 6,
                      "title": "Exploit Score",
                      "type": "number"
                    },
                    "impactScore": {
                      "description": "CVSSv2 combined impact metric score (Confidentiality/Integrity/Availability)",
                      "order": 7,
                      "title": "Impact Score",
                      "type": "number"
                    },
                    "integrityImpact": {
                      "description": "CVSSv2 integrity impact metric",
                      "order": 8,
                      "title": "Integrity Impact",
                      "type": "string"
                    },
                    "score": {
                      "description": "CVSSv2 score",
                      "order": 9,
                      "title": "Score",
                      "type": "number"
                    },
                    "vector": {
                      "description": "CVSSv2 combined vector string",
                      "order": 10,
                      "title": "Vector",
                      "type": "string"
                    }
                  },
                  "title": "Cvss V2",
                  "type": "object"
                },
                "cvss_v3": {
                  "properties": {
                    "attackComplexity": {
                      "description": "CVSSv3 attack complexity metric",
                      "order": 1,
                      "title": "Attack Complexity",
                      "type": "string"
                    },
                    "attackVector": {
                      "description": "CVSSv3 attack vector metric",
                      "order": 2,
                      "title": "Attack Vector",
                      "type": "string"
                    },
                    "availabilityImpact": {
                      "description": "CVSSv3 availability impact metric",
                      "order": 3,
                      "title": "Availability Impact",
                      "type": "string"
                    },
                    "confidentialityImpact": {
                      "description": "CVSSv3 confidentiality impact metric",
                      "order": 4,
                      "title": "Confidentiality Impact",
                      "type": "string"
                    },
                    "exploitScore": {
                      "description": "CVSSv3 combined exploit metric score (Attack Complexity/Attack Vector/Privilege Required/Scope/User Interaction)",
                      "order": 5,
                      "title": "Exploit Score",
                      "type": "number"
                    },
                    "impactScore": {
                      "description": "CVSSv3 combined impact metric score (Confidentiality/Integrity/Availability)",
                      "order": 6,
                      "title": "Impact Score",
                      "type": "number"
                    },
                    "integrityImpact": {
                      "description": "CVSSv3 integrity impact metric",
                      "order": 7,
                      "title": "Integrity Impact",
                      "type": "string"
                    },
                    "privilegeRequired": {
                      "description": "CVSSv3 privilege required metric",
                      "order": 8,
                      "title": "Privilege Required",
                      "type": "string"
                    },
                    "scope": {
                      "description": "CVSSv3 scope metric",
                      "order": 9,
                      "title": "Scope",
                      "type": "string"
                    },
                    "score": {
                      "description": "CVSSv3 score",
                      "order": 10,
                      "title": "Score",
                      "type": "number"
                    },
                    "userInteraction": {
                      "description": "CVSSv3 user interaction metric",
                      "order": 11,
                      "title": "User Interaction",
                      "type": "string"
                    },
                    "vector": {
                      "description": "CVSSv3 combined vector string",
                      "order": 12,
                      "title": "Vector",
                      "type": "string"
                    }
                  },
                  "title": "Cvss V3",
                  "type": "object"
                },
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                },
                "pci": {
                  "properties": {
                    "adjustedCVSSScore": {
                      "description": "PCI adjusted CVSS score",
                      "order": 1,
                      "title": "Adjusted CVSS score",
                      "type": "integer"
                    },
                    "adjustedSeverityScore": {
                      "description": "PCI adjusted severity score",
                      "order": 2,
                      "title": "Adjusted severity score",
                      "type": "integer"
                    },
                    "fail": {
                      "description": "Whether this vulnerability results in a PCI assessment failure",
                      "order": 3,
                      "title": "Fail",
                      "type": "boolean"
                    },
                    "specialNotes": {
                      "description": "PCI special notes",
                      "order": 4,
                      "title": "Special Notes",
                      "type": "string"
                    },
                    "status": {
                      "description": "PCI status",
                      "order": 5,
                      "title": "Status",
                      "type": "string"
                    }
                  },
                  "title": "Pci",
                  "type": "object"
                },
                "vulnerability": {
                  "properties": {
                    "added": {
                      "description": "Date that the vulnerability was added to InsightVM",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 1,
                      "title": "Added",
                      "type": "string"
                    },
                    "categories": {
                      "description": "List of vulnerabilities categories with which this vulnerability is affiliated",
                      "items": {
                        "type": "string"
                      },
                      "order": 16,
                      "title": "Categories",
                      "type": "array"
                    },
                    "cves": {
                      "description": "List of CVE identifiers associated with this vulnerability",
                      "items": {
                        "type": "string"
                      },
                      "order": 17,
                      "title": "CVEs",
                      "type": "array"
                    },
                    "cvss": {
                      "$ref": "#/definitions/cvss",
                      "description": "Vulnerability CVSS details",
                      "order": 15,
                      "title": "CVSS"
                    },
                    "denialOfService": {
                      "description": "Whether the vulnerability is a denial of service vulnerability",
                      "order": 7,
                      "title": "Denial of Service",
                      "type": "boolean"
                    },
                    "description": {
                      "$ref": "#/definitions/vulnerability_description",
                      "description": "Vulnerability description",
                      "order": 3,
                      "title": "Description"
                    },
                    "exploits": {
                      "description": "Exploit count",
                      "order": 2,
                      "title": "Exploits",
                      "type": "integer"
                    },
                    "id": {
                      "description": "Vulnerability ID",
                      "order": 9,
                      "title": "ID",
                      "type": "string"
                    },
                    "links": {
                      "description": "List of hypermedia links to corresponding resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 4,
                      "title": "Links",
                      "type": "array"
                    },
                    "malwareKits": {
                      "description": "Malware kit count",
                      "order": 6,
                      "title": "Malware Kits",
                      "type": "integer"
                    },
                    "modified": {
                      "description": "Date the vulnerability was last modified in InsightVM",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 8,
                      "title": "Modified",
                      "type": "string"
                    },
                    "pci": {
                      "$ref": "#/definitions/pci",
                      "description": "Vulnerability PCI details",
                      "order": 11,
                      "title": "PCI"
                    },
                    "published": {
                      "description": "Date the vulnerability was published",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 12,
                      "title": "Published",
                      "type": "string"
                    },
                    "riskScore": {
                      "description": "Vulnerability risk score using the configured risk scoring strategy (RealRisk by default)",
                      "order": 14,
                      "title": "Risk Score",
                      "type": "number"
                    },
                    "severity": {
                      "description": "Vulnerability severity string (Moderate/Severe/Critical)",
                      "order": 13,
                      "title": "Severity",
                      "type": "string"
                    },
                    "severityScore": {
                      "description": "Vulnerability severity score",
                      "order": 10,
                      "title": "Severity Score",
                      "type": "integer"
                    },
                    "title": {
                      "description": "Vulnerability title",
                      "order": 5,
                      "title": "Title",
                      "type": "string"
                    }
                  },
                  "title": "Vulnerability",
                  "type": "object"
                },
                "vulnerability_description": {
                  "properties": {
                    "html": {
                      "description": "Vulnerability description HTML",
                      "order": 1,
                      "title": "HTML",
                      "type": "string"
                    },
                    "text": {
                      "description": "Vulnerability description raw text",
                      "order": 2,
                      "title": "Text",
                      "type": "string"
                    }
                  },
                  "title": "Vulnerability Description",
                  "type": "object"
                }
              },
              "properties": {
                "vulnerability": {
                  "$ref": "#/definitions/vulnerability",
                  "description": "The details of the vulnerability requested",
                  "order": 1,
                  "title": "Vulnerability Details"
                }
              },
              "required": [
                "vulnerability"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "c87511b7-9abd-4be9-a2b5-7fedcb8a7d70": {
            "nodeId": "c87511b7-9abd-4be9-a2b5-7fedcb8a7d70",
            "name": "Clean Teams Message",
            "type": "action",
            "plugin": {
              "name": "HTML",
              "slugVendor": "rapid7",
              "slugName": "html",
              "slugVersion": "1.2.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/html/1.2.1/icon.png"
            },
            "identifier": "text",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "doc": "{{[aba0b6ae-4529-4827-a085-aeb46aa6affe].[message].[body].[content]}}",
                "remove_scripts": true
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "doc": {
                  "description": "Document to transform",
                  "order": 1,
                  "title": "Document",
                  "type": "string"
                },
                "remove_scripts": {
                  "description": "Remove non-HTML scripts from the document",
                  "order": 2,
                  "title": "Remove Scripts",
                  "type": "boolean"
                }
              },
              "required": [
                "doc"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "text": {
                  "description": "String without HTML tags",
                  "order": 1,
                  "title": "Text",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "c8f054ac-027f-4183-bf23-a56c692d9e51": {
            "nodeId": "c8f054ac-027f-4183-bf23-a56c692d9e51",
            "name": "Asset Reference",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{#if [fb358b1f-bc73-40fb-94bd-e8cc542b1a1f].[asset].[hostName]}}{{[fb358b1f-bc73-40fb-94bd-e8cc542b1a1f].[asset].[hostName]}}{{else}}{{[fb358b1f-bc73-40fb-94bd-e8cc542b1a1f].[asset].[ip]}}{{/if}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "cef2135a-e641-4c80-8a7b-a0cf5fc464e0": {
            "nodeId": "cef2135a-e641-4c80-8a7b-a0cf5fc464e0",
            "name": "Vulnerability Found with Alternate Identifiers?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "599b303e-e117-4e70-814b-c62030bda71b",
              "stepControlParams": [
                {
                  "edgeId": "599b303e-e117-4e70-814b-c62030bda71b",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "8c0e3542-315a-4ae9-b32d-d0029fcca528",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "5d83b3cc-4351-4b18-aa49-fe7e124319ad.json",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": ">",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[5d83b3cc-4351-4b18-aa49-fe7e124319ad].[json]}}) > 0"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "d599008b-dfa4-480b-b370-626dda54dc9e": {
            "nodeId": "d599008b-dfa4-480b-b370-626dda54dc9e",
            "name": "Done",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "2.0.4",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/2.0.4/icon.png"
            },
            "identifier": "send_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "{{[7688a93d-120d-4ca1-b995-46f923398468].[output].[channel]}}",
                "message": "Workflow Complete. See details in InsightConnect here:\n{{[$job].[URL]}}",
                "team_name": "{{[7688a93d-120d-4ca1-b995-46f923398468].[output].[team]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "channel_name",
                "message",
                "team_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "da6747ef-bfcf-46a0-9043-8064c51e8e4a": {
            "nodeId": "da6747ef-bfcf-46a0-9043-8064c51e8e4a",
            "name": "Make NexposeID Object",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.5.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.5.1/icon.png"
            },
            "identifier": "string_to_object",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "input": "{\"nexpose_id\":\"{{[0d368b5b-d7d0-4041-be73-b1db53a3895a].[$item].[identifier]}}\"}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "input": {
                  "description": "Input variable",
                  "order": 1,
                  "title": "Input",
                  "type": "string"
                }
              },
              "required": [
                "input"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "output": {
                  "description": "Type converted input",
                  "order": 1,
                  "title": "Output",
                  "type": "object"
                }
              },
              "required": [
                "output"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "db592e51-daa5-44e6-9084-3439b7f09b85": {
            "nodeId": "db592e51-daa5-44e6-9084-3439b7f09b85",
            "name": "Get Asset Information",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "expression": null,
                    "value": "{{[c8f054ac-027f-4183-bf23-a56c692d9e51].[content]}}",
                    "valueType": "string"
                  },
                  "name": "Asset Information",
                  "outputType": "array"
                }
              ],
              "innerEdgeId": "061f4ce6-2833-4b31-97b1-78dbbb58fb3e",
              "nextEdgeId": "71ecbaac-f2a8-4b26-aa3b-fb1ff55bbd3c",
              "repeatVariable": "{{[2da85341-69e4-4009-a565-f5206e4a957b].[resources]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "Asset Information": {
                  "description": "Custom output: \"Asset Information\"",
                  "items": {
                    "type": "string"
                  },
                  "title": "Asset Information",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "e19ba80b-5d1a-4646-bcdb-3844a9dd04cf": {
            "nodeId": "e19ba80b-5d1a-4646-bcdb-3844a9dd04cf",
            "name": "make string",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.5.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.5.1/icon.png"
            },
            "identifier": "string_to_object",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "input": "{\"array\":[{\"nexpose_id\":\"{{[320f400b-ada3-4f7c-8f57-9b583c6a3b46].[vulnerability]}}\"}]}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "input": {
                  "description": "Input variable",
                  "order": 1,
                  "title": "Input",
                  "type": "string"
                }
              },
              "required": [
                "input"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "output": {
                  "description": "Type converted input",
                  "order": 1,
                  "title": "Output",
                  "type": "object"
                }
              },
              "required": [
                "output"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "definitions": {
                "array": {
                  "properties": {
                    "nexpose_id": {
                      "type": "string"
                    }
                  },
                  "type": "object"
                },
                "output": {
                  "properties": {
                    "array": {
                      "items": {
                        "$ref": "#/definitions/array"
                      },
                      "type": "array"
                    }
                  },
                  "title": "Output",
                  "type": "object"
                }
              },
              "properties": {
                "output": {
                  "$ref": "#/definitions/output",
                  "description": "Type converted input",
                  "order": 1,
                  "title": "Output"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "f36c1b8a-9374-473a-aca3-cd908110529b": {
            "nodeId": "f36c1b8a-9374-473a-aca3-cd908110529b",
            "name": "Report Too Many",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "2.0.4",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/2.0.4/icon.png"
            },
            "identifier": "send_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "{{[7688a93d-120d-4ca1-b995-46f923398468].[output].[channel]}}",
                "message": "Your search for vulnerability {{[320f400b-ada3-4f7c-8f57-9b583c6a3b46].[vulnerability]}} is too broad and returned more than 50 vulnerabilities.  Please try a narrower search.  Here is a search your may find helpful: <https://www.rapid7.com/db/?q={{[320f400b-ada3-4f7c-8f57-9b583c6a3b46].[vulnerability]}}&type=nexpose|Rapid7 VulnDB Search> ",
                "team_name": "{{[7688a93d-120d-4ca1-b995-46f923398468].[output].[team]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "channel_name",
                "message",
                "team_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "fb358b1f-bc73-40fb-94bd-e8cc542b1a1f": {
            "nodeId": "fb358b1f-bc73-40fb-94bd-e8cc542b1a1f",
            "name": "Asset Information",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.0.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.0.0/icon.png"
            },
            "identifier": "get_asset",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "id": "{{[db592e51-daa5-44e6-9084-3439b7f09b85].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "id": {
                  "description": "Get an asset by ID",
                  "order": 1,
                  "title": "ID",
                  "type": "integer"
                }
              },
              "required": [
                "id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "address": {
                  "properties": {
                    "ip": {
                      "description": "IPv4 or IPv6 address",
                      "order": 1,
                      "title": "IP",
                      "type": "string"
                    },
                    "mac": {
                      "description": "Media Access Control (MAC) address, e.g. AF:12:BC:5A:F7:48",
                      "order": 2,
                      "title": "MAC",
                      "type": "string"
                    }
                  },
                  "title": "Address",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "addresses": {
                      "description": "All addresses discovered on the asset",
                      "items": {
                        "$ref": "#/definitions/address"
                      },
                      "order": 1,
                      "title": "Addresses",
                      "type": "array"
                    },
                    "assessedForPolicies": {
                      "description": "Whether the asset has been assessed for policies at least once",
                      "order": 2,
                      "title": "Assessed for Policies",
                      "type": "boolean"
                    },
                    "assessedForVulnerabilities": {
                      "description": "Whether the asset has been assessed for vulnerabilities at least once",
                      "order": 3,
                      "title": "Assessed for Vulnerabilities",
                      "type": "boolean"
                    },
                    "configurations": {
                      "description": "Configuration key-values pairs enumerated on the asset",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 4,
                      "title": "Configurations",
                      "type": "array"
                    },
                    "databases": {
                      "description": "Databases enumerated on the asset",
                      "items": {
                        "$ref": "#/definitions/database"
                      },
                      "order": 5,
                      "title": "Databases",
                      "type": "array"
                    },
                    "files": {
                      "description": "Files discovered with searching on the asset",
                      "items": {
                        "$ref": "#/definitions/file"
                      },
                      "order": 6,
                      "title": "Files",
                      "type": "array"
                    },
                    "history": {
                      "description": "History of changes to the asset over time",
                      "items": {
                        "$ref": "#/definitions/history"
                      },
                      "order": 7,
                      "title": "History",
                      "type": "array"
                    },
                    "hostName": {
                      "description": "Primary host name (local or FQDN) of the asset",
                      "order": 8,
                      "title": "Hostname",
                      "type": "string"
                    },
                    "hostNames": {
                      "description": "All hostnames or aliases discovered on the asset",
                      "items": {
                        "$ref": "#/definitions/hostName"
                      },
                      "order": 9,
                      "title": "Hostnames",
                      "type": "array"
                    },
                    "id": {
                      "description": "Identifier of the asset",
                      "order": 10,
                      "title": "ID",
                      "type": "integer"
                    },
                    "ids": {
                      "description": "Unique identifiers found on the asset, such as hardware or operating system identifiers",
                      "items": {
                        "$ref": "#/definitions/id"
                      },
                      "order": 11,
                      "title": "IDs",
                      "type": "array"
                    },
                    "ip": {
                      "description": "Primary IPv4 or IPv6 address of the asset",
                      "order": 12,
                      "title": "IP",
                      "type": "string"
                    },
                    "links": {
                      "description": "Hypermedia links to corresponding or related resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 13,
                      "title": "Links",
                      "type": "array"
                    },
                    "mac": {
                      "description": "Media Access Control (MAC) address, e.g. AF:12:BC:5A:F7:48",
                      "order": 14,
                      "title": "MAC",
                      "type": "string"
                    },
                    "os": {
                      "description": "Full description of the operating system of the asset",
                      "order": 15,
                      "title": "OS",
                      "type": "string"
                    },
                    "osFingerprint": {
                      "$ref": "#/definitions/osFingerprint",
                      "description": "Details of the operating system of the asset",
                      "order": 16,
                      "title": "OS Fingerprint"
                    },
                    "rawRiskScore": {
                      "description": "Base risk score of the asset",
                      "order": 17,
                      "title": "Raw Risk Score",
                      "type": "number"
                    },
                    "riskScore": {
                      "description": "Risk score (with criticality adjustments) of the asset",
                      "order": 18,
                      "title": "Risk Score",
                      "type": "number"
                    },
                    "services": {
                      "description": "Services discovered on the asset",
                      "items": {
                        "$ref": "#/definitions/service"
                      },
                      "order": 19,
                      "title": "Services",
                      "type": "array"
                    },
                    "software": {
                      "description": "Software discovered on the asset",
                      "items": {
                        "$ref": "#/definitions/software"
                      },
                      "order": 20,
                      "title": "Software",
                      "type": "array"
                    },
                    "type": {
                      "description": "Type of asset e.g. unknown, guest, hypervisor, physical, mobile",
                      "order": 21,
                      "title": "Type",
                      "type": "string"
                    },
                    "userGroups": {
                      "description": "User group accounts enumerated on the asset",
                      "items": {
                        "$ref": "#/definitions/userGroup"
                      },
                      "order": 22,
                      "title": "User Groups",
                      "type": "array"
                    },
                    "users": {
                      "description": "User accounts enumerated on the asset",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 23,
                      "title": "Users",
                      "type": "array"
                    },
                    "vulnerabilities": {
                      "$ref": "#/definitions/vulnerabilities",
                      "description": " Summary information for vulnerabilities on the asset",
                      "order": 24,
                      "title": "Vulnerabilities"
                    }
                  },
                  "title": "Asset",
                  "type": "object"
                },
                "configuration": {
                  "properties": {
                    "name": {
                      "description": "Name of the configuration value",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "value": {
                      "description": "Configuration value",
                      "order": 2,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Configuration",
                  "type": "object"
                },
                "cpe": {
                  "properties": {
                    "edition": {
                      "description": "Edition-related terms applied by the vendor to the product",
                      "order": 1,
                      "title": "Edition",
                      "type": "string"
                    },
                    "language": {
                      "description": "Defines the language supported in the user interface of the product being described. The format of the language tag adheres to RFC 5646",
                      "order": 2,
                      "title": "Language",
                      "type": "string"
                    },
                    "other": {
                      "description": "Captures any other general descriptive or identifying information which is vendor- or product-specific and which does not logically fit in any other attribute value",
                      "order": 3,
                      "title": "Other",
                      "type": "string"
                    },
                    "part": {
                      "description": "A single letter code that designates the particular platform part that is being identified",
                      "order": 4,
                      "title": "Part",
                      "type": "string"
                    },
                    "product": {
                      "description": "Most common and recognizable title or name of the product",
                      "order": 5,
                      "title": "Product",
                      "type": "string"
                    },
                    "swEdition": {
                      "description": "Characterizes how the product is tailored to a particular market or class of end users",
                      "order": 6,
                      "title": "Software Edition",
                      "type": "string"
                    },
                    "targetHW": {
                      "description": "Characterize the instruction set architecture on which the product operates",
                      "order": 7,
                      "title": "Target Hardware",
                      "type": "string"
                    },
                    "targetSW": {
                      "description": "Characterizes the software computing environment within which the product operates",
                      "order": 8,
                      "title": "Target Software",
                      "type": "string"
                    },
                    "update": {
                      "description": "Vendor-specific alphanumeric strings characterizing the particular update, service pack, or point release of the product",
                      "order": 9,
                      "title": "Update",
                      "type": "string"
                    },
                    "v2.2": {
                      "description": "The full CPE string in the CPE 2.2 format",
                      "order": 10,
                      "title": "Version 2.2",
                      "type": "string"
                    },
                    "v2.3": {
                      "description": "The full CPE string in the CPE 2.3 format",
                      "order": 11,
                      "title": "Version 2.3",
                      "type": "string"
                    },
                    "vendor": {
                      "description": "The person or organization that manufactured or created the product",
                      "order": 12,
                      "title": "Vendor",
                      "type": "string"
                    },
                    "version": {
                      "description": "Vendor-specific alphanumeric strings characterizing the particular release version of the product",
                      "order": 13,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "Cpe",
                  "type": "object"
                },
                "database": {
                  "properties": {
                    "description": {
                      "description": "Description of the database instance",
                      "order": 1,
                      "title": "Description",
                      "type": "string"
                    },
                    "id": {
                      "description": "Identifier of the database",
                      "order": 2,
                      "title": "ID",
                      "type": "integer"
                    },
                    "name": {
                      "description": "Name of the database instance",
                      "order": 3,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "title": "Database",
                  "type": "object"
                },
                "file": {
                  "properties": {
                    "attributes": {
                      "description": "Attributes detected on the file",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 1,
                      "title": "Attributes",
                      "type": "array"
                    },
                    "content": {
                      "description": "Contents of the file",
                      "displayType": "bytes",
                      "format": "bytes",
                      "order": 5,
                      "title": "Contents",
                      "type": "string"
                    },
                    "name": {
                      "description": "Name of the file",
                      "order": 2,
                      "title": "Name",
                      "type": "string"
                    },
                    "size": {
                      "description": "Size of the regular file (in bytes). If the file is a directory, no value is returned",
                      "order": 3,
                      "title": "Size",
                      "type": "integer"
                    },
                    "type": {
                      "description": "Type of the file, e.g. file or directory",
                      "order": 4,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                },
                "history": {
                  "properties": {
                    "date": {
                      "description": "Date the asset information was collected or changed",
                      "order": 1,
                      "title": "Date",
                      "type": "string"
                    },
                    "description": {
                      "description": "Additional information describing the change",
                      "order": 2,
                      "title": "Description",
                      "type": "string"
                    },
                    "scanId": {
                      "description": "If a scan-oriented change, the identifier of the corresponding scan the asset was scanned in",
                      "order": 3,
                      "title": "Scan ID",
                      "type": "integer"
                    },
                    "type": {
                      "description": "Type, for additional information see the help section of this plugin",
                      "order": 4,
                      "title": "Type",
                      "type": "string"
                    },
                    "user": {
                      "description": "User",
                      "order": 5,
                      "title": "User",
                      "type": "string"
                    },
                    "version": {
                      "description": "Version",
                      "order": 6,
                      "title": "Version",
                      "type": "integer"
                    },
                    "vulnerabilityExceptionId": {
                      "description": "Vulnerability exception ID",
                      "order": 7,
                      "title": "Vulnerability Exception ID",
                      "type": "integer"
                    }
                  },
                  "title": "History",
                  "type": "object"
                },
                "hostName": {
                  "properties": {
                    "name": {
                      "description": "Name",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "source": {
                      "description": "Source",
                      "order": 2,
                      "title": "Source",
                      "type": "string"
                    }
                  },
                  "title": "HostName",
                  "type": "object"
                },
                "id": {
                  "properties": {
                    "id": {
                      "description": "ID",
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "source": {
                      "description": "Source",
                      "order": 2,
                      "title": "Source",
                      "type": "string"
                    }
                  },
                  "title": "Id",
                  "type": "object"
                },
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                },
                "osFingerprint": {
                  "properties": {
                    "architecture": {
                      "description": "The architecture of the operating system",
                      "order": 1,
                      "title": "Architecture",
                      "type": "string"
                    },
                    "configurations": {
                      "description": "Configuration key-values pairs enumerated on the operating system",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 2,
                      "title": "Configuration",
                      "type": "array"
                    },
                    "cpe": {
                      "$ref": "#/definitions/cpe",
                      "description": "Common Platform Enumeration",
                      "order": 3,
                      "title": "CPE"
                    },
                    "description": {
                      "description": "The description of the operating system (containing vendor, family, product, version and architecture in a single string)",
                      "order": 4,
                      "title": "Description",
                      "type": "string"
                    },
                    "family": {
                      "description": "Family of the operating system",
                      "order": 5,
                      "title": "Family",
                      "type": "string"
                    },
                    "id": {
                      "description": "Identifier of the operating system",
                      "order": 6,
                      "title": "ID",
                      "type": "integer"
                    },
                    "product": {
                      "description": "Name of the operating system",
                      "order": 7,
                      "title": "Product",
                      "type": "string"
                    },
                    "systemName": {
                      "description": "A combination of vendor and family (with redundancies removed), suitable for grouping",
                      "order": 8,
                      "title": "System Name",
                      "type": "string"
                    },
                    "type": {
                      "description": "Type of operating system",
                      "order": 9,
                      "title": "Type",
                      "type": "string"
                    },
                    "vendor": {
                      "description": "Vendor of the operating system",
                      "order": 10,
                      "title": "Vendor",
                      "type": "string"
                    },
                    "version": {
                      "description": "Version of the operating system",
                      "order": 11,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "OsFingerprint",
                  "type": "object"
                },
                "page": {
                  "properties": {
                    "linkType": {
                      "description": "Type of link used to traverse or detect the page",
                      "order": 1,
                      "title": "Link Type",
                      "type": "string"
                    },
                    "path": {
                      "description": "Path to the page (URI)",
                      "order": 2,
                      "title": "Path",
                      "type": "string"
                    },
                    "response": {
                      "description": "HTTP response code observed with retrieving the page",
                      "order": 3,
                      "title": "Response",
                      "type": "integer"
                    }
                  },
                  "title": "Page",
                  "type": "object"
                },
                "service": {
                  "properties": {
                    "configurations": {
                      "description": "Configuration key-values pairs enumerated on the service",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 1,
                      "title": "Configurations",
                      "type": "array"
                    },
                    "databases": {
                      "description": "Databases enumerated on the service",
                      "items": {
                        "$ref": "#/definitions/database"
                      },
                      "order": 2,
                      "title": "Databases",
                      "type": "array"
                    },
                    "family": {
                      "description": "Family of the service",
                      "order": 3,
                      "title": "Family",
                      "type": "string"
                    },
                    "links": {
                      "description": "Hypermedia links to corresponding or related resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 4,
                      "title": "Links",
                      "type": "array"
                    },
                    "name": {
                      "description": "Name of the service",
                      "order": 5,
                      "title": "Name",
                      "type": "string"
                    },
                    "port": {
                      "description": "Port of the service",
                      "order": 6,
                      "title": "Port",
                      "type": "integer"
                    },
                    "product": {
                      "description": "Product running the service",
                      "order": 7,
                      "title": "Product",
                      "type": "string"
                    },
                    "protocol": {
                      "description": "Protocol of the service",
                      "order": 8,
                      "title": "Protocol",
                      "type": "string"
                    },
                    "userGroups": {
                      "description": "User groups",
                      "items": {
                        "$ref": "#/definitions/userGroup"
                      },
                      "order": 9,
                      "title": "User Groups",
                      "type": "array"
                    },
                    "users": {
                      "description": "Users",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 10,
                      "title": "Users",
                      "type": "array"
                    },
                    "vendor": {
                      "description": "Vendor of the service",
                      "order": 11,
                      "title": "Vendor",
                      "type": "string"
                    },
                    "version": {
                      "description": "Version of the service",
                      "order": 12,
                      "title": "Version",
                      "type": "string"
                    },
                    "webApplications": {
                      "description": "Web applications found on the service",
                      "items": {
                        "$ref": "#/definitions/webApplication"
                      },
                      "order": 13,
                      "title": "Web Applications",
                      "type": "array"
                    }
                  },
                  "title": "Service",
                  "type": "object"
                },
                "software": {
                  "properties": {
                    "configurations": {
                      "description": "Configurations",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 1,
                      "title": "Configurations",
                      "type": "array"
                    },
                    "cpe": {
                      "$ref": "#/definitions/cpe",
                      "description": "CPE",
                      "order": 2,
                      "title": "CPE"
                    },
                    "description": {
                      "description": "Description of the software",
                      "order": 3,
                      "title": "Description",
                      "type": "string"
                    },
                    "family": {
                      "description": "Family of the software",
                      "order": 4,
                      "title": "Family",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 5,
                      "title": "ID",
                      "type": "integer"
                    },
                    "product": {
                      "description": "Product of the software",
                      "order": 6,
                      "title": "Product",
                      "type": "string"
                    },
                    "type": {
                      "description": "Type of the software",
                      "order": 7,
                      "title": "Type",
                      "type": "string"
                    },
                    "vendor": {
                      "description": "Vendor of the software",
                      "order": 8,
                      "title": "Vendor",
                      "type": "string"
                    },
                    "version": {
                      "description": "Version of the software",
                      "order": 9,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "Software",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "fullName": {
                      "description": "Full name of the user account",
                      "order": 1,
                      "title": "Full Name",
                      "type": "string"
                    },
                    "id": {
                      "description": "Identifier of the user account",
                      "order": 2,
                      "title": "ID",
                      "type": "integer"
                    },
                    "name": {
                      "description": "Name of the user account",
                      "order": 3,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                },
                "userGroup": {
                  "properties": {
                    "id": {
                      "description": "Identifier of the user group",
                      "order": 1,
                      "title": "ID",
                      "type": "integer"
                    },
                    "name": {
                      "description": "Name of the user group",
                      "order": 2,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "title": "UserGroup",
                  "type": "object"
                },
                "vulnerabilities": {
                  "properties": {
                    "critical": {
                      "description": "Number of critical vulnerabilities",
                      "order": 1,
                      "title": "Critical",
                      "type": "integer"
                    },
                    "exploits": {
                      "description": "Number of distinct exploits that can exploit any of the vulnerabilities on the asset",
                      "order": 2,
                      "title": "Exploits",
                      "type": "integer"
                    },
                    "malwareKits": {
                      "description": "Number of distinct malware kits that vulnerabilities on the asset are susceptible to",
                      "order": 3,
                      "title": "Malware Kits",
                      "type": "integer"
                    },
                    "moderate": {
                      "description": "Number of moderate vulnerabilities",
                      "order": 4,
                      "title": "Moderate",
                      "type": "integer"
                    },
                    "severe": {
                      "description": "Number of severe vulnerabilities",
                      "order": 5,
                      "title": "Severe",
                      "type": "integer"
                    },
                    "total": {
                      "description": "Total number of vulnerabilities",
                      "order": 6,
                      "title": "Total",
                      "type": "integer"
                    }
                  },
                  "title": "Vulnerabilities",
                  "type": "object"
                },
                "webApplication": {
                  "properties": {
                    "id": {
                      "description": "Identifier of the web application",
                      "order": 1,
                      "title": "ID",
                      "type": "integer"
                    },
                    "pages": {
                      "description": "Pages",
                      "items": {
                        "$ref": "#/definitions/page"
                      },
                      "order": 2,
                      "title": "Pages",
                      "type": "array"
                    },
                    "root": {
                      "description": "Web root of the web application",
                      "order": 3,
                      "title": "Root",
                      "type": "string"
                    },
                    "virtualHost": {
                      "description": "Virtual host of the web application",
                      "order": 4,
                      "title": "Virtual Host",
                      "type": "string"
                    }
                  },
                  "title": "WebApplication",
                  "type": "object"
                }
              },
              "properties": {
                "asset": {
                  "$ref": "#/definitions/asset",
                  "description": "Asset details",
                  "order": 1,
                  "title": "Asset"
                }
              },
              "required": [
                "asset"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          }
        },
        "tags": null,
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": ""
      }
    ],
    "triggers": [
      {
        "id": "ab442ba5-50f4-47e2-a40e-cbcf61383fe8",
        "identifier": "new_message_received",
        "name": "!lookup-vuln-hosts Trigger",
        "description": "Trigger this workflow using the lookup-vuln-hosts command:\n\n!lookup-vuln-hosts bluekeep\n!lookup-vuln-hosts CVE-2019-0708",
        "input": {
          "channel_name": "change_me",
          "message_content": "!lookup-vuln-hosts\\s+\\S+",
          "team_name": "change_me"
        },
        "inputJsonSchema": {
          "properties": {
            "channel_name": {
              "description": "Channel",
              "order": 2,
              "title": "Channel Name",
              "type": "string"
            },
            "message_content": {
              "description": "Regex to match new messages against",
              "order": 3,
              "title": "Message Content",
              "type": "string"
            },
            "team_name": {
              "description": "Team name",
              "order": 1,
              "title": "Team Name",
              "type": "string"
            }
          },
          "required": [
            "team_name",
            "channel_name"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "body": {
              "properties": {
                "content": {
                  "description": "Content",
                  "order": 1,
                  "title": "Content",
                  "type": "string"
                },
                "contentType": {
                  "description": "Content type",
                  "order": 2,
                  "title": "Content Type",
                  "type": "string"
                }
              },
              "title": "Body",
              "type": "object"
            },
            "from": {
              "properties": {
                "user": {
                  "$ref": "#/definitions/user",
                  "description": "User",
                  "order": 1,
                  "title": "User"
                }
              },
              "title": "From",
              "type": "object"
            },
            "message": {
              "properties": {
                "body": {
                  "$ref": "#/definitions/body",
                  "description": "Body",
                  "order": 1,
                  "title": "Body"
                },
                "createdDateTime": {
                  "description": "Created date time",
                  "order": 3,
                  "title": "Created Date Time",
                  "type": "string"
                },
                "from": {
                  "$ref": "#/definitions/from",
                  "description": "From",
                  "order": 2,
                  "title": "From"
                },
                "id": {
                  "description": "ID",
                  "order": 8,
                  "title": "ID",
                  "type": "string"
                },
                "importance": {
                  "description": "Importance",
                  "order": 5,
                  "title": "Importance",
                  "type": "string"
                },
                "locale": {
                  "description": "Locale",
                  "order": 7,
                  "title": "Locale",
                  "type": "string"
                },
                "messageType": {
                  "description": "Message type",
                  "order": 6,
                  "title": "Message Type",
                  "type": "string"
                },
                "webUrl": {
                  "description": "Web URL",
                  "order": 4,
                  "title": "Web URL",
                  "type": "string"
                }
              },
              "title": "Message",
              "type": "object"
            },
            "user": {
              "properties": {
                "displayName": {
                  "description": "Display name",
                  "order": 1,
                  "title": "Display name",
                  "type": "string"
                },
                "id": {
                  "description": "ID",
                  "order": 2,
                  "title": "ID",
                  "type": "string"
                }
              },
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "message": {
              "$ref": "#/definitions/message",
              "description": "The message object that was created",
              "order": 1,
              "title": "Message"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_plugin",
        "plugin": {
          "name": "Microsoft Teams",
          "slugVendor": "rapid7",
          "slugName": "microsoft_teams",
          "slugVersion": "2.0.4",
          "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/2.0.4/icon.png"
        }
      }
    ]
  }
}
