{
  "kom": {
    "komandVersion": "1.53.3-0-gd1a07",
    "komFileVersion": "2.0.0",
    "exportedAt": "2020-06-19T14:14:56.742312543Z",
    "workflowVersions": [
      {
        "name": "Virtually Patch Vulnerabilities Found by InsightVM with Trend Micro Deep Security",
        "type": "runnable",
        "version": "",
        "description": "",
        "graph": {
          "edges": {
            "0687143c-8096-475a-82d6-3fd6572976f8": {
              "id": "0687143c-8096-475a-82d6-3fd6572976f8",
              "name": "",
              "description": "",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91",
              "fromNodeId": "89d7ec9f-d138-4fac-addd-d47e103f9677",
              "toNodeId": "5ba09430-c569-41a4-b10e-712476e8ad08"
            },
            "109473d0-8528-4144-8f82-6f39dc15dfa6": {
              "id": "109473d0-8528-4144-8f82-6f39dc15dfa6",
              "name": "",
              "description": "",
              "parentNodeId": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831",
              "fromNodeId": "d27966bd-d54e-4d37-9065-66198970436c",
              "toNodeId": ""
            },
            "22d406b6-bd48-4128-b303-69423093c753": {
              "id": "22d406b6-bd48-4128-b303-69423093c753",
              "name": "One Asset Found",
              "description": "",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91",
              "fromNodeId": "5ba09430-c569-41a4-b10e-712476e8ad08",
              "toNodeId": "40100b9c-79da-4894-a3ab-809fcd6f0f7e"
            },
            "255882c2-b19a-44be-8cf4-4a1a53bfd81d": {
              "id": "255882c2-b19a-44be-8cf4-4a1a53bfd81d",
              "name": "",
              "description": "",
              "parentNodeId": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831",
              "fromNodeId": "61c2921a-8181-4afa-b5be-3345803c4b57",
              "toNodeId": ""
            },
            "3c513f4a-2774-4a6d-935e-32cdbb42069c": {
              "id": "3c513f4a-2774-4a6d-935e-32cdbb42069c",
              "name": "",
              "description": "",
              "parentNodeId": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831",
              "fromNodeId": "0e430408-e589-4fd4-b80e-4cd7ba2a6a03",
              "toNodeId": ""
            },
            "53ab768b-cf8f-4f09-ac01-c59e5cbd3c39": {
              "id": "53ab768b-cf8f-4f09-ac01-c59e5cbd3c39",
              "name": "Hostname Available",
              "description": "",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91",
              "fromNodeId": "6f5ba517-fb17-42a8-8264-135b05ee0bfd",
              "toNodeId": "89d7ec9f-d138-4fac-addd-d47e103f9677"
            },
            "5bd425aa-4600-4dcf-9ea4-44b02d1c517b": {
              "id": "5bd425aa-4600-4dcf-9ea4-44b02d1c517b",
              "name": "",
              "description": "",
              "parentNodeId": "d27966bd-d54e-4d37-9065-66198970436c",
              "fromNodeId": "d27966bd-d54e-4d37-9065-66198970436c",
              "toNodeId": "1c6f6b18-1a43-4142-8216-08331b247f2f"
            },
            "5c42a41c-bc3b-4eed-8727-0de65cb6c49b": {
              "id": "5c42a41c-bc3b-4eed-8727-0de65cb6c49b",
              "name": "",
              "description": "",
              "parentNodeId": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831",
              "fromNodeId": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831",
              "toNodeId": "5d784560-358a-45f6-af1f-fa2766a11190"
            },
            "63f4d6d7-c69f-4c3f-841f-3f895728b464": {
              "id": "63f4d6d7-c69f-4c3f-841f-3f895728b464",
              "name": "No Rules",
              "description": "",
              "parentNodeId": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831",
              "fromNodeId": "95d758d7-5538-415c-965d-09a4bf23ed5e",
              "toNodeId": "0e430408-e589-4fd4-b80e-4cd7ba2a6a03"
            },
            "6ca5ff85-2c60-442c-bf45-a5f4d8daa73c": {
              "id": "6ca5ff85-2c60-442c-bf45-a5f4d8daa73c",
              "name": "",
              "description": "",
              "parentNodeId": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831",
              "fromNodeId": "9adcd58c-da41-46ee-ac8d-39f5d48b07c2",
              "toNodeId": "95d758d7-5538-415c-965d-09a4bf23ed5e"
            },
            "6e7dc084-a5c1-451e-a82f-68fbc97cb37e": {
              "id": "6e7dc084-a5c1-451e-a82f-68fbc97cb37e",
              "name": "",
              "description": "",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91",
              "fromNodeId": "0131ed50-9d8d-49dc-befc-bab4e2a2f7f8",
              "toNodeId": ""
            },
            "71ef0249-56aa-430a-a1b7-09fc8aab1409": {
              "id": "71ef0249-56aa-430a-a1b7-09fc8aab1409",
              "name": "",
              "description": "",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91",
              "fromNodeId": "69616d3a-9bce-4c17-a2ea-62f100408be1",
              "toNodeId": ""
            },
            "79cda949-d648-4cab-8847-16d9d2019149": {
              "id": "79cda949-d648-4cab-8847-16d9d2019149",
              "name": "",
              "description": "",
              "parentNodeId": "d27966bd-d54e-4d37-9065-66198970436c",
              "fromNodeId": "33e146b6-7a9e-4821-94e7-4f5e26cc4a5f",
              "toNodeId": ""
            },
            "82860682-a8c1-4f45-b732-fae977e781d7": {
              "id": "82860682-a8c1-4f45-b732-fae977e781d7",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a2e467b7-d327-4a87-aed2-50a884128720",
              "toNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91"
            },
            "940c0621-56f3-4350-b0e4-bb836ef593f2": {
              "id": "940c0621-56f3-4350-b0e4-bb836ef593f2",
              "name": "",
              "description": "",
              "parentNodeId": "d27966bd-d54e-4d37-9065-66198970436c",
              "fromNodeId": "1c6f6b18-1a43-4142-8216-08331b247f2f",
              "toNodeId": "148873f7-f752-4fe2-b83b-c45545c8d3de"
            },
            "9e102323-b878-4a05-aca3-a770122a098e": {
              "id": "9e102323-b878-4a05-aca3-a770122a098e",
              "name": "No CVE",
              "description": "",
              "parentNodeId": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831",
              "fromNodeId": "3955c32b-9408-4905-8857-2876b518c7f6",
              "toNodeId": "61c2921a-8181-4afa-b5be-3345803c4b57"
            },
            "a1fd8b4e-fbf3-4241-8158-b712f91da719": {
              "id": "a1fd8b4e-fbf3-4241-8158-b712f91da719",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91",
              "toNodeId": ""
            },
            "aba8145b-9908-4e43-93fb-93d07517b4b9": {
              "id": "aba8145b-9908-4e43-93fb-93d07517b4b9",
              "name": "No or Multiple Assets Found",
              "description": "",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91",
              "fromNodeId": "418d2858-b0ec-4d0b-b238-9d0f7eadcd52",
              "toNodeId": "0131ed50-9d8d-49dc-befc-bab4e2a2f7f8"
            },
            "ae41fe2a-5bfc-4984-adfd-0f4f2fe78506": {
              "id": "ae41fe2a-5bfc-4984-adfd-0f4f2fe78506",
              "name": "No or Multiple Assets Found",
              "description": "",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91",
              "fromNodeId": "5ba09430-c569-41a4-b10e-712476e8ad08",
              "toNodeId": "ab54df2c-c300-4649-b805-a3845efe7a1d"
            },
            "b3127dae-09e2-4a51-9b35-7d07a5fbefc2": {
              "id": "b3127dae-09e2-4a51-9b35-7d07a5fbefc2",
              "name": "",
              "description": "",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91",
              "fromNodeId": "40100b9c-79da-4894-a3ab-809fcd6f0f7e",
              "toNodeId": "52baf553-33c9-4ac0-89e5-896a0931dcdc"
            },
            "b60d0a95-ca1f-4657-ba5b-58cdfb6b0afe": {
              "id": "b60d0a95-ca1f-4657-ba5b-58cdfb6b0afe",
              "name": "No Hostname Available",
              "description": "",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91",
              "fromNodeId": "6f5ba517-fb17-42a8-8264-135b05ee0bfd",
              "toNodeId": "69616d3a-9bce-4c17-a2ea-62f100408be1"
            },
            "b71be15c-d7ae-454d-947b-002ead28c501": {
              "id": "b71be15c-d7ae-454d-947b-002ead28c501",
              "name": "",
              "description": "",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91",
              "fromNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91",
              "toNodeId": "6f5ba517-fb17-42a8-8264-135b05ee0bfd"
            },
            "b7a3891b-6546-43e0-88ec-2603f60b03e6": {
              "id": "b7a3891b-6546-43e0-88ec-2603f60b03e6",
              "name": "",
              "description": "",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91",
              "fromNodeId": "ab54df2c-c300-4649-b805-a3845efe7a1d",
              "toNodeId": "877536f9-b731-4215-9d63-397bd5cd5ce7"
            },
            "c790327d-9b36-479e-9d1c-5f83a169b4b6": {
              "id": "c790327d-9b36-479e-9d1c-5f83a169b4b6",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "cd4cc555-b09e-40e3-9779-6b8087adf770",
              "toNodeId": "cc076920-1457-421f-b290-6c0c415e31cc"
            },
            "c95fbfa1-7073-4119-b5d3-e88134299b1c": {
              "id": "c95fbfa1-7073-4119-b5d3-e88134299b1c",
              "name": "",
              "description": "",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91",
              "fromNodeId": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831",
              "toNodeId": ""
            },
            "cb1c64ee-8848-4017-95a3-f0a79c014013": {
              "id": "cb1c64ee-8848-4017-95a3-f0a79c014013",
              "name": "CVE Found",
              "description": "",
              "parentNodeId": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831",
              "fromNodeId": "3955c32b-9408-4905-8857-2876b518c7f6",
              "toNodeId": "9adcd58c-da41-46ee-ac8d-39f5d48b07c2"
            },
            "cc9ce2cc-4721-4132-b354-48a3e8c2c7f9": {
              "id": "cc9ce2cc-4721-4132-b354-48a3e8c2c7f9",
              "name": "Rules Found",
              "description": "",
              "parentNodeId": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831",
              "fromNodeId": "95d758d7-5538-415c-965d-09a4bf23ed5e",
              "toNodeId": "d27966bd-d54e-4d37-9065-66198970436c"
            },
            "d51d9151-669c-4f0f-bcac-21e1ae007541": {
              "id": "d51d9151-669c-4f0f-bcac-21e1ae007541",
              "name": "One Asset Found",
              "description": "",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91",
              "fromNodeId": "418d2858-b0ec-4d0b-b238-9d0f7eadcd52",
              "toNodeId": "40100b9c-79da-4894-a3ab-809fcd6f0f7e"
            },
            "d9aa2c60-a451-4765-aa9c-ffc782778b95": {
              "id": "d9aa2c60-a451-4765-aa9c-ffc782778b95",
              "name": "",
              "description": "",
              "parentNodeId": "d27966bd-d54e-4d37-9065-66198970436c",
              "fromNodeId": "148873f7-f752-4fe2-b83b-c45545c8d3de",
              "toNodeId": "101df196-81f6-40cb-93d9-fab5f2d93335"
            },
            "db30aefe-584e-44ec-b7ea-314f5139e52b": {
              "id": "db30aefe-584e-44ec-b7ea-314f5139e52b",
              "name": "",
              "description": "",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91",
              "fromNodeId": "877536f9-b731-4215-9d63-397bd5cd5ce7",
              "toNodeId": "418d2858-b0ec-4d0b-b238-9d0f7eadcd52"
            },
            "e6b87404-8339-417e-ad63-a8d607f00b71": {
              "id": "e6b87404-8339-417e-ad63-a8d607f00b71",
              "name": "",
              "description": "",
              "parentNodeId": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831",
              "fromNodeId": "5d784560-358a-45f6-af1f-fa2766a11190",
              "toNodeId": "3955c32b-9408-4905-8857-2876b518c7f6"
            },
            "e9129587-f93a-4db0-8708-a59fd71a5896": {
              "id": "e9129587-f93a-4db0-8708-a59fd71a5896",
              "name": "",
              "description": "",
              "parentNodeId": "d27966bd-d54e-4d37-9065-66198970436c",
              "fromNodeId": "101df196-81f6-40cb-93d9-fab5f2d93335",
              "toNodeId": "33e146b6-7a9e-4821-94e7-4f5e26cc4a5f"
            },
            "eaf01533-2bdc-4042-b41f-d0c7450b384d": {
              "id": "eaf01533-2bdc-4042-b41f-d0c7450b384d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "cc076920-1457-421f-b290-6c0c415e31cc",
              "toNodeId": "a2e467b7-d327-4a87-aed2-50a884128720"
            },
            "efb5aa10-a863-4b70-9c45-3bb03ab9d567": {
              "id": "efb5aa10-a863-4b70-9c45-3bb03ab9d567",
              "name": "",
              "description": "",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91",
              "fromNodeId": "52baf553-33c9-4ac0-89e5-896a0931dcdc",
              "toNodeId": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831"
            }
          },
          "nodes": {
            "0131ed50-9d8d-49dc-befc-bab4e2a2f7f8": {
              "id": "0131ed50-9d8d-49dc-befc-bab4e2a2f7f8",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91"
            },
            "0e430408-e589-4fd4-b80e-4cd7ba2a6a03": {
              "id": "0e430408-e589-4fd4-b80e-4cd7ba2a6a03",
              "parentNodeId": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831"
            },
            "101df196-81f6-40cb-93d9-fab5f2d93335": {
              "id": "101df196-81f6-40cb-93d9-fab5f2d93335",
              "parentNodeId": "d27966bd-d54e-4d37-9065-66198970436c"
            },
            "148873f7-f752-4fe2-b83b-c45545c8d3de": {
              "id": "148873f7-f752-4fe2-b83b-c45545c8d3de",
              "parentNodeId": "d27966bd-d54e-4d37-9065-66198970436c"
            },
            "1c6f6b18-1a43-4142-8216-08331b247f2f": {
              "id": "1c6f6b18-1a43-4142-8216-08331b247f2f",
              "parentNodeId": "d27966bd-d54e-4d37-9065-66198970436c"
            },
            "33e146b6-7a9e-4821-94e7-4f5e26cc4a5f": {
              "id": "33e146b6-7a9e-4821-94e7-4f5e26cc4a5f",
              "parentNodeId": "d27966bd-d54e-4d37-9065-66198970436c"
            },
            "3955c32b-9408-4905-8857-2876b518c7f6": {
              "id": "3955c32b-9408-4905-8857-2876b518c7f6",
              "parentNodeId": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831"
            },
            "40100b9c-79da-4894-a3ab-809fcd6f0f7e": {
              "id": "40100b9c-79da-4894-a3ab-809fcd6f0f7e",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91"
            },
            "418d2858-b0ec-4d0b-b238-9d0f7eadcd52": {
              "id": "418d2858-b0ec-4d0b-b238-9d0f7eadcd52",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91"
            },
            "52baf553-33c9-4ac0-89e5-896a0931dcdc": {
              "id": "52baf553-33c9-4ac0-89e5-896a0931dcdc",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91"
            },
            "5ba09430-c569-41a4-b10e-712476e8ad08": {
              "id": "5ba09430-c569-41a4-b10e-712476e8ad08",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91"
            },
            "5d784560-358a-45f6-af1f-fa2766a11190": {
              "id": "5d784560-358a-45f6-af1f-fa2766a11190",
              "parentNodeId": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831"
            },
            "61c2921a-8181-4afa-b5be-3345803c4b57": {
              "id": "61c2921a-8181-4afa-b5be-3345803c4b57",
              "parentNodeId": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831"
            },
            "69616d3a-9bce-4c17-a2ea-62f100408be1": {
              "id": "69616d3a-9bce-4c17-a2ea-62f100408be1",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91"
            },
            "6f5ba517-fb17-42a8-8264-135b05ee0bfd": {
              "id": "6f5ba517-fb17-42a8-8264-135b05ee0bfd",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91"
            },
            "877536f9-b731-4215-9d63-397bd5cd5ce7": {
              "id": "877536f9-b731-4215-9d63-397bd5cd5ce7",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91"
            },
            "89d7ec9f-d138-4fac-addd-d47e103f9677": {
              "id": "89d7ec9f-d138-4fac-addd-d47e103f9677",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91"
            },
            "8e5093ef-4293-42d6-9e9b-4aec2d278c91": {
              "id": "8e5093ef-4293-42d6-9e9b-4aec2d278c91",
              "parentNodeId": ""
            },
            "95d758d7-5538-415c-965d-09a4bf23ed5e": {
              "id": "95d758d7-5538-415c-965d-09a4bf23ed5e",
              "parentNodeId": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831"
            },
            "9adcd58c-da41-46ee-ac8d-39f5d48b07c2": {
              "id": "9adcd58c-da41-46ee-ac8d-39f5d48b07c2",
              "parentNodeId": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831"
            },
            "a2e467b7-d327-4a87-aed2-50a884128720": {
              "id": "a2e467b7-d327-4a87-aed2-50a884128720",
              "parentNodeId": ""
            },
            "ab54df2c-c300-4649-b805-a3845efe7a1d": {
              "id": "ab54df2c-c300-4649-b805-a3845efe7a1d",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91"
            },
            "bca0a9f7-e00c-4865-a3e4-83b5f29ba831": {
              "id": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831",
              "parentNodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91"
            },
            "cc076920-1457-421f-b290-6c0c415e31cc": {
              "id": "cc076920-1457-421f-b290-6c0c415e31cc",
              "parentNodeId": ""
            },
            "cd4cc555-b09e-40e3-9779-6b8087adf770": {
              "id": "cd4cc555-b09e-40e3-9779-6b8087adf770",
              "parentNodeId": ""
            },
            "d27966bd-d54e-4d37-9065-66198970436c": {
              "id": "d27966bd-d54e-4d37-9065-66198970436c",
              "parentNodeId": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831"
            }
          }
        },
        "steps": {
          "0131ed50-9d8d-49dc-befc-bab4e2a2f7f8": {
            "nodeId": "0131ed50-9d8d-49dc-befc-bab4e2a2f7f8",
            "name": "No or Multiple Matching Assets found in Deep Security",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Hostname/FQDN IVM: {{[8e5093ef-4293-42d6-9e9b-4aec2d278c91].[$item].[hostName]}}\nDS search result: {{[89d7ec9f-d138-4fac-addd-d47e103f9677].[computer_ids]}}\n\nExtracted Hostname: {{[ab54df2c-c300-4649-b805-a3845efe7a1d].[result].[0]}}\nDS search result: {{[877536f9-b731-4215-9d63-397bd5cd5ce7].[computer_ids]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "0e430408-e589-4fd4-b80e-4cd7ba2a6a03": {
            "nodeId": "0e430408-e589-4fd4-b80e-4cd7ba2a6a03",
            "name": "No IPS rule",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": true,
            "parameters": {
              "input": {
                "content": "{{[5d784560-358a-45f6-af1f-fa2766a11190].[vulnerability].[title]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "101df196-81f6-40cb-93d9-fab5f2d93335": {
            "nodeId": "101df196-81f6-40cb-93d9-fab5f2d93335",
            "name": "Approve Exception",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.0.0/icon.png"
            },
            "identifier": "review_exception",
            "continueOnFailure": true,
            "isDisabled": false,
            "parameters": {
              "input": {
                "comment": "Automatically approved by Rapid7 InsightConnect",
                "exception": "{{[148873f7-f752-4fe2-b83b-c45545c8d3de].[id]}}",
                "review": "Approved"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "comment": {
                  "description": "Comment to include in the review",
                  "order": 3,
                  "title": "Review Comment",
                  "type": "string"
                },
                "exception": {
                  "description": "The vulnerability exception ID to approve or reject",
                  "order": 1,
                  "title": "Exception ID",
                  "type": "integer"
                },
                "review": {
                  "description": "Approval or rejection of the exception",
                  "enum": [
                    "Approved",
                    "Rejected"
                  ],
                  "order": 2,
                  "title": "Review Outcome",
                  "type": "string"
                }
              },
              "required": [
                "review",
                "exception"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                }
              },
              "properties": {
                "links": {
                  "description": "Hypermedia links to corresponding or related resources",
                  "items": {
                    "$ref": "#/definitions/link"
                  },
                  "order": 1,
                  "title": "Links",
                  "type": "array"
                }
              },
              "required": [
                "links"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "148873f7-f752-4fe2-b83b-c45545c8d3de": {
            "nodeId": "148873f7-f752-4fe2-b83b-c45545c8d3de",
            "name": "Create Exception for Vulnerability",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.0.0/icon.png"
            },
            "identifier": "create_exception",
            "continueOnFailure": true,
            "isDisabled": false,
            "parameters": {
              "input": {
                "comment": "Protected by Trend Micro Deep Security",
                "expiration": "",
                "key": "",
                "port": 0,
                "reason": "Compensating Control",
                "scope": "{{[8e5093ef-4293-42d6-9e9b-4aec2d278c91].[$item].[id]}}",
                "type": "Asset",
                "vulnerability": "{{[bca0a9f7-e00c-4865-a3e4-83b5f29ba831].[$item].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "comment": {
                  "default": "Exception created with InsightConnect",
                  "description": "Comment to include in the vulnerability exception submission",
                  "order": 5,
                  "title": "Comment",
                  "type": "string"
                },
                "expiration": {
                  "description": "The date the vulnerability exception expires",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 4,
                  "title": "Expiration",
                  "type": "string"
                },
                "key": {
                  "description": "The key to identify a specific instance if the type is Instance",
                  "order": 7,
                  "title": "Vulnerability Key",
                  "type": "string"
                },
                "port": {
                  "description": "The port the vulnerability appears on if the type is Instance",
                  "order": 8,
                  "title": "Vulnerability Port",
                  "type": "integer"
                },
                "reason": {
                  "description": "Reason for the exception",
                  "enum": [
                    "False Positive",
                    "Compensating Control",
                    "Acceptable Use",
                    "Acceptable Risk",
                    "Other"
                  ],
                  "order": 6,
                  "title": "Reason",
                  "type": "string"
                },
                "scope": {
                  "description": "The ID of the scope the vulnerability exception applies to.  May be empty if type is Global",
                  "order": 3,
                  "title": "Scope ID",
                  "type": "integer"
                },
                "type": {
                  "description": "The type of vulnerability exception to create",
                  "enum": [
                    "Global",
                    "Site",
                    "Asset",
                    "Asset Group",
                    "Instance"
                  ],
                  "order": 1,
                  "title": "Exception Type",
                  "type": "string"
                },
                "vulnerability": {
                  "description": "The vulnerability this exception applies to",
                  "order": 2,
                  "title": "Vulnerability",
                  "type": "string"
                }
              },
              "required": [
                "comment",
                "reason",
                "type",
                "vulnerability"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                }
              },
              "properties": {
                "id": {
                  "description": "The vulnerability exception that was created",
                  "order": 1,
                  "title": "Created Exception ID",
                  "type": "integer"
                },
                "links": {
                  "description": "Hypermedia links to corresponding or related resources",
                  "items": {
                    "$ref": "#/definitions/link"
                  },
                  "order": 2,
                  "title": "Links",
                  "type": "array"
                }
              },
              "required": [
                "id",
                "links"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "1c6f6b18-1a43-4142-8216-08331b247f2f": {
            "nodeId": "1c6f6b18-1a43-4142-8216-08331b247f2f",
            "name": "Deploy to Computer",
            "type": "action",
            "plugin": {
              "name": "Trend Micro Deep Security",
              "slugVendor": "rapid7",
              "slugName": "trendmicro_deepsecurity",
              "slugVersion": "2.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/trendmicro_deepsecurity/2.2.0/icon.png"
            },
            "identifier": "deploy_rules",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "computer_or_policy": "computer",
                "id": "{{[d27966bd-d54e-4d37-9065-66198970436c].[$item]}}",
                "rules": "{{[9adcd58c-da41-46ee-ac8d-39f5d48b07c2].[ips_rules]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "computer_or_policy": {
                  "description": "Target for rule assignment",
                  "enum": [
                    "computer",
                    "policy"
                  ],
                  "order": 1,
                  "title": "Target",
                  "type": "string"
                },
                "id": {
                  "description": "ID of the target computer or policy",
                  "order": 2,
                  "title": "ID",
                  "type": "integer"
                },
                "rules": {
                  "description": "IPS rules to assign",
                  "items": {
                    "type": "integer"
                  },
                  "order": 3,
                  "title": "IPS Rules",
                  "type": "array"
                }
              },
              "required": [
                "computer_or_policy",
                "id",
                "rules"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "rules_assigned": {
                  "description": "All IPS rules currently assigned",
                  "items": {
                    "type": "integer"
                  },
                  "order": 1,
                  "title": "Rules Assigned",
                  "type": "array"
                },
                "rules_not_assigned": {
                  "description": "Unassigned IPS rules",
                  "items": {
                    "type": "integer"
                  },
                  "order": 2,
                  "title": "Not Assigned Rules",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "33e146b6-7a9e-4821-94e7-4f5e26cc4a5f": {
            "nodeId": "33e146b6-7a9e-4821-94e7-4f5e26cc4a5f",
            "name": "Summary",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "IVM Hostname/FQDN: {{[8e5093ef-4293-42d6-9e9b-4aec2d278c91].[$item].[hostName]}}\nIVM Asset ID: {{[8e5093ef-4293-42d6-9e9b-4aec2d278c91].[$item].[id]}}\nDS Asset ID: {{[d27966bd-d54e-4d37-9065-66198970436c].[$item]}}\n\nVulnerability: {{[5d784560-358a-45f6-af1f-fa2766a11190].[vulnerability].[title]}}\nCVEs: {{[5d784560-358a-45f6-af1f-fa2766a11190].[vulnerability].[cves]}}\nNew IPS rules: {{[9adcd58c-da41-46ee-ac8d-39f5d48b07c2].[ips_rules]}}\n\nException ID: {{[148873f7-f752-4fe2-b83b-c45545c8d3de].[id]}}\nException created: {{[148873f7-f752-4fe2-b83b-c45545c8d3de].[$success]}}\nException approved: {{[101df196-81f6-40cb-93d9-fab5f2d93335].[$success]}}\n\nAll currently assigned rules: \n{{[1c6f6b18-1a43-4142-8216-08331b247f2f].[rules_assigned]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "3955c32b-9408-4905-8857-2876b518c7f6": {
            "nodeId": "3955c32b-9408-4905-8857-2876b518c7f6",
            "name": "Check if CVE is Available",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "9e102323-b878-4a05-aca3-a770122a098e",
              "stepControlParams": [
                {
                  "edgeId": "9e102323-b878-4a05-aca3-a770122a098e",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "cb1c64ee-8848-4017-95a3-f0a79c014013",
                  "expression": {
                    "args": [
                      {
                        "name": "5d784560-358a-45f6-af1f-fa2766a11190.vulnerability.cves",
                        "type": "variable"
                      }
                    ],
                    "name": "is_defined",
                    "type": "function"
                  },
                  "expressionText": "is_defined({{[5d784560-358a-45f6-af1f-fa2766a11190].[vulnerability].[cves]}})"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "40100b9c-79da-4894-a3ab-809fcd6f0f7e": {
            "nodeId": "40100b9c-79da-4894-a3ab-809fcd6f0f7e",
            "name": "Asset Found",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "d51d9151-669c-4f0f-bcac-21e1ae007541",
                "22d406b6-bd48-4128-b303-69423093c753"
              ],
              "variableSets": [
                {
                  "arrayType": "integer",
                  "inputBuilderSchemas": null,
                  "name": "DS asset ID",
                  "type": "array",
                  "variables": {
                    "22d406b6-bd48-4128-b303-69423093c753": "{{[89d7ec9f-d138-4fac-addd-d47e103f9677].[computer_ids]}}",
                    "d51d9151-669c-4f0f-bcac-21e1ae007541": "{{[877536f9-b731-4215-9d63-397bd5cd5ce7].[computer_ids]}}"
                  }
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {
                "DS asset ID": {
                  "description": "Emitted variable \"DS asset ID\"",
                  "items": {
                    "type": "integer"
                  },
                  "order": 1,
                  "title": "DS asset ID",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {
                "DS asset ID": {
                  "description": "Emitted variable \"DS asset ID\"",
                  "items": {
                    "type": "integer"
                  },
                  "order": 1,
                  "title": "DS asset ID",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "418d2858-b0ec-4d0b-b238-9d0f7eadcd52": {
            "nodeId": "418d2858-b0ec-4d0b-b238-9d0f7eadcd52",
            "name": "Check if Asset was Found by Hostname",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "aba8145b-9908-4e43-93fb-93d07517b4b9",
              "stepControlParams": [
                {
                  "edgeId": "aba8145b-9908-4e43-93fb-93d07517b4b9",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "d51d9151-669c-4f0f-bcac-21e1ae007541",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "877536f9-b731-4215-9d63-397bd5cd5ce7.computer_ids",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": 1
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[877536f9-b731-4215-9d63-397bd5cd5ce7].[computer_ids]}}) = 1"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "52baf553-33c9-4ac0-89e5-896a0931dcdc": {
            "nodeId": "52baf553-33c9-4ac0-89e5-896a0931dcdc",
            "name": "Get Asset Vulnerabilities",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.0.0/icon.png"
            },
            "identifier": "get_asset_vulnerabilities",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "asset_id": "{{[8e5093ef-4293-42d6-9e9b-4aec2d278c91].[$item].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "asset_id": {
                  "description": "ID of the asset for which to find vulnerabilities",
                  "order": 1,
                  "title": "Asset ID",
                  "type": "string"
                }
              },
              "required": [
                "asset_id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "asset_vulnerability": {
                  "properties": {
                    "id": {
                      "description": "Vulnerability ID, ie. ssh-openssh-x11uselocalhost-x11-forwarding-session-hijack",
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "instances": {
                      "description": "Identifier of the report instance",
                      "order": 2,
                      "title": "Instances",
                      "type": "integer"
                    },
                    "links": {
                      "description": "Hypermedia links to corresponding or related resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 3,
                      "title": "Links",
                      "type": "array"
                    },
                    "results": {
                      "description": "The vulnerability check results for the finding. Multiple instances may be present if one or more checks fired, or a check has multiple independent results",
                      "items": {
                        "$ref": "#/definitions/asset_vulnerability_result"
                      },
                      "order": 4,
                      "title": "Results",
                      "type": "array"
                    },
                    "status": {
                      "description": "Status, ie. vulnerable",
                      "order": 5,
                      "title": "Status",
                      "type": "string"
                    }
                  },
                  "title": "Asset Vulnerability",
                  "type": "object"
                },
                "asset_vulnerability_result": {
                  "properties": {
                    "checkId": {
                      "description": "Check ID, ie. ssh-openssh-x11uselocalhost-x11-forwarding-session-hijack",
                      "order": 1,
                      "title": "Check ID",
                      "type": "string"
                    },
                    "exceptions": {
                      "description": "If the result is vulnerable with exceptions applied, the identifier(s) of the exceptions actively applied to the result",
                      "items": {
                        "type": "integer"
                      },
                      "order": 2,
                      "title": "Exceptions",
                      "type": "array"
                    },
                    "key": {
                      "description": "An additional discriminating key used to uniquely identify between multiple instances of results on the same finding",
                      "order": 3,
                      "title": "Key",
                      "type": "string"
                    },
                    "links": {
                      "description": "Hypermedia links to corresponding or related resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 4,
                      "title": "Links",
                      "type": "array"
                    },
                    "port": {
                      "description": "Port of the service the result was discovered on e.g. 22",
                      "order": 5,
                      "title": "Port",
                      "type": "integer"
                    },
                    "proof": {
                      "description": "Proof of the vulnerability, ie. <p><p>OpenBSD OpenSSH 4.3 on Linux</p></p>",
                      "order": 6,
                      "title": "Proof",
                      "type": "string"
                    },
                    "protocol": {
                      "description": "Protocol of the service the result was discovered on, ie. TCP",
                      "order": 7,
                      "title": "Protocol",
                      "type": "string"
                    },
                    "status": {
                      "description": "Status of the vulnerability check result, ie. vulnerable-version",
                      "order": 8,
                      "title": "Status",
                      "type": "string"
                    }
                  },
                  "title": "Asset Vulnerability Result",
                  "type": "object"
                },
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                }
              },
              "properties": {
                "vulnerabilities": {
                  "description": "Vulnerabilities found on the asset",
                  "items": {
                    "$ref": "#/definitions/asset_vulnerability"
                  },
                  "order": 1,
                  "title": "Vulnerabilities",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "5ba09430-c569-41a4-b10e-712476e8ad08": {
            "nodeId": "5ba09430-c569-41a4-b10e-712476e8ad08",
            "name": "Check if Asset was Found",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "ae41fe2a-5bfc-4984-adfd-0f4f2fe78506",
              "stepControlParams": [
                {
                  "edgeId": "22d406b6-bd48-4128-b303-69423093c753",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "89d7ec9f-d138-4fac-addd-d47e103f9677.computer_ids",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": 1
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[89d7ec9f-d138-4fac-addd-d47e103f9677].[computer_ids]}}) = 1"
                },
                {
                  "edgeId": "ae41fe2a-5bfc-4984-adfd-0f4f2fe78506",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "5d784560-358a-45f6-af1f-fa2766a11190": {
            "nodeId": "5d784560-358a-45f6-af1f-fa2766a11190",
            "name": "Get Vulnerability Details",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.0.0/icon.png"
            },
            "identifier": "get_vulnerability",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "id": "{{[bca0a9f7-e00c-4865-a3e4-83b5f29ba831].[$item].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "id": {
                  "description": "The identifier of the vulnerability to retrieve from InsightVM",
                  "order": 1,
                  "title": "Vulnerability ID",
                  "type": "string"
                }
              },
              "required": [
                "id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "cvss": {
                  "properties": {
                    "links": {
                      "description": "List of hypermedia links to corresponding resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 1,
                      "title": "Links",
                      "type": "array"
                    },
                    "v2": {
                      "$ref": "#/definitions/cvss_v2",
                      "description": "CVSSv2 details",
                      "order": 2,
                      "title": "V2"
                    },
                    "v3": {
                      "$ref": "#/definitions/cvss_v3",
                      "description": "CVSSv3 details",
                      "order": 3,
                      "title": "V3"
                    }
                  },
                  "title": "Cvss",
                  "type": "object"
                },
                "cvss_v2": {
                  "properties": {
                    "accessComplexity": {
                      "description": "CVSSv2 access complexity metric",
                      "order": 1,
                      "title": "Access Complexity",
                      "type": "string"
                    },
                    "accessVector": {
                      "description": "CVSSv2 access vector metric",
                      "order": 2,
                      "title": "Access Vector",
                      "type": "string"
                    },
                    "authentication": {
                      "description": "CVSSv2 authentication metric",
                      "order": 3,
                      "title": "Authentication",
                      "type": "string"
                    },
                    "availabilityImpact": {
                      "description": "CVSSv2 availability impact metric",
                      "order": 4,
                      "title": "Availability Impact",
                      "type": "string"
                    },
                    "confidentialityImpact": {
                      "description": "CVSSv2 confidentiality impact metric",
                      "order": 5,
                      "title": "Confidentiality Impact",
                      "type": "string"
                    },
                    "exploitScore": {
                      "description": "CVSSv2 combined exploit metric score (Access Complexity/Access Vector/Authentication)",
                      "order": 6,
                      "title": "Exploit Score",
                      "type": "number"
                    },
                    "impactScore": {
                      "description": "CVSSv2 combined impact metric score (Confidentiality/Integrity/Availability)",
                      "order": 7,
                      "title": "Impact Score",
                      "type": "number"
                    },
                    "integrityImpact": {
                      "description": "CVSSv2 integrity impact metric",
                      "order": 8,
                      "title": "Integrity Impact",
                      "type": "string"
                    },
                    "score": {
                      "description": "CVSSv2 score",
                      "order": 9,
                      "title": "Score",
                      "type": "number"
                    },
                    "vector": {
                      "description": "CVSSv2 combined vector string",
                      "order": 10,
                      "title": "Vector",
                      "type": "string"
                    }
                  },
                  "title": "Cvss V2",
                  "type": "object"
                },
                "cvss_v3": {
                  "properties": {
                    "attackComplexity": {
                      "description": "CVSSv3 attack complexity metric",
                      "order": 1,
                      "title": "Attack Complexity",
                      "type": "string"
                    },
                    "attackVector": {
                      "description": "CVSSv3 attack vector metric",
                      "order": 2,
                      "title": "Attack Vector",
                      "type": "string"
                    },
                    "availabilityImpact": {
                      "description": "CVSSv3 availability impact metric",
                      "order": 3,
                      "title": "Availability Impact",
                      "type": "string"
                    },
                    "confidentialityImpact": {
                      "description": "CVSSv3 confidentiality impact metric",
                      "order": 4,
                      "title": "Confidentiality Impact",
                      "type": "string"
                    },
                    "exploitScore": {
                      "description": "CVSSv3 combined exploit metric score (Attack Complexity/Attack Vector/Privilege Required/Scope/User Interaction)",
                      "order": 5,
                      "title": "Exploit Score",
                      "type": "number"
                    },
                    "impactScore": {
                      "description": "CVSSv3 combined impact metric score (Confidentiality/Integrity/Availability)",
                      "order": 6,
                      "title": "Impact Score",
                      "type": "number"
                    },
                    "integrityImpact": {
                      "description": "CVSSv3 integrity impact metric",
                      "order": 7,
                      "title": "Integrity Impact",
                      "type": "string"
                    },
                    "privilegeRequired": {
                      "description": "CVSSv3 privilege required metric",
                      "order": 8,
                      "title": "Privilege Required",
                      "type": "string"
                    },
                    "scope": {
                      "description": "CVSSv3 scope metric",
                      "order": 9,
                      "title": "Scope",
                      "type": "string"
                    },
                    "score": {
                      "description": "CVSSv3 score",
                      "order": 10,
                      "title": "Score",
                      "type": "number"
                    },
                    "userInteraction": {
                      "description": "CVSSv3 user interaction metric",
                      "order": 11,
                      "title": "User Interaction",
                      "type": "string"
                    },
                    "vector": {
                      "description": "CVSSv3 combined vector string",
                      "order": 12,
                      "title": "Vector",
                      "type": "string"
                    }
                  },
                  "title": "Cvss V3",
                  "type": "object"
                },
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                },
                "pci": {
                  "properties": {
                    "adjustedCVSSScore": {
                      "description": "PCI adjusted CVSS score",
                      "order": 1,
                      "title": "Adjusted CVSS score",
                      "type": "integer"
                    },
                    "adjustedSeverityScore": {
                      "description": "PCI adjusted severity score",
                      "order": 2,
                      "title": "Adjusted severity score",
                      "type": "integer"
                    },
                    "fail": {
                      "description": "Whether this vulnerability results in a PCI assessment failure",
                      "order": 3,
                      "title": "Fail",
                      "type": "boolean"
                    },
                    "specialNotes": {
                      "description": "PCI special notes",
                      "order": 4,
                      "title": "Special Notes",
                      "type": "string"
                    },
                    "status": {
                      "description": "PCI status",
                      "order": 5,
                      "title": "Status",
                      "type": "string"
                    }
                  },
                  "title": "Pci",
                  "type": "object"
                },
                "vulnerability": {
                  "properties": {
                    "added": {
                      "description": "Date that the vulnerability was added to InsightVM",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 1,
                      "title": "Added",
                      "type": "string"
                    },
                    "categories": {
                      "description": "List of vulnerabilities categories with which this vulnerability is affiliated",
                      "items": {
                        "type": "string"
                      },
                      "order": 16,
                      "title": "Categories",
                      "type": "array"
                    },
                    "cves": {
                      "description": "List of CVE identifiers associated with this vulnerability",
                      "items": {
                        "type": "string"
                      },
                      "order": 17,
                      "title": "CVEs",
                      "type": "array"
                    },
                    "cvss": {
                      "$ref": "#/definitions/cvss",
                      "description": "Vulnerability CVSS details",
                      "order": 15,
                      "title": "CVSS"
                    },
                    "denialOfService": {
                      "description": "Whether the vulnerability is a denial of service vulnerability",
                      "order": 7,
                      "title": "Denial of Service",
                      "type": "boolean"
                    },
                    "description": {
                      "$ref": "#/definitions/vulnerability_description",
                      "description": "Vulnerability description",
                      "order": 3,
                      "title": "Description"
                    },
                    "exploits": {
                      "description": "Exploit count",
                      "order": 2,
                      "title": "Exploits",
                      "type": "integer"
                    },
                    "id": {
                      "description": "Vulnerability ID",
                      "order": 9,
                      "title": "ID",
                      "type": "string"
                    },
                    "links": {
                      "description": "List of hypermedia links to corresponding resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 4,
                      "title": "Links",
                      "type": "array"
                    },
                    "malwareKits": {
                      "description": "Malware kit count",
                      "order": 6,
                      "title": "Malware Kits",
                      "type": "integer"
                    },
                    "modified": {
                      "description": "Date the vulnerability was last modified in InsightVM",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 8,
                      "title": "Modified",
                      "type": "string"
                    },
                    "pci": {
                      "$ref": "#/definitions/pci",
                      "description": "Vulnerability PCI details",
                      "order": 11,
                      "title": "PCI"
                    },
                    "published": {
                      "description": "Date the vulnerability was published",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 12,
                      "title": "Published",
                      "type": "string"
                    },
                    "riskScore": {
                      "description": "Vulnerability risk score using the configured risk scoring strategy (RealRisk by default)",
                      "order": 14,
                      "title": "Risk Score",
                      "type": "number"
                    },
                    "severity": {
                      "description": "Vulnerability severity string (Moderate/Severe/Critical)",
                      "order": 13,
                      "title": "Severity",
                      "type": "string"
                    },
                    "severityScore": {
                      "description": "Vulnerability severity score",
                      "order": 10,
                      "title": "Severity Score",
                      "type": "integer"
                    },
                    "title": {
                      "description": "Vulnerability title",
                      "order": 5,
                      "title": "Title",
                      "type": "string"
                    }
                  },
                  "title": "Vulnerability",
                  "type": "object"
                },
                "vulnerability_description": {
                  "properties": {
                    "html": {
                      "description": "Vulnerability description HTML",
                      "order": 1,
                      "title": "HTML",
                      "type": "string"
                    },
                    "text": {
                      "description": "Vulnerability description raw text",
                      "order": 2,
                      "title": "Text",
                      "type": "string"
                    }
                  },
                  "title": "Vulnerability Description",
                  "type": "object"
                }
              },
              "properties": {
                "vulnerability": {
                  "$ref": "#/definitions/vulnerability",
                  "description": "The details of the vulnerability requested",
                  "order": 1,
                  "title": "Vulnerability Details"
                }
              },
              "required": [
                "vulnerability"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "61c2921a-8181-4afa-b5be-3345803c4b57": {
            "nodeId": "61c2921a-8181-4afa-b5be-3345803c4b57",
            "name": "No CVE",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": true,
            "parameters": {
              "input": {
                "content": "{{[5d784560-358a-45f6-af1f-fa2766a11190].[vulnerability].[title]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "69616d3a-9bce-4c17-a2ea-62f100408be1": {
            "nodeId": "69616d3a-9bce-4c17-a2ea-62f100408be1",
            "name": "Asset without Hostname",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{[8e5093ef-4293-42d6-9e9b-4aec2d278c91].[$item]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "6f5ba517-fb17-42a8-8264-135b05ee0bfd": {
            "nodeId": "6f5ba517-fb17-42a8-8264-135b05ee0bfd",
            "name": "Check Asset Hostname ",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "b60d0a95-ca1f-4657-ba5b-58cdfb6b0afe",
              "stepControlParams": [
                {
                  "edgeId": "53ab768b-cf8f-4f09-ac01-c59e5cbd3c39",
                  "expression": {
                    "args": [
                      {
                        "name": "8e5093ef-4293-42d6-9e9b-4aec2d278c91.$item.hostName",
                        "type": "variable"
                      }
                    ],
                    "name": "is_defined",
                    "type": "function"
                  },
                  "expressionText": "is_defined({{[8e5093ef-4293-42d6-9e9b-4aec2d278c91].[$item].[hostName]}})"
                },
                {
                  "edgeId": "b60d0a95-ca1f-4657-ba5b-58cdfb6b0afe",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "877536f9-b731-4215-9d63-397bd5cd5ce7": {
            "nodeId": "877536f9-b731-4215-9d63-397bd5cd5ce7",
            "name": "Search for Hostname Only",
            "type": "action",
            "plugin": {
              "name": "Trend Micro Deep Security",
              "slugVendor": "rapid7",
              "slugName": "trendmicro_deepsecurity",
              "slugVersion": "2.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/trendmicro_deepsecurity/2.2.0/icon.png"
            },
            "identifier": "search_computers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "field_name": "hostName",
                "information": "none",
                "max_items": 2,
                "number_value": 0,
                "search_type": "string",
                "string_value": "{{[ab54df2c-c300-4649-b805-a3845efe7a1d].[result].[0]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "field_name": {
                  "default": "hostName",
                  "description": "Name of the field to be tested",
                  "order": 3,
                  "title": "Search Field",
                  "type": "string"
                },
                "information": {
                  "default": "none",
                  "description": "Determines the computer information to include in the response",
                  "enum": [
                    "none",
                    "all",
                    "computerStatus",
                    "tasks",
                    "securityUpdates",
                    "computerSettings",
                    "allSecurityModules",
                    "antiMalware",
                    "webReputation",
                    "activityMonitoring",
                    "firewall",
                    "intrusionPrevention",
                    "integrityMonitoring",
                    "logInspection",
                    "applicationControl",
                    "SAP",
                    "interfaces",
                    "ESXSummary",
                    "allVirtualMachineSummaries",
                    "azureARMVirtualMachineSummary",
                    "azureVMVirtualMachineSummary",
                    "ec2VirtualMachineSummary",
                    "noConnectorVirtualMachineSummary",
                    "vmwareVMVirtualMachineSummary",
                    "vcloudVMVirtualMachineSummary",
                    "workspaceVirtualMachineSummary",
                    "gcpVirtualMachineSummary"
                  ],
                  "order": 1,
                  "title": "Information",
                  "type": "string"
                },
                "max_items": {
                  "default": 5000,
                  "description": "Limits the number of objects returned",
                  "order": 2,
                  "title": "Maximum Items",
                  "type": "integer"
                },
                "number_value": {
                  "default": "",
                  "description": "Number to search for",
                  "order": 6,
                  "title": "Number Value",
                  "type": "integer"
                },
                "search_type": {
                  "default": "string",
                  "description": "Select the search type",
                  "enum": [
                    "string",
                    "integer"
                  ],
                  "order": 4,
                  "title": "Search Type",
                  "type": "string"
                },
                "string_value": {
                  "default": "",
                  "description": "String to search for",
                  "order": 5,
                  "title": "String Value",
                  "type": "string"
                }
              },
              "required": [
                "information",
                "max_items"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "computer_ids": {
                  "description": "IDs of matching computers",
                  "items": {
                    "type": "integer"
                  },
                  "order": 1,
                  "title": "Computer IDs",
                  "type": "array"
                },
                "response_json": {
                  "description": "Full response in JSON format",
                  "order": 2,
                  "title": "Response JSON",
                  "type": "object"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "89d7ec9f-d138-4fac-addd-d47e103f9677": {
            "nodeId": "89d7ec9f-d138-4fac-addd-d47e103f9677",
            "name": "Search Computer in Deep Security",
            "type": "action",
            "plugin": {
              "name": "Trend Micro Deep Security",
              "slugVendor": "rapid7",
              "slugName": "trendmicro_deepsecurity",
              "slugVersion": "2.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/trendmicro_deepsecurity/2.2.0/icon.png"
            },
            "identifier": "search_computers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "field_name": "hostName",
                "information": "none",
                "max_items": 2,
                "number_value": 0,
                "search_type": "string",
                "string_value": "{{[8e5093ef-4293-42d6-9e9b-4aec2d278c91].[$item].[hostName]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "field_name": {
                  "default": "hostName",
                  "description": "Name of the field to be tested",
                  "order": 3,
                  "title": "Search Field",
                  "type": "string"
                },
                "information": {
                  "default": "none",
                  "description": "Determines the computer information to include in the response",
                  "enum": [
                    "none",
                    "all",
                    "computerStatus",
                    "tasks",
                    "securityUpdates",
                    "computerSettings",
                    "allSecurityModules",
                    "antiMalware",
                    "webReputation",
                    "activityMonitoring",
                    "firewall",
                    "intrusionPrevention",
                    "integrityMonitoring",
                    "logInspection",
                    "applicationControl",
                    "SAP",
                    "interfaces",
                    "ESXSummary",
                    "allVirtualMachineSummaries",
                    "azureARMVirtualMachineSummary",
                    "azureVMVirtualMachineSummary",
                    "ec2VirtualMachineSummary",
                    "noConnectorVirtualMachineSummary",
                    "vmwareVMVirtualMachineSummary",
                    "vcloudVMVirtualMachineSummary",
                    "workspaceVirtualMachineSummary",
                    "gcpVirtualMachineSummary"
                  ],
                  "order": 1,
                  "title": "Information",
                  "type": "string"
                },
                "max_items": {
                  "default": 5000,
                  "description": "Limits the number of objects returned",
                  "order": 2,
                  "title": "Maximum Items",
                  "type": "integer"
                },
                "number_value": {
                  "default": "",
                  "description": "Number to search for",
                  "order": 6,
                  "title": "Number Value",
                  "type": "integer"
                },
                "search_type": {
                  "default": "string",
                  "description": "Select the search type",
                  "enum": [
                    "string",
                    "integer"
                  ],
                  "order": 4,
                  "title": "Search Type",
                  "type": "string"
                },
                "string_value": {
                  "default": "",
                  "description": "String to search for",
                  "order": 5,
                  "title": "String Value",
                  "type": "string"
                }
              },
              "required": [
                "information",
                "max_items"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "computer_ids": {
                  "description": "IDs of matching computers",
                  "items": {
                    "type": "integer"
                  },
                  "order": 1,
                  "title": "Computer IDs",
                  "type": "array"
                },
                "response_json": {
                  "description": "Full response in JSON format",
                  "order": 2,
                  "title": "Response JSON",
                  "type": "object"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "8e5093ef-4293-42d6-9e9b-4aec2d278c91": {
            "nodeId": "8e5093ef-4293-42d6-9e9b-4aec2d278c91",
            "name": "For each Scanned Asset",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "b71be15c-d7ae-454d-947b-002ead28c501",
              "nextEdgeId": "a1fd8b4e-fbf3-4241-8158-b712f91da719",
              "repeatVariable": "{{[a2e467b7-d327-4a87-aed2-50a884128720].[assets]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "95d758d7-5538-415c-965d-09a4bf23ed5e": {
            "nodeId": "95d758d7-5538-415c-965d-09a4bf23ed5e",
            "name": "Check if Rules are Available",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "cc9ce2cc-4721-4132-b354-48a3e8c2c7f9",
              "stepControlParams": [
                {
                  "edgeId": "63f4d6d7-c69f-4c3f-841f-3f895728b464",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "9adcd58c-da41-46ee-ac8d-39f5d48b07c2.ips_rules",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "(length({{[9adcd58c-da41-46ee-ac8d-39f5d48b07c2].[ips_rules]}}) = 0)"
                },
                {
                  "edgeId": "cc9ce2cc-4721-4132-b354-48a3e8c2c7f9",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "9adcd58c-da41-46ee-ac8d-39f5d48b07c2": {
            "nodeId": "9adcd58c-da41-46ee-ac8d-39f5d48b07c2",
            "name": "Search for IPS Rules in Deep Security",
            "type": "action",
            "plugin": {
              "name": "Trend Micro Deep Security",
              "slugVendor": "rapid7",
              "slugName": "trendmicro_deepsecurity",
              "slugVersion": "2.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/trendmicro_deepsecurity/2.2.0/icon.png"
            },
            "identifier": "search_rules",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "vulnerabilities": "{{[5d784560-358a-45f6-af1f-fa2766a11190].[vulnerability].[cves]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "vulnerabilities": {
                  "description": "CVEs to protect against",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Vulnerabilities",
                  "type": "array"
                }
              },
              "required": [
                "vulnerabilities"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "ips_rules": {
                  "description": "IPS rules matching the given CVEs",
                  "items": {
                    "type": "integer"
                  },
                  "order": 1,
                  "title": "IPS Rules",
                  "type": "array"
                },
                "matched_cves": {
                  "description": "CVEs with at least one matching IPS rule",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Matched CVEs",
                  "type": "array"
                },
                "missed_cves": {
                  "description": "CVEs without matching IPS rules",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Missed CVEs",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "a2e467b7-d327-4a87-aed2-50a884128720": {
            "nodeId": "a2e467b7-d327-4a87-aed2-50a884128720",
            "name": "Get Scan Assets",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.0.0/icon.png"
            },
            "identifier": "get_scan_assets",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "scan_id": "{{[cd4cc555-b09e-40e3-9779-6b8087adf770].[scan].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "scan_id": {
                  "description": "ID of the scan to get assets for",
                  "order": 1,
                  "title": "Scan ID",
                  "type": "integer"
                }
              },
              "required": [
                "scan_id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "address": {
                  "properties": {
                    "ip": {
                      "description": "IPv4 or IPv6 address",
                      "order": 1,
                      "title": "IP",
                      "type": "string"
                    },
                    "mac": {
                      "description": "Media Access Control (MAC) address, e.g. AF:12:BC:5A:F7:48",
                      "order": 2,
                      "title": "MAC",
                      "type": "string"
                    }
                  },
                  "title": "Address",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "addresses": {
                      "description": "All addresses discovered on the asset",
                      "items": {
                        "$ref": "#/definitions/address"
                      },
                      "order": 1,
                      "title": "Addresses",
                      "type": "array"
                    },
                    "assessedForPolicies": {
                      "description": "Whether the asset has been assessed for policies at least once",
                      "order": 2,
                      "title": "Assessed for Policies",
                      "type": "boolean"
                    },
                    "assessedForVulnerabilities": {
                      "description": "Whether the asset has been assessed for vulnerabilities at least once",
                      "order": 3,
                      "title": "Assessed for Vulnerabilities",
                      "type": "boolean"
                    },
                    "configurations": {
                      "description": "Configuration key-values pairs enumerated on the asset",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 4,
                      "title": "Configurations",
                      "type": "array"
                    },
                    "databases": {
                      "description": "Databases enumerated on the asset",
                      "items": {
                        "$ref": "#/definitions/database"
                      },
                      "order": 5,
                      "title": "Databases",
                      "type": "array"
                    },
                    "files": {
                      "description": "Files discovered with searching on the asset",
                      "items": {
                        "$ref": "#/definitions/file"
                      },
                      "order": 6,
                      "title": "Files",
                      "type": "array"
                    },
                    "history": {
                      "description": "History of changes to the asset over time",
                      "items": {
                        "$ref": "#/definitions/history"
                      },
                      "order": 7,
                      "title": "History",
                      "type": "array"
                    },
                    "hostName": {
                      "description": "Primary host name (local or FQDN) of the asset",
                      "order": 8,
                      "title": "Hostname",
                      "type": "string"
                    },
                    "hostNames": {
                      "description": "All hostnames or aliases discovered on the asset",
                      "items": {
                        "$ref": "#/definitions/hostName"
                      },
                      "order": 9,
                      "title": "Hostnames",
                      "type": "array"
                    },
                    "id": {
                      "description": "Identifier of the asset",
                      "order": 10,
                      "title": "ID",
                      "type": "integer"
                    },
                    "ids": {
                      "description": "Unique identifiers found on the asset, such as hardware or operating system identifiers",
                      "items": {
                        "$ref": "#/definitions/id"
                      },
                      "order": 11,
                      "title": "IDs",
                      "type": "array"
                    },
                    "ip": {
                      "description": "Primary IPv4 or IPv6 address of the asset",
                      "order": 12,
                      "title": "IP",
                      "type": "string"
                    },
                    "links": {
                      "description": "Hypermedia links to corresponding or related resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 13,
                      "title": "Links",
                      "type": "array"
                    },
                    "mac": {
                      "description": "Media Access Control (MAC) address, e.g. AF:12:BC:5A:F7:48",
                      "order": 14,
                      "title": "MAC",
                      "type": "string"
                    },
                    "os": {
                      "description": "Full description of the operating system of the asset",
                      "order": 15,
                      "title": "OS",
                      "type": "string"
                    },
                    "osFingerprint": {
                      "$ref": "#/definitions/osFingerprint",
                      "description": "Details of the operating system of the asset",
                      "order": 16,
                      "title": "OS Fingerprint"
                    },
                    "rawRiskScore": {
                      "description": "Base risk score of the asset",
                      "order": 17,
                      "title": "Raw Risk Score",
                      "type": "number"
                    },
                    "riskScore": {
                      "description": "Risk score (with criticality adjustments) of the asset",
                      "order": 18,
                      "title": "Risk Score",
                      "type": "number"
                    },
                    "services": {
                      "description": "Services discovered on the asset",
                      "items": {
                        "$ref": "#/definitions/service"
                      },
                      "order": 19,
                      "title": "Services",
                      "type": "array"
                    },
                    "software": {
                      "description": "Software discovered on the asset",
                      "items": {
                        "$ref": "#/definitions/software"
                      },
                      "order": 20,
                      "title": "Software",
                      "type": "array"
                    },
                    "type": {
                      "description": "Type of asset e.g. unknown, guest, hypervisor, physical, mobile",
                      "order": 21,
                      "title": "Type",
                      "type": "string"
                    },
                    "userGroups": {
                      "description": "User group accounts enumerated on the asset",
                      "items": {
                        "$ref": "#/definitions/userGroup"
                      },
                      "order": 22,
                      "title": "User Groups",
                      "type": "array"
                    },
                    "users": {
                      "description": "User accounts enumerated on the asset",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 23,
                      "title": "Users",
                      "type": "array"
                    },
                    "vulnerabilities": {
                      "$ref": "#/definitions/vulnerabilities",
                      "description": " Summary information for vulnerabilities on the asset",
                      "order": 24,
                      "title": "Vulnerabilities"
                    }
                  },
                  "title": "Asset",
                  "type": "object"
                },
                "configuration": {
                  "properties": {
                    "name": {
                      "description": "Name of the configuration value",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "value": {
                      "description": "Configuration value",
                      "order": 2,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Configuration",
                  "type": "object"
                },
                "cpe": {
                  "properties": {
                    "edition": {
                      "description": "Edition-related terms applied by the vendor to the product",
                      "order": 1,
                      "title": "Edition",
                      "type": "string"
                    },
                    "language": {
                      "description": "Defines the language supported in the user interface of the product being described. The format of the language tag adheres to RFC 5646",
                      "order": 2,
                      "title": "Language",
                      "type": "string"
                    },
                    "other": {
                      "description": "Captures any other general descriptive or identifying information which is vendor- or product-specific and which does not logically fit in any other attribute value",
                      "order": 3,
                      "title": "Other",
                      "type": "string"
                    },
                    "part": {
                      "description": "A single letter code that designates the particular platform part that is being identified",
                      "order": 4,
                      "title": "Part",
                      "type": "string"
                    },
                    "product": {
                      "description": "Most common and recognizable title or name of the product",
                      "order": 5,
                      "title": "Product",
                      "type": "string"
                    },
                    "swEdition": {
                      "description": "Characterizes how the product is tailored to a particular market or class of end users",
                      "order": 6,
                      "title": "Software Edition",
                      "type": "string"
                    },
                    "targetHW": {
                      "description": "Characterize the instruction set architecture on which the product operates",
                      "order": 7,
                      "title": "Target Hardware",
                      "type": "string"
                    },
                    "targetSW": {
                      "description": "Characterizes the software computing environment within which the product operates",
                      "order": 8,
                      "title": "Target Software",
                      "type": "string"
                    },
                    "update": {
                      "description": "Vendor-specific alphanumeric strings characterizing the particular update, service pack, or point release of the product",
                      "order": 9,
                      "title": "Update",
                      "type": "string"
                    },
                    "v2.2": {
                      "description": "The full CPE string in the CPE 2.2 format",
                      "order": 10,
                      "title": "Version 2.2",
                      "type": "string"
                    },
                    "v2.3": {
                      "description": "The full CPE string in the CPE 2.3 format",
                      "order": 11,
                      "title": "Version 2.3",
                      "type": "string"
                    },
                    "vendor": {
                      "description": "The person or organization that manufactured or created the product",
                      "order": 12,
                      "title": "Vendor",
                      "type": "string"
                    },
                    "version": {
                      "description": "Vendor-specific alphanumeric strings characterizing the particular release version of the product",
                      "order": 13,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "Cpe",
                  "type": "object"
                },
                "database": {
                  "properties": {
                    "description": {
                      "description": "Description of the database instance",
                      "order": 1,
                      "title": "Description",
                      "type": "string"
                    },
                    "id": {
                      "description": "Identifier of the database",
                      "order": 2,
                      "title": "ID",
                      "type": "integer"
                    },
                    "name": {
                      "description": "Name of the database instance",
                      "order": 3,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "title": "Database",
                  "type": "object"
                },
                "file": {
                  "properties": {
                    "attributes": {
                      "description": "Attributes detected on the file",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 1,
                      "title": "Attributes",
                      "type": "array"
                    },
                    "content": {
                      "description": "Contents of the file",
                      "displayType": "bytes",
                      "format": "bytes",
                      "order": 5,
                      "title": "Contents",
                      "type": "string"
                    },
                    "name": {
                      "description": "Name of the file",
                      "order": 2,
                      "title": "Name",
                      "type": "string"
                    },
                    "size": {
                      "description": "Size of the regular file (in bytes). If the file is a directory, no value is returned",
                      "order": 3,
                      "title": "Size",
                      "type": "integer"
                    },
                    "type": {
                      "description": "Type of the file, e.g. file or directory",
                      "order": 4,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                },
                "history": {
                  "properties": {
                    "date": {
                      "description": "Date the asset information was collected or changed",
                      "order": 1,
                      "title": "Date",
                      "type": "string"
                    },
                    "description": {
                      "description": "Additional information describing the change",
                      "order": 2,
                      "title": "Description",
                      "type": "string"
                    },
                    "scanId": {
                      "description": "If a scan-oriented change, the identifier of the corresponding scan the asset was scanned in",
                      "order": 3,
                      "title": "Scan ID",
                      "type": "integer"
                    },
                    "type": {
                      "description": "Type, for additional information see the help section of this plugin",
                      "order": 4,
                      "title": "Type",
                      "type": "string"
                    },
                    "user": {
                      "description": "User",
                      "order": 5,
                      "title": "User",
                      "type": "string"
                    },
                    "version": {
                      "description": "Version",
                      "order": 6,
                      "title": "Version",
                      "type": "integer"
                    },
                    "vulnerabilityExceptionId": {
                      "description": "Vulnerability exception ID",
                      "order": 7,
                      "title": "Vulnerability Exception ID",
                      "type": "integer"
                    }
                  },
                  "title": "History",
                  "type": "object"
                },
                "hostName": {
                  "properties": {
                    "name": {
                      "description": "Name",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "source": {
                      "description": "Source",
                      "order": 2,
                      "title": "Source",
                      "type": "string"
                    }
                  },
                  "title": "HostName",
                  "type": "object"
                },
                "id": {
                  "properties": {
                    "id": {
                      "description": "ID",
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "source": {
                      "description": "Source",
                      "order": 2,
                      "title": "Source",
                      "type": "string"
                    }
                  },
                  "title": "Id",
                  "type": "object"
                },
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                },
                "osFingerprint": {
                  "properties": {
                    "architecture": {
                      "description": "The architecture of the operating system",
                      "order": 1,
                      "title": "Architecture",
                      "type": "string"
                    },
                    "configurations": {
                      "description": "Configuration key-values pairs enumerated on the operating system",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 2,
                      "title": "Configuration",
                      "type": "array"
                    },
                    "cpe": {
                      "$ref": "#/definitions/cpe",
                      "description": "Common Platform Enumeration",
                      "order": 3,
                      "title": "CPE"
                    },
                    "description": {
                      "description": "The description of the operating system (containing vendor, family, product, version and architecture in a single string)",
                      "order": 4,
                      "title": "Description",
                      "type": "string"
                    },
                    "family": {
                      "description": "Family of the operating system",
                      "order": 5,
                      "title": "Family",
                      "type": "string"
                    },
                    "id": {
                      "description": "Identifier of the operating system",
                      "order": 6,
                      "title": "ID",
                      "type": "integer"
                    },
                    "product": {
                      "description": "Name of the operating system",
                      "order": 7,
                      "title": "Product",
                      "type": "string"
                    },
                    "systemName": {
                      "description": "A combination of vendor and family (with redundancies removed), suitable for grouping",
                      "order": 8,
                      "title": "System Name",
                      "type": "string"
                    },
                    "type": {
                      "description": "Type of operating system",
                      "order": 9,
                      "title": "Type",
                      "type": "string"
                    },
                    "vendor": {
                      "description": "Vendor of the operating system",
                      "order": 10,
                      "title": "Vendor",
                      "type": "string"
                    },
                    "version": {
                      "description": "Version of the operating system",
                      "order": 11,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "OsFingerprint",
                  "type": "object"
                },
                "page": {
                  "properties": {
                    "linkType": {
                      "description": "Type of link used to traverse or detect the page",
                      "order": 1,
                      "title": "Link Type",
                      "type": "string"
                    },
                    "path": {
                      "description": "Path to the page (URI)",
                      "order": 2,
                      "title": "Path",
                      "type": "string"
                    },
                    "response": {
                      "description": "HTTP response code observed with retrieving the page",
                      "order": 3,
                      "title": "Response",
                      "type": "integer"
                    }
                  },
                  "title": "Page",
                  "type": "object"
                },
                "service": {
                  "properties": {
                    "configurations": {
                      "description": "Configuration key-values pairs enumerated on the service",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 1,
                      "title": "Configurations",
                      "type": "array"
                    },
                    "databases": {
                      "description": "Databases enumerated on the service",
                      "items": {
                        "$ref": "#/definitions/database"
                      },
                      "order": 2,
                      "title": "Databases",
                      "type": "array"
                    },
                    "family": {
                      "description": "Family of the service",
                      "order": 3,
                      "title": "Family",
                      "type": "string"
                    },
                    "links": {
                      "description": "Hypermedia links to corresponding or related resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 4,
                      "title": "Links",
                      "type": "array"
                    },
                    "name": {
                      "description": "Name of the service",
                      "order": 5,
                      "title": "Name",
                      "type": "string"
                    },
                    "port": {
                      "description": "Port of the service",
                      "order": 6,
                      "title": "Port",
                      "type": "integer"
                    },
                    "product": {
                      "description": "Product running the service",
                      "order": 7,
                      "title": "Product",
                      "type": "string"
                    },
                    "protocol": {
                      "description": "Protocol of the service",
                      "order": 8,
                      "title": "Protocol",
                      "type": "string"
                    },
                    "userGroups": {
                      "description": "User groups",
                      "items": {
                        "$ref": "#/definitions/userGroup"
                      },
                      "order": 9,
                      "title": "User Groups",
                      "type": "array"
                    },
                    "users": {
                      "description": "Users",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 10,
                      "title": "Users",
                      "type": "array"
                    },
                    "vendor": {
                      "description": "Vendor of the service",
                      "order": 11,
                      "title": "Vendor",
                      "type": "string"
                    },
                    "version": {
                      "description": "Version of the service",
                      "order": 12,
                      "title": "Version",
                      "type": "string"
                    },
                    "webApplications": {
                      "description": "Web applications found on the service",
                      "items": {
                        "$ref": "#/definitions/webApplication"
                      },
                      "order": 13,
                      "title": "Web Applications",
                      "type": "array"
                    }
                  },
                  "title": "Service",
                  "type": "object"
                },
                "software": {
                  "properties": {
                    "configurations": {
                      "description": "Configurations",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 1,
                      "title": "Configurations",
                      "type": "array"
                    },
                    "cpe": {
                      "$ref": "#/definitions/cpe",
                      "description": "CPE",
                      "order": 2,
                      "title": "CPE"
                    },
                    "description": {
                      "description": "Description of the software",
                      "order": 3,
                      "title": "Description",
                      "type": "string"
                    },
                    "family": {
                      "description": "Family of the software",
                      "order": 4,
                      "title": "Family",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 5,
                      "title": "ID",
                      "type": "integer"
                    },
                    "product": {
                      "description": "Product of the software",
                      "order": 6,
                      "title": "Product",
                      "type": "string"
                    },
                    "type": {
                      "description": "Type of the software",
                      "order": 7,
                      "title": "Type",
                      "type": "string"
                    },
                    "vendor": {
                      "description": "Vendor of the software",
                      "order": 8,
                      "title": "Vendor",
                      "type": "string"
                    },
                    "version": {
                      "description": "Version of the software",
                      "order": 9,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "Software",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "fullName": {
                      "description": "Full name of the user account",
                      "order": 1,
                      "title": "Full Name",
                      "type": "string"
                    },
                    "id": {
                      "description": "Identifier of the user account",
                      "order": 2,
                      "title": "ID",
                      "type": "integer"
                    },
                    "name": {
                      "description": "Name of the user account",
                      "order": 3,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                },
                "userGroup": {
                  "properties": {
                    "id": {
                      "description": "Identifier of the user group",
                      "order": 1,
                      "title": "ID",
                      "type": "integer"
                    },
                    "name": {
                      "description": "Name of the user group",
                      "order": 2,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "title": "UserGroup",
                  "type": "object"
                },
                "vulnerabilities": {
                  "properties": {
                    "critical": {
                      "description": "Number of critical vulnerabilities",
                      "order": 1,
                      "title": "Critical",
                      "type": "integer"
                    },
                    "exploits": {
                      "description": "Number of distinct exploits that can exploit any of the vulnerabilities on the asset",
                      "order": 2,
                      "title": "Exploits",
                      "type": "integer"
                    },
                    "malwareKits": {
                      "description": "Number of distinct malware kits that vulnerabilities on the asset are susceptible to",
                      "order": 3,
                      "title": "Malware Kits",
                      "type": "integer"
                    },
                    "moderate": {
                      "description": "Number of moderate vulnerabilities",
                      "order": 4,
                      "title": "Moderate",
                      "type": "integer"
                    },
                    "severe": {
                      "description": "Number of severe vulnerabilities",
                      "order": 5,
                      "title": "Severe",
                      "type": "integer"
                    },
                    "total": {
                      "description": "Total number of vulnerabilities",
                      "order": 6,
                      "title": "Total",
                      "type": "integer"
                    }
                  },
                  "title": "Vulnerabilities",
                  "type": "object"
                },
                "webApplication": {
                  "properties": {
                    "id": {
                      "description": "Identifier of the web application",
                      "order": 1,
                      "title": "ID",
                      "type": "integer"
                    },
                    "pages": {
                      "description": "Pages",
                      "items": {
                        "$ref": "#/definitions/page"
                      },
                      "order": 2,
                      "title": "Pages",
                      "type": "array"
                    },
                    "root": {
                      "description": "Web root of the web application",
                      "order": 3,
                      "title": "Root",
                      "type": "string"
                    },
                    "virtualHost": {
                      "description": "Virtual host of the web application",
                      "order": 4,
                      "title": "Virtual Host",
                      "type": "string"
                    }
                  },
                  "title": "WebApplication",
                  "type": "object"
                }
              },
              "properties": {
                "assets": {
                  "description": "Assets",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 1,
                  "title": "Assets",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "ab54df2c-c300-4649-b805-a3845efe7a1d": {
            "nodeId": "ab54df2c-c300-4649-b805-a3845efe7a1d",
            "name": "Extract Hostname from FQDN",
            "type": "action",
            "plugin": {
              "name": "Advanced Regex",
              "slugVendor": "rapid7",
              "slugName": "advanced_regex",
              "slugVersion": "1.0.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/advanced_regex/1.0.3/icon.png"
            },
            "identifier": "split",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "ascii": false,
                "dotall": false,
                "ignorecase": true,
                "in_regex": "\\.",
                "in_string": "{{[8e5093ef-4293-42d6-9e9b-4aec2d278c91].[$item].[hostName]}}",
                "max_split": 1,
                "multiline": false
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "ascii": {
                  "default": false,
                  "description": "Make \\w \\W \\b \\B follow ASCII rules",
                  "order": 7,
                  "title": "ASCII",
                  "type": "boolean"
                },
                "dotall": {
                  "default": false,
                  "description": "Make . match newline",
                  "order": 6,
                  "title": "Dot All",
                  "type": "boolean"
                },
                "ignorecase": {
                  "default": false,
                  "description": "Make regex non-case sensitive",
                  "order": 4,
                  "title": "Ignore Case",
                  "type": "boolean"
                },
                "in_regex": {
                  "description": "Regex to split string on matches",
                  "order": 2,
                  "title": "Regex",
                  "type": "string"
                },
                "in_string": {
                  "description": "Input string",
                  "order": 1,
                  "title": "Input String",
                  "type": "string"
                },
                "max_split": {
                  "default": 0,
                  "description": "Max splits - if non-zero last element is remainder of string",
                  "order": 3,
                  "title": "Max Split",
                  "type": "integer"
                },
                "multiline": {
                  "default": false,
                  "description": "Make begin/end consider each line",
                  "order": 5,
                  "title": "Multiline",
                  "type": "boolean"
                }
              },
              "required": [
                "in_string",
                "in_regex"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result": {
                  "description": "An array of the strings returned by the split operation",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Result Strings",
                  "type": "array"
                }
              },
              "required": [
                "result"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "bca0a9f7-e00c-4865-a3e4-83b5f29ba831": {
            "nodeId": "bca0a9f7-e00c-4865-a3e4-83b5f29ba831",
            "name": "For each Vulnerability",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "5c42a41c-bc3b-4eed-8727-0de65cb6c49b",
              "nextEdgeId": "c95fbfa1-7073-4119-b5d3-e88134299b1c",
              "repeatVariable": "{{[52baf553-33c9-4ac0-89e5-896a0931dcdc].[vulnerabilities]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "cc076920-1457-421f-b290-6c0c415e31cc": {
            "nodeId": "cc076920-1457-421f-b290-6c0c415e31cc",
            "name": "Scan Summary",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Name: {{[cd4cc555-b09e-40e3-9779-6b8087adf770].[scan].[scanName]}}\nSite: {{[cd4cc555-b09e-40e3-9779-6b8087adf770].[scan].[siteName]}}\nID: {{[cd4cc555-b09e-40e3-9779-6b8087adf770].[scan].[id]}}\nAssets: {{[cd4cc555-b09e-40e3-9779-6b8087adf770].[scan].[assets]}}\nVulnerabilities: {{[cd4cc555-b09e-40e3-9779-6b8087adf770].[scan].[vulnerabilities].[total]}}\n\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "cd4cc555-b09e-40e3-9779-6b8087adf770": {
            "nodeId": "cd4cc555-b09e-40e3-9779-6b8087adf770",
            "name": "Check for Finished Scans",
            "description": "Check every minute if there are finished scans in InsightVM",
            "type": "trigger",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.0.0/icon.png"
            },
            "identifier": "new_scans",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "frequency": 1,
                "most_recent_scan": true,
                "site_name_filter": ".*",
                "status_filter": [
                  "Successful"
                ]
              }
            },
            "triggerId": "87494e6f-fac7-4785-9399-fe2a2b3668a5",
            "defaultInputJSONSchema": {
              "properties": {
                "frequency": {
                  "default": 5,
                  "description": "How often the trigger should check for new scans in minutes",
                  "order": 1,
                  "title": "Frequency",
                  "type": "integer"
                },
                "most_recent_scan": {
                  "default": true,
                  "description": "Only process the most recent scan for a site since the last time the trigger was run",
                  "order": 3,
                  "title": "Most Recent Scan Only",
                  "type": "boolean"
                },
                "site_name_filter": {
                  "default": ".*",
                  "description": "Regular expression to match sites where new scans should be triggered",
                  "order": 2,
                  "title": "Site Name Filter",
                  "type": "string"
                },
                "status_filter": {
                  "default": [
                    "Successful"
                  ],
                  "description": "List of scan statuses to match for trigger; options include: Aborted, Successful, Running, Stopped, Failed, Paused, Unknown",
                  "items": {
                    "type": "string"
                  },
                  "order": 4,
                  "title": "Status Filter",
                  "type": "array"
                }
              },
              "required": [
                "site_name_filter",
                "most_recent_scan",
                "frequency"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                },
                "scan": {
                  "properties": {
                    "assets": {
                      "description": "Count of assets identified during the scan",
                      "order": 3,
                      "title": "Assets",
                      "type": "integer"
                    },
                    "duration": {
                      "description": "Duration of the scan",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 11,
                      "title": "Duration",
                      "type": "string"
                    },
                    "endTime": {
                      "description": "End time of the scan",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 14,
                      "title": "End Time",
                      "type": "string"
                    },
                    "engineId": {
                      "description": "ID for the scan engine/scan engine pool used for the scan",
                      "order": 8,
                      "title": "Engine ID",
                      "type": "integer"
                    },
                    "engineName": {
                      "description": "Name of the scan engine/scan engine pool used for the scan",
                      "order": 12,
                      "title": "Engine Name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID of the scan",
                      "order": 15,
                      "title": "ID",
                      "type": "integer"
                    },
                    "links": {
                      "description": "List of hypermedia links to corresponding resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 4,
                      "title": "Links",
                      "type": "array"
                    },
                    "message": {
                      "description": "Scan status message",
                      "order": 13,
                      "title": "Message",
                      "type": "string"
                    },
                    "scanName": {
                      "description": "Name of the scan",
                      "order": 16,
                      "title": "Scan Name",
                      "type": "string"
                    },
                    "scanType": {
                      "description": "Type of scan (automated, manual, scheduled)",
                      "order": 2,
                      "title": "Scan Type",
                      "type": "string"
                    },
                    "siteId": {
                      "description": "ID of the site scanned",
                      "order": 9,
                      "title": "Site ID",
                      "type": "integer"
                    },
                    "siteName": {
                      "description": "Name of the site scanned",
                      "order": 5,
                      "title": "Site Name",
                      "type": "string"
                    },
                    "startTime": {
                      "description": "Start time for the scan",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 10,
                      "title": "Start Time",
                      "type": "string"
                    },
                    "startedBy": {
                      "description": "User that started the scan",
                      "order": 7,
                      "title": "Started By",
                      "type": "string"
                    },
                    "status": {
                      "description": "Scan status (aborted, unknown, running, finished, stopped, error, paused, dispatched, integrating)",
                      "order": 1,
                      "title": "Status",
                      "type": "string"
                    },
                    "vulnerabilities": {
                      "$ref": "#/definitions/vulnerabilities_count",
                      "description": "Counts of vulnerabilities identified during the scan",
                      "order": 6,
                      "title": "Vulnerabilities"
                    }
                  },
                  "title": "Scan",
                  "type": "object"
                },
                "vulnerabilities_count": {
                  "properties": {
                    "critical": {
                      "description": "Number of critical vulnerabilities",
                      "order": 1,
                      "title": "Critical",
                      "type": "integer"
                    },
                    "moderate": {
                      "description": "Number of moderate vulnerabilities",
                      "order": 2,
                      "title": "Moderate",
                      "type": "integer"
                    },
                    "severe": {
                      "description": "Number of severe vulnerabilities",
                      "order": 3,
                      "title": "Severe",
                      "type": "integer"
                    },
                    "total": {
                      "description": "Total",
                      "order": 4,
                      "title": "Total number of vulnerabilities",
                      "type": "integer"
                    }
                  },
                  "title": "Vulnerabilities Count",
                  "type": "object"
                }
              },
              "properties": {
                "scan": {
                  "$ref": "#/definitions/scan",
                  "description": "InsightVM Scan",
                  "order": 1,
                  "title": "Scan"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION"
          },
          "d27966bd-d54e-4d37-9065-66198970436c": {
            "nodeId": "d27966bd-d54e-4d37-9065-66198970436c",
            "name": "Assign Rules and Set Exceptions in InsightVM",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "expression": null,
                    "value": "{{[33e146b6-7a9e-4821-94e7-4f5e26cc4a5f].[content]}}",
                    "valueType": "string"
                  },
                  "name": "Rule deployed",
                  "outputType": "array"
                }
              ],
              "innerEdgeId": "5bd425aa-4600-4dcf-9ea4-44b02d1c517b",
              "nextEdgeId": "109473d0-8528-4144-8f82-6f39dc15dfa6",
              "repeatVariable": "{{[40100b9c-79da-4894-a3ab-809fcd6f0f7e].[DS asset ID]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "Rule deployed": {
                  "description": "Custom output: \"Rule deployed\"",
                  "items": {
                    "type": "string"
                  },
                  "title": "Rule deployed",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          }
        },
        "tags": null,
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": ""
      }
    ],
    "triggers": [
      {
        "id": "87494e6f-fac7-4785-9399-fe2a2b3668a5",
        "identifier": "new_scans",
        "name": "Check for Finished Scans",
        "description": "Check every minute if there are finished scans in InsightVM",
        "input": {
          "frequency": 1,
          "most_recent_scan": true,
          "site_name_filter": ".*",
          "status_filter": [
            "Successful"
          ]
        },
        "inputJsonSchema": {
          "properties": {
            "frequency": {
              "default": 5,
              "description": "How often the trigger should check for new scans in minutes",
              "order": 1,
              "title": "Frequency",
              "type": "integer"
            },
            "most_recent_scan": {
              "default": true,
              "description": "Only process the most recent scan for a site since the last time the trigger was run",
              "order": 3,
              "title": "Most Recent Scan Only",
              "type": "boolean"
            },
            "site_name_filter": {
              "default": ".*",
              "description": "Regular expression to match sites where new scans should be triggered",
              "order": 2,
              "title": "Site Name Filter",
              "type": "string"
            },
            "status_filter": {
              "default": [
                "Successful"
              ],
              "description": "List of scan statuses to match for trigger; options include: Aborted, Successful, Running, Stopped, Failed, Paused, Unknown",
              "items": {
                "type": "string"
              },
              "order": 4,
              "title": "Status Filter",
              "type": "array"
            }
          },
          "required": [
            "site_name_filter",
            "most_recent_scan",
            "frequency"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "link": {
              "properties": {
                "href": {
                  "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                  "order": 1,
                  "title": "URL",
                  "type": "string"
                },
                "rel": {
                  "description": "Link relation type following RFC 5988",
                  "order": 2,
                  "title": "Rel",
                  "type": "string"
                }
              },
              "title": "Link",
              "type": "object"
            },
            "scan": {
              "properties": {
                "assets": {
                  "description": "Count of assets identified during the scan",
                  "order": 3,
                  "title": "Assets",
                  "type": "integer"
                },
                "duration": {
                  "description": "Duration of the scan",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 11,
                  "title": "Duration",
                  "type": "string"
                },
                "endTime": {
                  "description": "End time of the scan",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 14,
                  "title": "End Time",
                  "type": "string"
                },
                "engineId": {
                  "description": "ID for the scan engine/scan engine pool used for the scan",
                  "order": 8,
                  "title": "Engine ID",
                  "type": "integer"
                },
                "engineName": {
                  "description": "Name of the scan engine/scan engine pool used for the scan",
                  "order": 12,
                  "title": "Engine Name",
                  "type": "string"
                },
                "id": {
                  "description": "ID of the scan",
                  "order": 15,
                  "title": "ID",
                  "type": "integer"
                },
                "links": {
                  "description": "List of hypermedia links to corresponding resources",
                  "items": {
                    "$ref": "#/definitions/link"
                  },
                  "order": 4,
                  "title": "Links",
                  "type": "array"
                },
                "message": {
                  "description": "Scan status message",
                  "order": 13,
                  "title": "Message",
                  "type": "string"
                },
                "scanName": {
                  "description": "Name of the scan",
                  "order": 16,
                  "title": "Scan Name",
                  "type": "string"
                },
                "scanType": {
                  "description": "Type of scan (automated, manual, scheduled)",
                  "order": 2,
                  "title": "Scan Type",
                  "type": "string"
                },
                "siteId": {
                  "description": "ID of the site scanned",
                  "order": 9,
                  "title": "Site ID",
                  "type": "integer"
                },
                "siteName": {
                  "description": "Name of the site scanned",
                  "order": 5,
                  "title": "Site Name",
                  "type": "string"
                },
                "startTime": {
                  "description": "Start time for the scan",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 10,
                  "title": "Start Time",
                  "type": "string"
                },
                "startedBy": {
                  "description": "User that started the scan",
                  "order": 7,
                  "title": "Started By",
                  "type": "string"
                },
                "status": {
                  "description": "Scan status (aborted, unknown, running, finished, stopped, error, paused, dispatched, integrating)",
                  "order": 1,
                  "title": "Status",
                  "type": "string"
                },
                "vulnerabilities": {
                  "$ref": "#/definitions/vulnerabilities_count",
                  "description": "Counts of vulnerabilities identified during the scan",
                  "order": 6,
                  "title": "Vulnerabilities"
                }
              },
              "title": "Scan",
              "type": "object"
            },
            "vulnerabilities_count": {
              "properties": {
                "critical": {
                  "description": "Number of critical vulnerabilities",
                  "order": 1,
                  "title": "Critical",
                  "type": "integer"
                },
                "moderate": {
                  "description": "Number of moderate vulnerabilities",
                  "order": 2,
                  "title": "Moderate",
                  "type": "integer"
                },
                "severe": {
                  "description": "Number of severe vulnerabilities",
                  "order": 3,
                  "title": "Severe",
                  "type": "integer"
                },
                "total": {
                  "description": "Total",
                  "order": 4,
                  "title": "Total number of vulnerabilities",
                  "type": "integer"
                }
              },
              "title": "Vulnerabilities Count",
              "type": "object"
            }
          },
          "properties": {
            "scan": {
              "$ref": "#/definitions/scan",
              "description": "InsightVM Scan",
              "order": 1,
              "title": "Scan"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_plugin",
        "plugin": {
          "name": "Rapid7 InsightVM",
          "slugVendor": "rapid7",
          "slugName": "rapid7_insightvm",
          "slugVersion": "4.0.0",
          "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.0.0/icon.png"
        }
      }
    ]
  }
}