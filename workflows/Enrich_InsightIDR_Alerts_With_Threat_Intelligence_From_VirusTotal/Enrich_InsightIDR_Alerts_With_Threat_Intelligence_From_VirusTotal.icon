{
  "kom": {
    "komandVersion": "1.60.2-0-g80196",
    "komFileVersion": "2.0.0",
    "exportedAt": "2020-08-31T23:38:27.510036662Z",
    "workflowVersions": [
      {
        "name": "Enrich InsightIDR Alerts with Threat Intelligence from VirusTotal",
        "type": "runnable",
        "version": "",
        "description": "This workflow parses indicators (IP addresses, URLs, domains, and/or hashes) from an InsightIDR alert and adds threat intelligence from VirusTotal. This workflow requires a VirusTotal API key, which can be generated for free by creating an account on VirusTotal's website (https://virustotal.com)",
        "graph": {
          "edges": {
            "030e4053-950d-4e45-a8fe-5b7c3bff5404": {
              "id": "030e4053-950d-4e45-a8fe-5b7c3bff5404",
              "name": "",
              "description": "",
              "parentNodeId": "39db1de6-6f97-45df-80c9-e27e05cbfbd6",
              "fromNodeId": "39db1de6-6f97-45df-80c9-e27e05cbfbd6",
              "toNodeId": "3779a4ff-1a17-4ae2-8d4c-80e3a95ad7d0"
            },
            "05495807-0c17-41f1-be6d-6b978f30700b": {
              "id": "05495807-0c17-41f1-be6d-6b978f30700b",
              "name": "",
              "description": "",
              "parentNodeId": "a9583cae-3265-458e-9dca-04e551c6646e",
              "fromNodeId": "1dca489b-fb00-4aa2-aca9-996d51e656e7",
              "toNodeId": ""
            },
            "1ae7447a-757f-4f4d-8c81-cfb28e2b81cc": {
              "id": "1ae7447a-757f-4f4d-8c81-cfb28e2b81cc",
              "name": "No Indicator Present",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "cf276e84-d2d1-4bc2-b490-d455202cd77e",
              "toNodeId": "958a3303-e1a1-4414-ad6e-98d01a6a694d"
            },
            "2fcc1c0f-3648-4f40-8502-3e7da42b19f4": {
              "id": "2fcc1c0f-3648-4f40-8502-3e7da42b19f4",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "ba8bae4b-ae24-47c9-b635-3ebb9b6a934a",
              "toNodeId": "cf276e84-d2d1-4bc2-b490-d455202cd77e"
            },
            "32146a4b-3f16-4613-879a-6c298a980553": {
              "id": "32146a4b-3f16-4613-879a-6c298a980553",
              "name": "",
              "description": "",
              "parentNodeId": "012f25e4-d69c-47ed-9041-3f00f9008177",
              "fromNodeId": "c329f098-3fbd-495e-9652-16a2d72efcbd",
              "toNodeId": "0cd18853-cc3d-46a5-80cf-fd5d4ba85f02"
            },
            "3233ee24-cf62-419b-b238-f1afd7046b0f": {
              "id": "3233ee24-cf62-419b-b238-f1afd7046b0f",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "012f25e4-d69c-47ed-9041-3f00f9008177",
              "toNodeId": "3d2b3a90-26d9-4aca-9e4c-401499ca62bc"
            },
            "37b238bc-29f5-442a-9cab-4a49bfc6445c": {
              "id": "37b238bc-29f5-442a-9cab-4a49bfc6445c",
              "name": "",
              "description": "",
              "parentNodeId": "476a46e4-4928-46e0-8ee3-0aeb20e2bf1a",
              "fromNodeId": "c82f587a-72fa-4f5a-81a2-edd15173ca7b",
              "toNodeId": "f70411be-06b4-4c73-b16d-7b045486c7cb"
            },
            "4633d77a-19d6-4df5-85ff-086ad74aae9b": {
              "id": "4633d77a-19d6-4df5-85ff-086ad74aae9b",
              "name": "",
              "description": "",
              "parentNodeId": "476a46e4-4928-46e0-8ee3-0aeb20e2bf1a",
              "fromNodeId": "476a46e4-4928-46e0-8ee3-0aeb20e2bf1a",
              "toNodeId": "c82f587a-72fa-4f5a-81a2-edd15173ca7b"
            },
            "5066dc7e-39e4-4358-a065-27eba40e4da2": {
              "id": "5066dc7e-39e4-4358-a065-27eba40e4da2",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "df6d7d6e-ac6f-4941-b7db-9cbdaba3125c",
              "toNodeId": "3d2b3a90-26d9-4aca-9e4c-401499ca62bc"
            },
            "585a3873-7da5-4b04-ac73-0e05d4fffab4": {
              "id": "585a3873-7da5-4b04-ac73-0e05d4fffab4",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "39db1de6-6f97-45df-80c9-e27e05cbfbd6",
              "toNodeId": "3d2b3a90-26d9-4aca-9e4c-401499ca62bc"
            },
            "5afdb63a-3c1b-4282-9380-1fdf4907dbe3": {
              "id": "5afdb63a-3c1b-4282-9380-1fdf4907dbe3",
              "name": "",
              "description": "",
              "parentNodeId": "012f25e4-d69c-47ed-9041-3f00f9008177",
              "fromNodeId": "0cd18853-cc3d-46a5-80cf-fd5d4ba85f02",
              "toNodeId": ""
            },
            "5babcb34-486f-46ae-857b-208a77d3f7cc": {
              "id": "5babcb34-486f-46ae-857b-208a77d3f7cc",
              "name": "IP",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "cf276e84-d2d1-4bc2-b490-d455202cd77e",
              "toNodeId": "476a46e4-4928-46e0-8ee3-0aeb20e2bf1a"
            },
            "6ea50a59-a57b-46c0-871d-eeb3361e0182": {
              "id": "6ea50a59-a57b-46c0-871d-eeb3361e0182",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "958a3303-e1a1-4414-ad6e-98d01a6a694d",
              "toNodeId": ""
            },
            "79c2f7ae-a215-472a-b4e4-ae74f1d9e35d": {
              "id": "79c2f7ae-a215-472a-b4e4-ae74f1d9e35d",
              "name": "",
              "description": "",
              "parentNodeId": "df6d7d6e-ac6f-4941-b7db-9cbdaba3125c",
              "fromNodeId": "9886268a-51fd-46aa-bda0-14236e23de5e",
              "toNodeId": ""
            },
            "80fc5707-3ac3-4f69-bd6c-28ce1a990333": {
              "id": "80fc5707-3ac3-4f69-bd6c-28ce1a990333",
              "name": "Hash",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "cf276e84-d2d1-4bc2-b490-d455202cd77e",
              "toNodeId": "39db1de6-6f97-45df-80c9-e27e05cbfbd6"
            },
            "8423c541-da72-452c-982b-c96b1ec860d2": {
              "id": "8423c541-da72-452c-982b-c96b1ec860d2",
              "name": "URL",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "cf276e84-d2d1-4bc2-b490-d455202cd77e",
              "toNodeId": "df6d7d6e-ac6f-4941-b7db-9cbdaba3125c"
            },
            "941ad2fb-eefe-466e-a313-1d745be26f5c": {
              "id": "941ad2fb-eefe-466e-a313-1d745be26f5c",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "3d2b3a90-26d9-4aca-9e4c-401499ca62bc",
              "toNodeId": ""
            },
            "991ad82c-d55e-4303-a697-f6ed47d701ea": {
              "id": "991ad82c-d55e-4303-a697-f6ed47d701ea",
              "name": "",
              "description": "",
              "parentNodeId": "df6d7d6e-ac6f-4941-b7db-9cbdaba3125c",
              "fromNodeId": "df6d7d6e-ac6f-4941-b7db-9cbdaba3125c",
              "toNodeId": "71e2da52-8f0c-4366-8ed4-6f13a23bb533"
            },
            "a1e86ef7-abe2-4006-8e88-95576fb3befe": {
              "id": "a1e86ef7-abe2-4006-8e88-95576fb3befe",
              "name": "",
              "description": "",
              "parentNodeId": "39db1de6-6f97-45df-80c9-e27e05cbfbd6",
              "fromNodeId": "3779a4ff-1a17-4ae2-8d4c-80e3a95ad7d0",
              "toNodeId": "a9583cae-3265-458e-9dca-04e551c6646e"
            },
            "b9e3c829-7459-41eb-8dd8-cd4678e37017": {
              "id": "b9e3c829-7459-41eb-8dd8-cd4678e37017",
              "name": "",
              "description": "",
              "parentNodeId": "476a46e4-4928-46e0-8ee3-0aeb20e2bf1a",
              "fromNodeId": "f70411be-06b4-4c73-b16d-7b045486c7cb",
              "toNodeId": ""
            },
            "c28c0a2a-210e-41e7-b6d0-09ea5e0d4a7b": {
              "id": "c28c0a2a-210e-41e7-b6d0-09ea5e0d4a7b",
              "name": "",
              "description": "",
              "parentNodeId": "a9583cae-3265-458e-9dca-04e551c6646e",
              "fromNodeId": "a9583cae-3265-458e-9dca-04e551c6646e",
              "toNodeId": "1dca489b-fb00-4aa2-aca9-996d51e656e7"
            },
            "c98f7378-515e-4afe-8592-4603c31bd8a5": {
              "id": "c98f7378-515e-4afe-8592-4603c31bd8a5",
              "name": "",
              "description": "",
              "parentNodeId": "df6d7d6e-ac6f-4941-b7db-9cbdaba3125c",
              "fromNodeId": "71e2da52-8f0c-4366-8ed4-6f13a23bb533",
              "toNodeId": "9886268a-51fd-46aa-bda0-14236e23de5e"
            },
            "db28582e-b6cb-42e4-98e8-fb01ca04eda8": {
              "id": "db28582e-b6cb-42e4-98e8-fb01ca04eda8",
              "name": "Domain",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "cf276e84-d2d1-4bc2-b490-d455202cd77e",
              "toNodeId": "012f25e4-d69c-47ed-9041-3f00f9008177"
            },
            "df5f88e0-9252-48d2-a0c3-7276ffe0e553": {
              "id": "df5f88e0-9252-48d2-a0c3-7276ffe0e553",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "476a46e4-4928-46e0-8ee3-0aeb20e2bf1a",
              "toNodeId": "3d2b3a90-26d9-4aca-9e4c-401499ca62bc"
            },
            "fa2722d8-f7ab-4385-bbe2-5a79102fd35f": {
              "id": "fa2722d8-f7ab-4385-bbe2-5a79102fd35f",
              "name": "",
              "description": "",
              "parentNodeId": "39db1de6-6f97-45df-80c9-e27e05cbfbd6",
              "fromNodeId": "a9583cae-3265-458e-9dca-04e551c6646e",
              "toNodeId": ""
            },
            "fc7436d3-a760-4e11-b520-e9aceca03037": {
              "id": "fc7436d3-a760-4e11-b520-e9aceca03037",
              "name": "",
              "description": "",
              "parentNodeId": "012f25e4-d69c-47ed-9041-3f00f9008177",
              "fromNodeId": "012f25e4-d69c-47ed-9041-3f00f9008177",
              "toNodeId": "c329f098-3fbd-495e-9652-16a2d72efcbd"
            }
          },
          "nodes": {
            "012f25e4-d69c-47ed-9041-3f00f9008177": {
              "id": "012f25e4-d69c-47ed-9041-3f00f9008177",
              "parentNodeId": ""
            },
            "0cd18853-cc3d-46a5-80cf-fd5d4ba85f02": {
              "id": "0cd18853-cc3d-46a5-80cf-fd5d4ba85f02",
              "parentNodeId": "012f25e4-d69c-47ed-9041-3f00f9008177"
            },
            "1dca489b-fb00-4aa2-aca9-996d51e656e7": {
              "id": "1dca489b-fb00-4aa2-aca9-996d51e656e7",
              "parentNodeId": "a9583cae-3265-458e-9dca-04e551c6646e"
            },
            "3779a4ff-1a17-4ae2-8d4c-80e3a95ad7d0": {
              "id": "3779a4ff-1a17-4ae2-8d4c-80e3a95ad7d0",
              "parentNodeId": "39db1de6-6f97-45df-80c9-e27e05cbfbd6"
            },
            "39db1de6-6f97-45df-80c9-e27e05cbfbd6": {
              "id": "39db1de6-6f97-45df-80c9-e27e05cbfbd6",
              "parentNodeId": ""
            },
            "3d2b3a90-26d9-4aca-9e4c-401499ca62bc": {
              "id": "3d2b3a90-26d9-4aca-9e4c-401499ca62bc",
              "parentNodeId": ""
            },
            "476a46e4-4928-46e0-8ee3-0aeb20e2bf1a": {
              "id": "476a46e4-4928-46e0-8ee3-0aeb20e2bf1a",
              "parentNodeId": ""
            },
            "71e2da52-8f0c-4366-8ed4-6f13a23bb533": {
              "id": "71e2da52-8f0c-4366-8ed4-6f13a23bb533",
              "parentNodeId": "df6d7d6e-ac6f-4941-b7db-9cbdaba3125c"
            },
            "958a3303-e1a1-4414-ad6e-98d01a6a694d": {
              "id": "958a3303-e1a1-4414-ad6e-98d01a6a694d",
              "parentNodeId": ""
            },
            "9886268a-51fd-46aa-bda0-14236e23de5e": {
              "id": "9886268a-51fd-46aa-bda0-14236e23de5e",
              "parentNodeId": "df6d7d6e-ac6f-4941-b7db-9cbdaba3125c"
            },
            "a9583cae-3265-458e-9dca-04e551c6646e": {
              "id": "a9583cae-3265-458e-9dca-04e551c6646e",
              "parentNodeId": "39db1de6-6f97-45df-80c9-e27e05cbfbd6"
            },
            "ba8bae4b-ae24-47c9-b635-3ebb9b6a934a": {
              "id": "ba8bae4b-ae24-47c9-b635-3ebb9b6a934a",
              "parentNodeId": ""
            },
            "c329f098-3fbd-495e-9652-16a2d72efcbd": {
              "id": "c329f098-3fbd-495e-9652-16a2d72efcbd",
              "parentNodeId": "012f25e4-d69c-47ed-9041-3f00f9008177"
            },
            "c82f587a-72fa-4f5a-81a2-edd15173ca7b": {
              "id": "c82f587a-72fa-4f5a-81a2-edd15173ca7b",
              "parentNodeId": "476a46e4-4928-46e0-8ee3-0aeb20e2bf1a"
            },
            "cf276e84-d2d1-4bc2-b490-d455202cd77e": {
              "id": "cf276e84-d2d1-4bc2-b490-d455202cd77e",
              "parentNodeId": ""
            },
            "df6d7d6e-ac6f-4941-b7db-9cbdaba3125c": {
              "id": "df6d7d6e-ac6f-4941-b7db-9cbdaba3125c",
              "parentNodeId": ""
            },
            "f70411be-06b4-4c73-b16d-7b045486c7cb": {
              "id": "f70411be-06b4-4c73-b16d-7b045486c7cb",
              "parentNodeId": "476a46e4-4928-46e0-8ee3-0aeb20e2bf1a"
            }
          }
        },
        "steps": {
          "012f25e4-d69c-47ed-9041-3f00f9008177": {
            "nodeId": "012f25e4-d69c-47ed-9041-3f00f9008177",
            "name": "Domains",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "expression": null,
                    "value": "{{[c329f098-3fbd-495e-9652-16a2d72efcbd].[report]}}",
                    "valueType": "object"
                  },
                  "name": "Domain Reports",
                  "outputType": "array"
                }
              ],
              "innerEdgeId": "fc7436d3-a760-4e11-b520-e9aceca03037",
              "nextEdgeId": "3233ee24-cf62-419b-b238-f1afd7046b0f",
              "repeatVariable": "{{[ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[domains]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "Domain Reports": {
                  "description": "Custom output: \"Domain Reports\"",
                  "items": {
                    "properties": {},
                    "type": "object"
                  },
                  "title": "Domain Reports",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "0cd18853-cc3d-46a5-80cf-fd5d4ba85f02": {
            "nodeId": "0cd18853-cc3d-46a5-80cf-fd5d4ba85f02",
            "name": "Domain Report",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## Domain Report\n\n*Report for {{[012f25e4-d69c-47ed-9041-3f00f9008177].[$item]}}*\n* Alexa domain info: {{[c329f098-3fbd-495e-9652-16a2d72efcbd].[report].[Alexa domain info]}}\n* Webutation Safety Score: {{[c329f098-3fbd-495e-9652-16a2d72efcbd].[report].[Webutation domain info].[Safety score]}}\n* Webutation Verdict: {{[c329f098-3fbd-495e-9652-16a2d72efcbd].[report].[Webutation domain info].[Verdict]}}\n* Categories: {{#each [c329f098-3fbd-495e-9652-16a2d72efcbd].[report].[categories]}} {{this}} {{/each}}\n* BitDefender Domain Info: {{[c329f098-3fbd-495e-9652-16a2d72efcbd].[report].[BitDefender domain info]}}\n* Forcepoint ThreatSeeker Category: {{[c329f098-3fbd-495e-9652-16a2d72efcbd].[report].[Forcepoint ThreatSeeker category]}}\n* Full VirusTotal Report: [https://www.virustotal.com/gui/domain/{{[012f25e4-d69c-47ed-9041-3f00f9008177].[$item]}}/detection](https://www.virustotal.com/gui/domain/{{[012f25e4-d69c-47ed-9041-3f00f9008177].[$item]}}/detection)"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "1dca489b-fb00-4aa2-aca9-996d51e656e7": {
            "nodeId": "1dca489b-fb00-4aa2-aca9-996d51e656e7",
            "name": "Hashes Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## Hashes Report\n\n*Hash report for {{[39db1de6-6f97-45df-80c9-e27e05cbfbd6].[$item]}}*\n* Scan Date: {{[a9583cae-3265-458e-9dca-04e551c6646e].[$item].[scan_date]}}\n* Malicious: {{[a9583cae-3265-458e-9dca-04e551c6646e].[$item].[malicious]}}\n* Number of malicious reports: {{[a9583cae-3265-458e-9dca-04e551c6646e].[$item].[positives]}}\n* Total reports: {{[a9583cae-3265-458e-9dca-04e551c6646e].[$item].[total]}}\n* Complete VirusTotal Report: [{{[a9583cae-3265-458e-9dca-04e551c6646e].[$item].[permalink]}}]({{[a9583cae-3265-458e-9dca-04e551c6646e].[$item].[permalink]}})"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "3779a4ff-1a17-4ae2-8d4c-80e3a95ad7d0": {
            "nodeId": "3779a4ff-1a17-4ae2-8d4c-80e3a95ad7d0",
            "name": "Lookup Hashes",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "6.0.3",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/6.0.3/icon.png"
            },
            "identifier": "lookup_hashes",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "hashes": "{{[ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[processes]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "hashes": {
                  "description": "Array of MD5/SHA1/SHA256 hashes to lookup",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Hashes",
                  "type": "array"
                }
              },
              "required": [
                "hashes"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "report": {
                  "properties": {
                    "malicious": {
                      "description": "True if one or more positives",
                      "order": 1,
                      "title": "Malicious",
                      "type": "boolean"
                    },
                    "md5": {
                      "description": "MD5 hash",
                      "order": 11,
                      "title": "MD5",
                      "type": "string"
                    },
                    "permalink": {
                      "description": "Link to report (if found)",
                      "order": 3,
                      "title": "Permalink",
                      "type": "string"
                    },
                    "positives": {
                      "description": "Number of positives (if found)",
                      "order": 2,
                      "title": "Positives",
                      "type": "integer"
                    },
                    "resource": {
                      "description": "Resource",
                      "order": 4,
                      "title": "Resource",
                      "type": "string"
                    },
                    "scan_date": {
                      "description": "Scan Date",
                      "order": 6,
                      "title": "Scan Date",
                      "type": "string"
                    },
                    "scan_id": {
                      "description": "Scan ID",
                      "order": 5,
                      "title": "Scan Id",
                      "type": "string"
                    },
                    "scans": {
                      "description": "Scans",
                      "order": 7,
                      "title": "Scans",
                      "type": "object"
                    },
                    "sha1": {
                      "description": "SHA1 hash",
                      "order": 10,
                      "title": "SHA1",
                      "type": "string"
                    },
                    "sha256": {
                      "description": "SHA256 hash",
                      "order": 9,
                      "title": "SHA256",
                      "type": "string"
                    },
                    "total": {
                      "description": "Total Scans",
                      "order": 8,
                      "title": "Total",
                      "type": "integer"
                    },
                    "verbose_msg": {
                      "description": "Message returned from the submission",
                      "order": 12,
                      "title": "Verbose Message",
                      "type": "string"
                    }
                  },
                  "title": "Report",
                  "type": "object"
                }
              },
              "properties": {
                "hashes_found": {
                  "description": "Hashes found, if any",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Hashes Found",
                  "type": "array"
                },
                "reports_found": {
                  "description": "Reports found, if any",
                  "items": {
                    "$ref": "#/definitions/report"
                  },
                  "order": 2,
                  "title": "Reports Found",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "39db1de6-6f97-45df-80c9-e27e05cbfbd6": {
            "nodeId": "39db1de6-6f97-45df-80c9-e27e05cbfbd6",
            "name": "Hashes",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "expression": null,
                    "expressionText": "",
                    "value": "{{[3779a4ff-1a17-4ae2-8d4c-80e3a95ad7d0].[reports_found]}}",
                    "valueType": "array"
                  },
                  "name": "Hash Reports",
                  "outputType": "array"
                }
              ],
              "innerEdgeId": "030e4053-950d-4e45-a8fe-5b7c3bff5404",
              "nextEdgeId": "585a3873-7da5-4b04-ac73-0e05d4fffab4",
              "repeatVariable": "{{[ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[processes]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "Hash Reports": {
                  "description": "Custom output: \"Hash Reports\"",
                  "items": {
                    "type": "array"
                  },
                  "title": "Hash Reports",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "3d2b3a90-26d9-4aca-9e4c-401499ca62bc": {
            "nodeId": "3d2b3a90-26d9-4aca-9e4c-401499ca62bc",
            "name": "Join on Indicator Reports",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "df5f88e0-9252-48d2-a0c3-7276ffe0e553",
                "585a3873-7da5-4b04-ac73-0e05d4fffab4",
                "5066dc7e-39e4-4358-a065-27eba40e4da2",
                "3233ee24-cf62-419b-b238-f1afd7046b0f"
              ],
              "variableSets": [
                {
                  "arrayType": "object",
                  "inputBuilderSchemas": null,
                  "name": "Reports",
                  "type": "array",
                  "variables": {
                    "3233ee24-cf62-419b-b238-f1afd7046b0f": "{{[012f25e4-d69c-47ed-9041-3f00f9008177].[Domain Reports]}}",
                    "5066dc7e-39e4-4358-a065-27eba40e4da2": "{{[df6d7d6e-ac6f-4941-b7db-9cbdaba3125c].[URL Reports]}}",
                    "585a3873-7da5-4b04-ac73-0e05d4fffab4": "{{[39db1de6-6f97-45df-80c9-e27e05cbfbd6].[Hash Reports]}}",
                    "df5f88e0-9252-48d2-a0c3-7276ffe0e553": "{{[476a46e4-4928-46e0-8ee3-0aeb20e2bf1a].[IP Address Reports]}}"
                  }
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {
                "Reports": {
                  "description": "Emitted variable \"Reports\"",
                  "items": {
                    "type": "object"
                  },
                  "order": 1,
                  "title": "Reports",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {
                "Reports": {
                  "description": "Emitted variable \"Reports\"",
                  "items": {
                    "type": "object"
                  },
                  "order": 1,
                  "title": "Reports",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "476a46e4-4928-46e0-8ee3-0aeb20e2bf1a": {
            "nodeId": "476a46e4-4928-46e0-8ee3-0aeb20e2bf1a",
            "name": "IP Addresses",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "expression": null,
                    "value": "{{[c82f587a-72fa-4f5a-81a2-edd15173ca7b].[report]}}",
                    "valueType": "object"
                  },
                  "name": "IP Address Reports",
                  "outputType": "array"
                }
              ],
              "innerEdgeId": "4633d77a-19d6-4df5-85ff-086ad74aae9b",
              "nextEdgeId": "df5f88e0-9252-48d2-a0c3-7276ffe0e553",
              "repeatVariable": "{{[ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[ipAddresses]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "IP Address Reports": {
                  "description": "Custom output: \"IP Address Reports\"",
                  "items": {
                    "properties": {},
                    "type": "object"
                  },
                  "title": "IP Address Reports",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "71e2da52-8f0c-4366-8ed4-6f13a23bb533": {
            "nodeId": "71e2da52-8f0c-4366-8ed4-6f13a23bb533",
            "name": "Lookup URL",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "6.0.3",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/6.0.3/icon.png"
            },
            "identifier": "scan_url_report",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "url": "{{[df6d7d6e-ac6f-4941-b7db-9cbdaba3125c].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "url": {
                  "description": "URL scanned",
                  "order": 1,
                  "title": "URL",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "malicious": {
                  "description": "True if one or more positives",
                  "order": 1,
                  "title": "Malicious",
                  "type": "boolean"
                },
                "permalink": {
                  "description": "Permalink",
                  "order": 8,
                  "title": "Permalink",
                  "type": "string"
                },
                "positives": {
                  "description": "Positives",
                  "order": 9,
                  "title": "Positives",
                  "type": "integer"
                },
                "resource": {
                  "description": "Resource",
                  "order": 4,
                  "title": "Resource",
                  "type": "string"
                },
                "response_code": {
                  "description": "Response code",
                  "order": 2,
                  "title": "Response Code",
                  "type": "integer"
                },
                "scan_date": {
                  "description": "Scan date",
                  "order": 7,
                  "title": "Scan Date",
                  "type": "string"
                },
                "scan_id": {
                  "description": "Scan ID",
                  "order": 6,
                  "title": "Scan ID",
                  "type": "string"
                },
                "scans": {
                  "description": "Scans",
                  "order": 11,
                  "title": "Scans",
                  "type": "object"
                },
                "total": {
                  "description": "Total",
                  "order": 10,
                  "title": "Total",
                  "type": "integer"
                },
                "url": {
                  "description": "URL",
                  "order": 5,
                  "title": "URL",
                  "type": "string"
                },
                "verbose_msg": {
                  "description": "Verbose message",
                  "order": 3,
                  "title": "Verbose Message",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "958a3303-e1a1-4414-ad6e-98d01a6a694d": {
            "nodeId": "958a3303-e1a1-4414-ad6e-98d01a6a694d",
            "name": "No Indicators",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "This alert did not contain any indicators for VirusTotal to analyze. \n\nThis workflow is now complete."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "9886268a-51fd-46aa-bda0-14236e23de5e": {
            "nodeId": "9886268a-51fd-46aa-bda0-14236e23de5e",
            "name": "URL Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## URLs Report\n\n*Report for {{[df6d7d6e-ac6f-4941-b7db-9cbdaba3125c].[$item]}}*\n* Scan Date: {{[71e2da52-8f0c-4366-8ed4-6f13a23bb533].[scan_date]}}\n* Malicious: {{[71e2da52-8f0c-4366-8ed4-6f13a23bb533].[malicious]}}\n* Found Malicious by `{{[71e2da52-8f0c-4366-8ed4-6f13a23bb533].[positives]}}` scans out of `{{[71e2da52-8f0c-4366-8ed4-6f13a23bb533].[total]}}` total\n* Full VirusTotal Report: [{{[71e2da52-8f0c-4366-8ed4-6f13a23bb533].[permalink]}}]({{[71e2da52-8f0c-4366-8ed4-6f13a23bb533].[permalink]}})\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "a9583cae-3265-458e-9dca-04e551c6646e": {
            "nodeId": "a9583cae-3265-458e-9dca-04e551c6646e",
            "name": "Hash Reports Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "c28c0a2a-210e-41e7-b6d0-09ea5e0d4a7b",
              "nextEdgeId": "fa2722d8-f7ab-4385-bbe2-5a79102fd35f",
              "repeatVariable": "{{[3779a4ff-1a17-4ae2-8d4c-80e3a95ad7d0].[reports_found]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "ba8bae4b-ae24-47c9-b635-3ebb9b6a934a": {
            "nodeId": "ba8bae4b-ae24-47c9-b635-3ebb9b6a934a",
            "name": "IDR Alert",
            "type": "trigger",
            "continueOnFailure": false,
            "isDisabled": false,
            "triggerId": "32fe9b16-1a8a-4051-80ac-ed9986b23c80",
            "defaultInputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "assetId": {
                      "description": "the ID of the asset",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 3,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 2,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname",
                    "assetId"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "content": {
                  "properties": {
                    "domains": {
                      "description": "A list of domains to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Domains",
                      "type": "array"
                    },
                    "ipAddresses": {
                      "description": "A list of ip addresses to check",
                      "items": {
                        "$ref": "#/definitions/ipAddress"
                      },
                      "order": 3,
                      "title": "IpAddresses",
                      "type": "array"
                    },
                    "processes": {
                      "description": "A list of processes to check",
                      "items": {
                        "$ref": "#/definitions/process"
                      },
                      "order": 4,
                      "title": "Processes",
                      "type": "array"
                    },
                    "urls": {
                      "description": "A list of URLs to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Urls",
                      "type": "array"
                    }
                  },
                  "title": "Content",
                  "type": "object"
                },
                "hash": {
                  "properties": {
                    "hash": {
                      "description": "The actual hash",
                      "order": 1,
                      "title": "Hash",
                      "type": "string"
                    },
                    "type": {
                      "description": "The algorithm used to generate the hash",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "hash",
                    "type"
                  ],
                  "title": "Hash",
                  "type": "object"
                },
                "ipAddress": {
                  "properties": {
                    "ip": {
                      "description": "The raw IP",
                      "order": 1,
                      "title": "Ip",
                      "type": "string"
                    },
                    "type": {
                      "description": "Denotes if an IP is internal or external",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "ip",
                    "type"
                  ],
                  "title": "IpAddress",
                  "type": "object"
                },
                "process": {
                  "properties": {
                    "assetId": {
                      "description": "The asset id associated with the process",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "cmdLine": {
                      "description": "The raw value of the command line call used to invoke the process",
                      "order": 5,
                      "title": "CmdLine",
                      "type": "string"
                    },
                    "hashes": {
                      "description": "The list of hashes to check",
                      "items": {
                        "$ref": "#/definitions/hash"
                      },
                      "order": 3,
                      "title": "Hashes",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the process",
                      "order": 4,
                      "title": "Name",
                      "type": "string"
                    },
                    "processId": {
                      "description": "The PID from the running process on the asset",
                      "order": 2,
                      "title": "ProcessId",
                      "type": "integer"
                    }
                  },
                  "required": [
                    "assetId",
                    "processId"
                  ],
                  "title": "Process",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 7,
                  "title": "Actors"
                },
                "contents": {
                  "$ref": "#/definitions/content",
                  "description": "The contents to enrich",
                  "order": 8,
                  "title": "Contents"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The investigation id",
                  "order": 6,
                  "title": "InvestigationId",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "investigationId",
                "actors",
                "timestamp",
                "type",
                "name",
                "description",
                "link"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "assetId": {
                      "description": "the ID of the asset",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 3,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 2,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname",
                    "assetId"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "content": {
                  "properties": {
                    "domains": {
                      "description": "A list of domains to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Domains",
                      "type": "array"
                    },
                    "ipAddresses": {
                      "description": "A list of ip addresses to check",
                      "items": {
                        "$ref": "#/definitions/ipAddress"
                      },
                      "order": 3,
                      "title": "IpAddresses",
                      "type": "array"
                    },
                    "processes": {
                      "description": "A list of processes to check",
                      "items": {
                        "$ref": "#/definitions/process"
                      },
                      "order": 4,
                      "title": "Processes",
                      "type": "array"
                    },
                    "urls": {
                      "description": "A list of URLs to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Urls",
                      "type": "array"
                    }
                  },
                  "title": "Content",
                  "type": "object"
                },
                "hash": {
                  "properties": {
                    "hash": {
                      "description": "The actual hash",
                      "order": 1,
                      "title": "Hash",
                      "type": "string"
                    },
                    "type": {
                      "description": "The algorithm used to generate the hash",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "hash",
                    "type"
                  ],
                  "title": "Hash",
                  "type": "object"
                },
                "ipAddress": {
                  "properties": {
                    "ip": {
                      "description": "The raw IP",
                      "order": 1,
                      "title": "Ip",
                      "type": "string"
                    },
                    "type": {
                      "description": "Denotes if an IP is internal or external",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "ip",
                    "type"
                  ],
                  "title": "IpAddress",
                  "type": "object"
                },
                "process": {
                  "properties": {
                    "assetId": {
                      "description": "The asset id associated with the process",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "cmdLine": {
                      "description": "The raw value of the command line call used to invoke the process",
                      "order": 5,
                      "title": "CmdLine",
                      "type": "string"
                    },
                    "hashes": {
                      "description": "The list of hashes to check",
                      "items": {
                        "$ref": "#/definitions/hash"
                      },
                      "order": 3,
                      "title": "Hashes",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the process",
                      "order": 4,
                      "title": "Name",
                      "type": "string"
                    },
                    "processId": {
                      "description": "The PID from the running process on the asset",
                      "order": 2,
                      "title": "ProcessId",
                      "type": "integer"
                    }
                  },
                  "required": [
                    "assetId",
                    "processId"
                  ],
                  "title": "Process",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 7,
                  "title": "Actors"
                },
                "contents": {
                  "$ref": "#/definitions/content",
                  "description": "The contents to enrich",
                  "order": 8,
                  "title": "Contents"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The investigation id",
                  "order": 6,
                  "title": "InvestigationId",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "investigationId",
                "actors",
                "timestamp",
                "type",
                "name",
                "description",
                "link"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/trigger-api-idr.svg",
            "connectionType": "NONE"
          },
          "c329f098-3fbd-495e-9652-16a2d72efcbd": {
            "nodeId": "c329f098-3fbd-495e-9652-16a2d72efcbd",
            "name": "Lookup Domain",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "6.0.3",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/6.0.3/icon.png"
            },
            "identifier": "domain_report",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "domain": "{{[012f25e4-d69c-47ed-9041-3f00f9008177].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "domain": {
                  "description": "Domain name",
                  "order": 1,
                  "title": "Domain",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "detected_url": {
                  "properties": {
                    "positives": {
                      "description": "Positives",
                      "order": 2,
                      "title": "Positives",
                      "type": "integer"
                    },
                    "scan_date": {
                      "description": "Date the URL was scanned",
                      "order": 4,
                      "title": "Scan Date",
                      "type": "string"
                    },
                    "total": {
                      "description": "Total scan engines that found the URL malicious",
                      "order": 3,
                      "title": "Total",
                      "type": "integer"
                    },
                    "url": {
                      "description": "URL",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    }
                  },
                  "title": "Detected Url",
                  "type": "object"
                },
                "domain_report": {
                  "properties": {
                    "Alexa category": {
                      "description": "Alexa category",
                      "order": 16,
                      "title": "Alexa Category",
                      "type": "string"
                    },
                    "Alexa domain info": {
                      "description": "Alexa domain information",
                      "order": 11,
                      "title": "Alexa Domain Information",
                      "type": "string"
                    },
                    "Alexa rank": {
                      "description": "Alexa rank",
                      "order": 24,
                      "title": "Alexa Rank",
                      "type": "integer"
                    },
                    "BitDefender category": {
                      "description": "BitDefender category",
                      "order": 5,
                      "title": "BitDefender Category",
                      "type": "string"
                    },
                    "BitDefender domain info": {
                      "description": "BitDefender domain information",
                      "order": 9,
                      "title": "BitDefender Domain Information",
                      "type": "string"
                    },
                    "Dr.Web category": {
                      "description": "Dr.Web category",
                      "order": 26,
                      "title": "Dr.Web Category",
                      "type": "string"
                    },
                    "Forcepoint ThreatSeeker category": {
                      "description": "Forcepoint Threat Seeker category",
                      "order": 15,
                      "title": "Forcepoint Threat Seeker Category",
                      "type": "string"
                    },
                    "TrendMicro category": {
                      "description": "TrendMicro category",
                      "order": 23,
                      "title": "TrendMicro Category",
                      "type": "string"
                    },
                    "WOT domain info": {
                      "$ref": "#/definitions/wot_info",
                      "description": "WOT domain information",
                      "order": 13,
                      "title": "WOT Domain Information"
                    },
                    "Websense ThreatSeeker category": {
                      "description": "Websense ThreatSeeker category",
                      "order": 22,
                      "title": "Websense ThreatSeeker Category",
                      "type": "string"
                    },
                    "Webutation domain info": {
                      "$ref": "#/definitions/webutation_info",
                      "description": "Webutation domain info",
                      "order": 20,
                      "title": "Webutation Domain Info"
                    },
                    "categories": {
                      "description": "Categories",
                      "items": {
                        "type": "string"
                      },
                      "order": 18,
                      "title": "Categories",
                      "type": "array"
                    },
                    "detected_communicating_samples": {
                      "description": "Detected communication samples",
                      "items": {
                        "$ref": "#/definitions/samples"
                      },
                      "order": 17,
                      "title": "Detected Communication Samples",
                      "type": "array"
                    },
                    "detected_downloaded_samples": {
                      "description": "Detected download samples",
                      "items": {
                        "$ref": "#/definitions/samples"
                      },
                      "order": 7,
                      "title": "Detected Download Samples",
                      "type": "array"
                    },
                    "detected_referrer_samples": {
                      "description": "Detected referrer samples",
                      "items": {
                        "$ref": "#/definitions/samples"
                      },
                      "order": 14,
                      "title": "Detected Referrer Samples",
                      "type": "array"
                    },
                    "detected_urls": {
                      "description": "Collection of detected URLs and information about them",
                      "items": {
                        "$ref": "#/definitions/detected_url"
                      },
                      "order": 4,
                      "title": "Detected URLs",
                      "type": "array"
                    },
                    "domain_siblings": {
                      "description": "Domain siblings",
                      "items": {
                        "type": "string"
                      },
                      "order": 8,
                      "title": "Domain Siblings",
                      "type": "array"
                    },
                    "pcaps": {
                      "description": "Packet capture hashes",
                      "items": {
                        "type": "string"
                      },
                      "order": 27,
                      "title": "PCAPS",
                      "type": "array"
                    },
                    "resolutions": {
                      "description": "Collection of historical IPs resolved to the hostname being reported on",
                      "items": {
                        "$ref": "#/definitions/domain_resolution"
                      },
                      "order": 3,
                      "title": "Resolutions",
                      "type": "array"
                    },
                    "response_code": {
                      "description": "Response code from the request",
                      "order": 1,
                      "title": "Response Code",
                      "type": "integer"
                    },
                    "subdomains": {
                      "description": "Subdomains",
                      "items": {
                        "type": "string"
                      },
                      "order": 21,
                      "title": "Subdomains",
                      "type": "array"
                    },
                    "undetected_communicating_samples": {
                      "description": "Undetected communicating samples",
                      "items": {
                        "$ref": "#/definitions/samples"
                      },
                      "order": 25,
                      "title": "Undetected Communicating Samples",
                      "type": "array"
                    },
                    "undetected_downloaded_samples": {
                      "description": "Undetected downloaded samples",
                      "items": {
                        "$ref": "#/definitions/samples"
                      },
                      "order": 6,
                      "title": "Undetected Downloaded Samples",
                      "type": "array"
                    },
                    "undetected_urls": {
                      "description": "Undetected URLs",
                      "items": {},
                      "order": 19,
                      "title": "Undetected URLs",
                      "type": "array"
                    },
                    "verbose_msg": {
                      "description": "Verbose message from the request",
                      "order": 2,
                      "title": "Verbose Message",
                      "type": "string"
                    },
                    "whois": {
                      "description": "WHOIS Inforamtion",
                      "order": 10,
                      "title": "WHOIS",
                      "type": "string"
                    },
                    "whois_timestamp": {
                      "description": "WHOIS timestamp",
                      "order": 12,
                      "title": "WHOIS Timestamp",
                      "type": "integer"
                    }
                  },
                  "title": "Domain Report",
                  "type": "object"
                },
                "domain_resolution": {
                  "properties": {
                    "ip_address": {
                      "description": "Hostname of the IP at the time it was resolved",
                      "order": 2,
                      "title": "IP Address",
                      "type": "string"
                    },
                    "last_resolved": {
                      "description": "Datetime of when the IP was last resolved",
                      "order": 1,
                      "title": "Last Resolved",
                      "type": "string"
                    }
                  },
                  "title": "Domain Resolution",
                  "type": "object"
                },
                "samples": {
                  "properties": {
                    "date": {
                      "description": "Date",
                      "order": 1,
                      "title": "Date",
                      "type": "string"
                    },
                    "positives": {
                      "description": "Positives",
                      "order": 2,
                      "title": "Positives",
                      "type": "integer"
                    },
                    "sha256": {
                      "description": "SHA256 hash",
                      "order": 4,
                      "title": "SHA256",
                      "type": "string"
                    },
                    "total": {
                      "description": "Total",
                      "order": 3,
                      "title": "Total",
                      "type": "integer"
                    }
                  },
                  "title": "Samples",
                  "type": "object"
                },
                "webutation_info": {
                  "properties": {
                    "Adult content": {
                      "description": "Adult content",
                      "order": 1,
                      "title": "Adult Content",
                      "type": "string"
                    },
                    "Safety score": {
                      "description": "Safety score",
                      "order": 2,
                      "title": "Safety Score",
                      "type": "integer"
                    },
                    "Verdict": {
                      "description": "Verdict",
                      "order": 3,
                      "title": "Verdict",
                      "type": "string"
                    }
                  },
                  "title": "Webutation Info",
                  "type": "object"
                },
                "wot_info": {
                  "properties": {
                    "Child safety": {
                      "description": "Child safety",
                      "order": 1,
                      "title": "Child Safety",
                      "type": "string"
                    },
                    "Privacy": {
                      "description": "Privacy",
                      "order": 2,
                      "title": "Privacy",
                      "type": "string"
                    },
                    "Trustworthiness": {
                      "description": "Trustworthiness",
                      "order": 3,
                      "title": "Trustworthiness",
                      "type": "string"
                    },
                    "Vendor reliability": {
                      "description": "Vendor reliability",
                      "order": 4,
                      "title": "Vendor Reliability",
                      "type": "string"
                    }
                  },
                  "title": "Wot Info",
                  "type": "object"
                }
              },
              "properties": {
                "report": {
                  "$ref": "#/definitions/domain_report",
                  "description": "Domain report",
                  "order": 1,
                  "title": "Report"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "c82f587a-72fa-4f5a-81a2-edd15173ca7b": {
            "nodeId": "c82f587a-72fa-4f5a-81a2-edd15173ca7b",
            "name": "Lookup IP",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "6.0.3",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/6.0.3/icon.png"
            },
            "identifier": "ip_address_report",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "address": "{{[476a46e4-4928-46e0-8ee3-0aeb20e2bf1a].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "IP address",
                  "order": 1,
                  "title": "IP Address",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "detected_url": {
                  "properties": {
                    "positives": {
                      "description": "Positives",
                      "order": 2,
                      "title": "Positives",
                      "type": "integer"
                    },
                    "scan_date": {
                      "description": "Date the URL was scanned",
                      "order": 4,
                      "title": "Scan Date",
                      "type": "string"
                    },
                    "total": {
                      "description": "Total scan engines that found the URL malicious",
                      "order": 3,
                      "title": "Total",
                      "type": "integer"
                    },
                    "url": {
                      "description": "URL",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    }
                  },
                  "title": "Detected Url",
                  "type": "object"
                },
                "ip_report": {
                  "properties": {
                    "as_owner": {
                      "description": "As owner",
                      "order": 9,
                      "title": "As Owner",
                      "type": "string"
                    },
                    "asn": {
                      "description": "Autonomous system number",
                      "order": 5,
                      "title": "ASN",
                      "type": "integer"
                    },
                    "country": {
                      "description": "Country",
                      "order": 11,
                      "title": "Country",
                      "type": "string"
                    },
                    "detected_communicating_samples": {
                      "description": "Detected communicating samples",
                      "items": {
                        "$ref": "#/definitions/samples"
                      },
                      "order": 13,
                      "title": "Detected Communicating Samples",
                      "type": "array"
                    },
                    "detected_downloaded_samples": {
                      "description": "Detected downloaded samples",
                      "items": {
                        "$ref": "#/definitions/samples"
                      },
                      "order": 8,
                      "title": "Detected Downloaded Samples",
                      "type": "array"
                    },
                    "detected_referrer_samples": {
                      "description": "Detected referrer samples",
                      "items": {
                        "$ref": "#/definitions/samples"
                      },
                      "order": 10,
                      "title": "Detected Referrer Samples",
                      "type": "array"
                    },
                    "detected_urls": {
                      "description": "Collection of detected URLs and information about them",
                      "items": {
                        "$ref": "#/definitions/detected_url"
                      },
                      "order": 4,
                      "title": "Detected URLs",
                      "type": "array"
                    },
                    "resolutions": {
                      "description": "Collection of historical hostnames resolved to the IP being reported on",
                      "items": {
                        "$ref": "#/definitions/ip_resolution"
                      },
                      "order": 3,
                      "title": "Resolutions",
                      "type": "array"
                    },
                    "response_code": {
                      "description": "Response code from the request",
                      "order": 1,
                      "title": "Response Code",
                      "type": "integer"
                    },
                    "undetected_communicating_samples": {
                      "description": "Undetected communication samples",
                      "items": {
                        "$ref": "#/definitions/samples"
                      },
                      "order": 14,
                      "title": "Undetected Communication Samples",
                      "type": "array"
                    },
                    "undetected_downloaded_samples": {
                      "description": "Undetected downloaded samples",
                      "items": {
                        "$ref": "#/definitions/samples"
                      },
                      "order": 7,
                      "title": "Undetected Downloaded Samples",
                      "type": "array"
                    },
                    "undetected_referrer_samples": {
                      "description": "Undetected referrer samples",
                      "items": {
                        "$ref": "#/definitions/referrer_samples"
                      },
                      "order": 12,
                      "title": "Undetected Referrer Samples",
                      "type": "array"
                    },
                    "undetected_urls": {
                      "description": "Undetected URLs",
                      "items": {},
                      "order": 6,
                      "title": "Undetected URLs",
                      "type": "array"
                    },
                    "verbose_msg": {
                      "description": "Verbose message from the request",
                      "order": 2,
                      "title": "Verbose Message",
                      "type": "string"
                    }
                  },
                  "title": "Ip Report",
                  "type": "object"
                },
                "ip_resolution": {
                  "properties": {
                    "hostname": {
                      "description": "Hostname of the IP at the time it was resolved",
                      "order": 2,
                      "title": "Hostname",
                      "type": "string"
                    },
                    "last_resolved": {
                      "description": "Datetime of when the IP was last resolved",
                      "order": 1,
                      "title": "Last Resolved",
                      "type": "string"
                    }
                  },
                  "title": "Ip Resolution",
                  "type": "object"
                },
                "referrer_samples": {
                  "properties": {
                    "positives": {
                      "description": "Positives",
                      "order": 1,
                      "title": "Positives",
                      "type": "integer"
                    },
                    "sha256": {
                      "description": "SHA256 hash",
                      "order": 2,
                      "title": "SHA256",
                      "type": "string"
                    },
                    "total": {
                      "description": "Total",
                      "order": 3,
                      "title": "Total",
                      "type": "integer"
                    }
                  },
                  "title": "Referrer Samples",
                  "type": "object"
                },
                "samples": {
                  "properties": {
                    "date": {
                      "description": "Date",
                      "order": 1,
                      "title": "Date",
                      "type": "string"
                    },
                    "positives": {
                      "description": "Positives",
                      "order": 2,
                      "title": "Positives",
                      "type": "integer"
                    },
                    "sha256": {
                      "description": "SHA256 hash",
                      "order": 4,
                      "title": "SHA256",
                      "type": "string"
                    },
                    "total": {
                      "description": "Total",
                      "order": 3,
                      "title": "Total",
                      "type": "integer"
                    }
                  },
                  "title": "Samples",
                  "type": "object"
                }
              },
              "properties": {
                "report": {
                  "$ref": "#/definitions/ip_report",
                  "description": "IP address report",
                  "order": 1,
                  "title": "Report"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "cf276e84-d2d1-4bc2-b490-d455202cd77e": {
            "nodeId": "cf276e84-d2d1-4bc2-b490-d455202cd77e",
            "name": "Type of Indicator?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "1ae7447a-757f-4f4d-8c81-cfb28e2b81cc",
              "stepControlParams": [
                {
                  "edgeId": "8423c541-da72-452c-982b-c96b1ec860d2",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "ba8bae4b-ae24-47c9-b635-3ebb9b6a934a.contents.urls",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": ">",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[urls]}})>0"
                },
                {
                  "edgeId": "5babcb34-486f-46ae-857b-208a77d3f7cc",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "ba8bae4b-ae24-47c9-b635-3ebb9b6a934a.contents.ipAddresses",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": ">",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[ipAddresses]}})>0"
                },
                {
                  "edgeId": "db28582e-b6cb-42e4-98e8-fb01ca04eda8",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "ba8bae4b-ae24-47c9-b635-3ebb9b6a934a.contents.domains",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": ">",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[domains]}})>0"
                },
                {
                  "edgeId": "80fc5707-3ac3-4f69-bd6c-28ce1a990333",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "ba8bae4b-ae24-47c9-b635-3ebb9b6a934a.contents.processes",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": ">",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[processes]}})>0"
                },
                {
                  "edgeId": "1ae7447a-757f-4f4d-8c81-cfb28e2b81cc",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "df6d7d6e-ac6f-4941-b7db-9cbdaba3125c": {
            "nodeId": "df6d7d6e-ac6f-4941-b7db-9cbdaba3125c",
            "name": "URLs",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "expression": {
                      "left": {
                        "name": "71e2da52-8f0c-4366-8ed4-6f13a23bb533.response_code",
                        "type": "variable"
                      },
                      "op": "!=",
                      "right": {
                        "type": "literal",
                        "value": 0
                      },
                      "type": "binary"
                    },
                    "expressionText": "{{[71e2da52-8f0c-4366-8ed4-6f13a23bb533].[response_code]}}!=0",
                    "value": "{{[71e2da52-8f0c-4366-8ed4-6f13a23bb533].[scans]}}",
                    "valueType": "object"
                  },
                  "name": "URL Reports",
                  "outputType": "array"
                }
              ],
              "innerEdgeId": "991ad82c-d55e-4303-a697-f6ed47d701ea",
              "nextEdgeId": "5066dc7e-39e4-4358-a065-27eba40e4da2",
              "repeatVariable": "{{[ba8bae4b-ae24-47c9-b635-3ebb9b6a934a].[contents].[urls]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "URL Reports": {
                  "description": "Custom output: \"URL Reports\"",
                  "items": {
                    "properties": {},
                    "type": "object"
                  },
                  "title": "URL Reports",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "f70411be-06b4-4c73-b16d-7b045486c7cb": {
            "nodeId": "f70411be-06b4-4c73-b16d-7b045486c7cb",
            "name": "IP Addresses Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## IP Addresses Report\n\n*Report for {{[476a46e4-4928-46e0-8ee3-0aeb20e2bf1a].[$item]}}*\n* Hosting country: {{[c82f587a-72fa-4f5a-81a2-edd15173ca7b].[report].[country]}}\n* Network: {{[c82f587a-72fa-4f5a-81a2-edd15173ca7b].[report].[network]}}\n* ASN: {{[c82f587a-72fa-4f5a-81a2-edd15173ca7b].[report].[asn]}}\n* Number of engines that detected malicious URLs associated with this IP: {{[c82f587a-72fa-4f5a-81a2-edd15173ca7b].[report].[detected_urls].[0].[positives]}}\n* Total number of engines in `detected_URLs` dataset: {{[c82f587a-72fa-4f5a-81a2-edd15173ca7b].[report].[detected_urls].[0].[total]}}\n* Number of engines that detected malicious download samples from this IP: {{[c82f587a-72fa-4f5a-81a2-edd15173ca7b].[report].[detected_downloaded_samples].[0].[positive]}}\n* Total number of engines in `detected_downloaded_samples` dataset: {{[c82f587a-72fa-4f5a-81a2-edd15173ca7b].[report].[detected_downloaded_samples].[0].[total]}}\n* Number of engines that detected malicious referrer samples from this IP: {{[c82f587a-72fa-4f5a-81a2-edd15173ca7b].[report].[detected_referrer_samples].[0].[positives]}}\n* Total number of engines in `detected_referrer_samples` dataset: {{[c82f587a-72fa-4f5a-81a2-edd15173ca7b].[report].[detected_referrer_samples].[0].[total]}}\n* Complete VirusTotal Report: [https://www.virustotal.com/gui/ip-address/{{[476a46e4-4928-46e0-8ee3-0aeb20e2bf1a].[$item]}}](https://www.virustotal.com/gui/ip-address/{{[476a46e4-4928-46e0-8ee3-0aeb20e2bf1a].[$item]}})"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          }
        },
        "tags": null,
        "humanCostSeconds": 600,
        "humanCostDisplayUnit": "minutes"
      }
    ],
    "triggers": [
      {
        "id": "32fe9b16-1a8a-4051-80ac-ed9986b23c80",
        "name": "IDR Alert",
        "description": "",
        "input": null,
        "inputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "assetId": {
                  "description": "the ID of the asset",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 3,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 2,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname",
                "assetId"
              ],
              "title": "Asset",
              "type": "object"
            },
            "content": {
              "properties": {
                "domains": {
                  "description": "A list of domains to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Domains",
                  "type": "array"
                },
                "ipAddresses": {
                  "description": "A list of ip addresses to check",
                  "items": {
                    "$ref": "#/definitions/ipAddress"
                  },
                  "order": 3,
                  "title": "IpAddresses",
                  "type": "array"
                },
                "processes": {
                  "description": "A list of processes to check",
                  "items": {
                    "$ref": "#/definitions/process"
                  },
                  "order": 4,
                  "title": "Processes",
                  "type": "array"
                },
                "urls": {
                  "description": "A list of URLs to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Urls",
                  "type": "array"
                }
              },
              "title": "Content",
              "type": "object"
            },
            "hash": {
              "properties": {
                "hash": {
                  "description": "The actual hash",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                },
                "type": {
                  "description": "The algorithm used to generate the hash",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "hash",
                "type"
              ],
              "title": "Hash",
              "type": "object"
            },
            "ipAddress": {
              "properties": {
                "ip": {
                  "description": "The raw IP",
                  "order": 1,
                  "title": "Ip",
                  "type": "string"
                },
                "type": {
                  "description": "Denotes if an IP is internal or external",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "ip",
                "type"
              ],
              "title": "IpAddress",
              "type": "object"
            },
            "process": {
              "properties": {
                "assetId": {
                  "description": "The asset id associated with the process",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "cmdLine": {
                  "description": "The raw value of the command line call used to invoke the process",
                  "order": 5,
                  "title": "CmdLine",
                  "type": "string"
                },
                "hashes": {
                  "description": "The list of hashes to check",
                  "items": {
                    "$ref": "#/definitions/hash"
                  },
                  "order": 3,
                  "title": "Hashes",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the process",
                  "order": 4,
                  "title": "Name",
                  "type": "string"
                },
                "processId": {
                  "description": "The PID from the running process on the asset",
                  "order": 2,
                  "title": "ProcessId",
                  "type": "integer"
                }
              },
              "required": [
                "assetId",
                "processId"
              ],
              "title": "Process",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 7,
              "title": "Actors"
            },
            "contents": {
              "$ref": "#/definitions/content",
              "description": "The contents to enrich",
              "order": 8,
              "title": "Contents"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The investigation id",
              "order": 6,
              "title": "InvestigationId",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "investigationId",
            "actors",
            "timestamp",
            "type",
            "name",
            "description",
            "link"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "assetId": {
                  "description": "the ID of the asset",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 3,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 2,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname",
                "assetId"
              ],
              "title": "Asset",
              "type": "object"
            },
            "content": {
              "properties": {
                "domains": {
                  "description": "A list of domains to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Domains",
                  "type": "array"
                },
                "ipAddresses": {
                  "description": "A list of ip addresses to check",
                  "items": {
                    "$ref": "#/definitions/ipAddress"
                  },
                  "order": 3,
                  "title": "IpAddresses",
                  "type": "array"
                },
                "processes": {
                  "description": "A list of processes to check",
                  "items": {
                    "$ref": "#/definitions/process"
                  },
                  "order": 4,
                  "title": "Processes",
                  "type": "array"
                },
                "urls": {
                  "description": "A list of URLs to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Urls",
                  "type": "array"
                }
              },
              "title": "Content",
              "type": "object"
            },
            "hash": {
              "properties": {
                "hash": {
                  "description": "The actual hash",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                },
                "type": {
                  "description": "The algorithm used to generate the hash",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "hash",
                "type"
              ],
              "title": "Hash",
              "type": "object"
            },
            "ipAddress": {
              "properties": {
                "ip": {
                  "description": "The raw IP",
                  "order": 1,
                  "title": "Ip",
                  "type": "string"
                },
                "type": {
                  "description": "Denotes if an IP is internal or external",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "ip",
                "type"
              ],
              "title": "IpAddress",
              "type": "object"
            },
            "process": {
              "properties": {
                "assetId": {
                  "description": "The asset id associated with the process",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "cmdLine": {
                  "description": "The raw value of the command line call used to invoke the process",
                  "order": 5,
                  "title": "CmdLine",
                  "type": "string"
                },
                "hashes": {
                  "description": "The list of hashes to check",
                  "items": {
                    "$ref": "#/definitions/hash"
                  },
                  "order": 3,
                  "title": "Hashes",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the process",
                  "order": 4,
                  "title": "Name",
                  "type": "string"
                },
                "processId": {
                  "description": "The PID from the running process on the asset",
                  "order": 2,
                  "title": "ProcessId",
                  "type": "integer"
                }
              },
              "required": [
                "assetId",
                "processId"
              ],
              "title": "Process",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 7,
              "title": "Actors"
            },
            "contents": {
              "$ref": "#/definitions/content",
              "description": "The contents to enrich",
              "order": 8,
              "title": "Contents"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The investigation id",
              "order": 6,
              "title": "InvestigationId",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "investigationId",
            "actors",
            "timestamp",
            "type",
            "name",
            "description",
            "link"
          ],
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_api_idr"
      }
    ]
  }
}
