{
  "kom": {
    "komandVersion": "1.47.8-0-gaccae",
    "komFileVersion": "2.0.0",
    "exportedAt": "2020-03-31T00:39:16.916875188Z",
    "workflowVersions": [
      {
        "name": "InsightIDR Impossible Location with Slack Chatbot",
        "type": "runnable",
        "version": "",
        "description": "This workflow automates the process of enriching IPs associated with an InsightIDR alert and escalating to the security team if found to be suspicious. Based off of the incident responders decision submitted to the Slack chatbot, the workflow will then block traffic by updating Palo Alto Policies with the new address.",
        "graph": {
          "edges": {
            "20dcf027-32c3-4d2f-9e14-f75f43bac802": {
              "id": "20dcf027-32c3-4d2f-9e14-f75f43bac802",
              "name": "Outside of US",
              "description": "Confirm location - Outside of US",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "e335a1b4-2374-4fb8-b034-41ba4e5e4888",
              "toNodeId": "373d1431-72bc-46f8-aee0-16c684831b59"
            },
            "2f30610a-03f5-4d3b-b353-84e2d5ad54d2": {
              "id": "2f30610a-03f5-4d3b-b353-84e2d5ad54d2",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "c5284e9a-11ff-4d58-80e6-a45fcdf6efbe",
              "toNodeId": "af16772b-d754-4005-9b8e-5f86fff16701"
            },
            "306976aa-b477-4b28-a77b-0ac8d22dacfc": {
              "id": "306976aa-b477-4b28-a77b-0ac8d22dacfc",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "toNodeId": "fad4a052-fe38-4c97-ac7a-6f1de74fd6a9"
            },
            "348be0f1-7cd6-42aa-8d26-fd29d3ac49b6": {
              "id": "348be0f1-7cd6-42aa-8d26-fd29d3ac49b6",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "toNodeId": ""
            },
            "4512de7f-4ea9-43c5-96f9-92e751c4d8d3": {
              "id": "4512de7f-4ea9-43c5-96f9-92e751c4d8d3",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "77a8d19e-2896-4007-8d10-9c527f39d080",
              "toNodeId": ""
            },
            "519ef68c-54a1-4505-be5e-0fb216803a0d": {
              "id": "519ef68c-54a1-4505-be5e-0fb216803a0d",
              "name": "Not",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "0bef02d0-9afd-45a1-8cd3-c35c0403b8f1",
              "toNodeId": ""
            },
            "58318694-fe6b-49b1-a7a5-1408773a91d1": {
              "id": "58318694-fe6b-49b1-a7a5-1408773a91d1",
              "name": "Success",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "0bef02d0-9afd-45a1-8cd3-c35c0403b8f1",
              "toNodeId": "a65e5a64-f119-498c-9ee8-88c7c24dd435"
            },
            "6161b812-e4d1-4817-aa76-056cf0ea292c": {
              "id": "6161b812-e4d1-4817-aa76-056cf0ea292c",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "f22f9c38-cef8-4286-a747-6c4b84836b83",
              "toNodeId": "0bef02d0-9afd-45a1-8cd3-c35c0403b8f1"
            },
            "6726f981-0d77-4d52-acac-b110ce4fb235": {
              "id": "6726f981-0d77-4d52-acac-b110ce4fb235",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "373d1431-72bc-46f8-aee0-16c684831b59",
              "toNodeId": "c5284e9a-11ff-4d58-80e6-a45fcdf6efbe"
            },
            "68b14194-f043-4174-b7b6-d4e54281f522": {
              "id": "68b14194-f043-4174-b7b6-d4e54281f522",
              "name": "Known Malicious",
              "description": "Confirmed Malicious",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "8f130958-e595-4195-ae3e-ea942286539f",
              "toNodeId": "350f5810-d5e9-4253-9eeb-70be1f1685c3"
            },
            "72b271d5-a2f1-4238-a196-d51a0a87965e": {
              "id": "72b271d5-a2f1-4238-a196-d51a0a87965e",
              "name": "Block in Palo Alto",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "ac1bb884-eef4-432d-be92-160672da72e4",
              "toNodeId": "ea71c413-b9fc-48ce-b70c-9adb492b5c4a"
            },
            "7abe00b4-1958-449c-965a-d6ce22f7e0d9": {
              "id": "7abe00b4-1958-449c-965a-d6ce22f7e0d9",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "72df78cb-6afb-4210-b0a9-df6b348e9d6d",
              "toNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "8e77c29d-bb4f-4f9e-8a8c-01c0a7f3691a": {
              "id": "8e77c29d-bb4f-4f9e-8a8c-01c0a7f3691a",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "3b7856ab-fe8d-4834-b289-6916e3b497e2",
              "toNodeId": ""
            },
            "ab71172f-acc3-4375-a619-5fd28436f3eb": {
              "id": "ab71172f-acc3-4375-a619-5fd28436f3eb",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "a65e5a64-f119-498c-9ee8-88c7c24dd435",
              "toNodeId": "bc351a86-8f99-4325-8295-abe2d9e7d707"
            },
            "af6b7602-b5c3-42c3-a70d-c159bed73fea": {
              "id": "af6b7602-b5c3-42c3-a70d-c159bed73fea",
              "name": "Not Malicious",
              "description": "Not Malicious",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "8f130958-e595-4195-ae3e-ea942286539f",
              "toNodeId": "301ca379-208f-4ebc-8282-544f1e45403c"
            },
            "b1ef4cdf-22e4-4927-91c9-bc94314c3c57": {
              "id": "b1ef4cdf-22e4-4927-91c9-bc94314c3c57",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "350f5810-d5e9-4253-9eeb-70be1f1685c3",
              "toNodeId": "ac1bb884-eef4-432d-be92-160672da72e4"
            },
            "b2f23a35-2b96-4a46-aef9-b4e907b43d75": {
              "id": "b2f23a35-2b96-4a46-aef9-b4e907b43d75",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "bc351a86-8f99-4325-8295-abe2d9e7d707",
              "toNodeId": ""
            },
            "b756530d-62fa-4f67-8e2f-16a7711cc4c5": {
              "id": "b756530d-62fa-4f67-8e2f-16a7711cc4c5",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "fad4a052-fe38-4c97-ac7a-6f1de74fd6a9",
              "toNodeId": "fab3f75d-17d8-46b4-bed5-a55a043813d3"
            },
            "cb4b1f91-ba8b-465d-a062-ea13d89881da": {
              "id": "cb4b1f91-ba8b-465d-a062-ea13d89881da",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8fb69bee-42ce-4260-8026-333a73099d41",
              "toNodeId": "72df78cb-6afb-4210-b0a9-df6b348e9d6d"
            },
            "d48624b7-c326-4ccd-a0c0-6414cb6181aa": {
              "id": "d48624b7-c326-4ccd-a0c0-6414cb6181aa",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "ea71c413-b9fc-48ce-b70c-9adb492b5c4a",
              "toNodeId": "f22f9c38-cef8-4286-a747-6c4b84836b83"
            },
            "e3900c0e-9192-4e70-99f1-89acaa73e763": {
              "id": "e3900c0e-9192-4e70-99f1-89acaa73e763",
              "name": "Dismiss",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "ac1bb884-eef4-432d-be92-160672da72e4",
              "toNodeId": "3b7856ab-fe8d-4834-b289-6916e3b497e2"
            },
            "e9366456-e066-4f99-a73a-452682e8948c": {
              "id": "e9366456-e066-4f99-a73a-452682e8948c",
              "name": "Nigeria",
              "description": "Confirm location - Hotspot",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "e335a1b4-2374-4fb8-b034-41ba4e5e4888",
              "toNodeId": "77a8d19e-2896-4007-8d10-9c527f39d080"
            },
            "ec8b4148-e84d-4979-820e-3b03a67601d1": {
              "id": "ec8b4148-e84d-4979-820e-3b03a67601d1",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "fab3f75d-17d8-46b4-bed5-a55a043813d3",
              "toNodeId": "e335a1b4-2374-4fb8-b034-41ba4e5e4888"
            },
            "ed891430-8bec-4ae2-865b-557bffebb4f3": {
              "id": "ed891430-8bec-4ae2-865b-557bffebb4f3",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "301ca379-208f-4ebc-8282-544f1e45403c",
              "toNodeId": ""
            },
            "ee99b6a7-c5e5-4a6b-893e-11a03e0a9091": {
              "id": "ee99b6a7-c5e5-4a6b-893e-11a03e0a9091",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "af16772b-d754-4005-9b8e-5f86fff16701",
              "toNodeId": "8f130958-e595-4195-ae3e-ea942286539f"
            }
          },
          "nodes": {
            "0bef02d0-9afd-45a1-8cd3-c35c0403b8f1": {
              "id": "0bef02d0-9afd-45a1-8cd3-c35c0403b8f1",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "301ca379-208f-4ebc-8282-544f1e45403c": {
              "id": "301ca379-208f-4ebc-8282-544f1e45403c",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "350f5810-d5e9-4253-9eeb-70be1f1685c3": {
              "id": "350f5810-d5e9-4253-9eeb-70be1f1685c3",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "373d1431-72bc-46f8-aee0-16c684831b59": {
              "id": "373d1431-72bc-46f8-aee0-16c684831b59",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "3b7856ab-fe8d-4834-b289-6916e3b497e2": {
              "id": "3b7856ab-fe8d-4834-b289-6916e3b497e2",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "6e6edb3d-28e5-4209-9a50-b0fe30066988": {
              "id": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "parentNodeId": ""
            },
            "72df78cb-6afb-4210-b0a9-df6b348e9d6d": {
              "id": "72df78cb-6afb-4210-b0a9-df6b348e9d6d",
              "parentNodeId": ""
            },
            "77a8d19e-2896-4007-8d10-9c527f39d080": {
              "id": "77a8d19e-2896-4007-8d10-9c527f39d080",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "8f130958-e595-4195-ae3e-ea942286539f": {
              "id": "8f130958-e595-4195-ae3e-ea942286539f",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "8fb69bee-42ce-4260-8026-333a73099d41": {
              "id": "8fb69bee-42ce-4260-8026-333a73099d41",
              "parentNodeId": ""
            },
            "a65e5a64-f119-498c-9ee8-88c7c24dd435": {
              "id": "a65e5a64-f119-498c-9ee8-88c7c24dd435",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "ac1bb884-eef4-432d-be92-160672da72e4": {
              "id": "ac1bb884-eef4-432d-be92-160672da72e4",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "af16772b-d754-4005-9b8e-5f86fff16701": {
              "id": "af16772b-d754-4005-9b8e-5f86fff16701",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "bc351a86-8f99-4325-8295-abe2d9e7d707": {
              "id": "bc351a86-8f99-4325-8295-abe2d9e7d707",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "c5284e9a-11ff-4d58-80e6-a45fcdf6efbe": {
              "id": "c5284e9a-11ff-4d58-80e6-a45fcdf6efbe",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "e335a1b4-2374-4fb8-b034-41ba4e5e4888": {
              "id": "e335a1b4-2374-4fb8-b034-41ba4e5e4888",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "ea71c413-b9fc-48ce-b70c-9adb492b5c4a": {
              "id": "ea71c413-b9fc-48ce-b70c-9adb492b5c4a",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "f22f9c38-cef8-4286-a747-6c4b84836b83": {
              "id": "f22f9c38-cef8-4286-a747-6c4b84836b83",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "fab3f75d-17d8-46b4-bed5-a55a043813d3": {
              "id": "fab3f75d-17d8-46b4-bed5-a55a043813d3",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "fad4a052-fe38-4c97-ac7a-6f1de74fd6a9": {
              "id": "fad4a052-fe38-4c97-ac7a-6f1de74fd6a9",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            }
          }
        },
        "steps": {
          "0bef02d0-9afd-45a1-8cd3-c35c0403b8f1": {
            "nodeId": "0bef02d0-9afd-45a1-8cd3-c35c0403b8f1",
            "name": "Successfully blocked",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "519ef68c-54a1-4505-be5e-0fb216803a0d",
              "stepControlParams": [
                {
                  "edgeId": "58318694-fe6b-49b1-a7a5-1408773a91d1",
                  "expression": {
                    "left": {
                      "left": {
                        "name": "f22f9c38-cef8-4286-a747-6c4b84836b83.$success",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": true
                      },
                      "type": "binary"
                    },
                    "op": "AND",
                    "right": {
                      "left": {
                        "name": "ea71c413-b9fc-48ce-b70c-9adb492b5c4a.$success",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": true
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[f22f9c38-cef8-4286-a747-6c4b84836b83].[$success]}}=true AND {{[ea71c413-b9fc-48ce-b70c-9adb492b5c4a].[$success]}}=true"
                },
                {
                  "edgeId": "519ef68c-54a1-4505-be5e-0fb216803a0d",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "301ca379-208f-4ebc-8282-544f1e45403c": {
            "nodeId": "301ca379-208f-4ebc-8282-544f1e45403c",
            "name": "Not Malicious",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Incident Breakdown\n## Address: {{[6e6edb3d-28e5-4209-9a50-b0fe30066988].[$item]}}\n___\n### IDR Alert Details\n\n## Alert\n{{#if [InsightIDR Event].[description]}}\nDescription: {{[InsightIDR Event].[description]}}\n{{/if}}\n{{#if [InsightIDR Event].[investigationId]}}\nInvestigation ID: {{[InsightIDR Event].[investigationId]}}\n{{/if}}\n{{#if [InsightIDR Event].[name]}}\nName: {{[InsightIDR Event].[name]}}\n{{/if}}\n{{#if [InsightIDR Event].[link]}}\nLink: [{{[InsightIDR Event].[link]}}]({{[InsightIDR Event].[link]}})\n{{/if}}\n{{#if [InsightIDR Event].[timestamp]}}\nTimestamp: {{[InsightIDR Event].[timestamp]}}\n{{/if}}\n{{#if [InsightIDR Event].[type]}}\nType: {{[InsightIDR Event].[type]}}\n{{/if}}\n{{#if [InsightIDR Event].[actors].[users]}}\n{{#each [InsightIDR Event].[actors].[users]}}\n{{#if distinguishedName}}\nActor Users: {{distinguishedName}}\n{{/if}}\n{{/each}}\n{{/if}}\n\n\n## VirusTotal Results\n\n{{[af16772b-d754-4005-9b8e-5f86fff16701].[report].[country]}}\n{{[af16772b-d754-4005-9b8e-5f86fff16701].[report].[verbose_msg]}}\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "350f5810-d5e9-4253-9eeb-70be1f1685c3": {
            "nodeId": "350f5810-d5e9-4253-9eeb-70be1f1685c3",
            "name": "Nasa Image",
            "type": "action",
            "plugin": {
              "name": "NASA",
              "slugVendor": "rapid7",
              "slugName": "nasa",
              "slugVersion": "1.0.2",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/nasa/1.0.2/icon.png"
            },
            "identifier": "get_image",
            "continueOnFailure": true,
            "isDisabled": false,
            "parameters": {
              "input": {
                "cloud_score": false,
                "date": "2014-03-01",
                "dimension": 0,
                "latitude": "{{[373d1431-72bc-46f8-aee0-16c684831b59].[output]}}",
                "longitude": "{{[c5284e9a-11ff-4d58-80e6-a45fcdf6efbe].[output]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "cloud_score": {
                  "default": false,
                  "description": "Calculate the percentage of the image covered by clouds",
                  "order": 5,
                  "title": "Cloud Score",
                  "type": "boolean"
                },
                "date": {
                  "description": "Date of image, optional, in YYYY-MM-DD format",
                  "order": 4,
                  "title": "Date",
                  "type": "string"
                },
                "dimension": {
                  "default": 0.1,
                  "description": "Width and height of image in degrees",
                  "order": 3,
                  "title": "Dimension",
                  "type": "number"
                },
                "latitude": {
                  "description": "Latitude",
                  "order": 1,
                  "title": "Latitude",
                  "type": "number"
                },
                "longitude": {
                  "description": "Longitude",
                  "order": 2,
                  "title": "Longitude",
                  "type": "number"
                }
              },
              "required": [
                "latitude",
                "longitude"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "resource": {
                  "properties": {
                    "dataset": {
                      "description": "Dataset",
                      "order": 2,
                      "title": "Dataset",
                      "type": "string"
                    },
                    "planet": {
                      "description": "Planet",
                      "order": 1,
                      "title": "Planet",
                      "type": "string"
                    }
                  },
                  "title": "Resource",
                  "type": "object"
                }
              },
              "properties": {
                "cloud_score": {
                  "description": "Cloud score",
                  "order": 4,
                  "title": "Cloud Score",
                  "type": "number"
                },
                "date": {
                  "description": "Date",
                  "order": 5,
                  "title": "Date",
                  "type": "string"
                },
                "id": {
                  "description": "Id",
                  "order": 6,
                  "title": "Id",
                  "type": "string"
                },
                "image": {
                  "description": "Base64 encoded image",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 7,
                  "title": "Image",
                  "type": "string"
                },
                "resource": {
                  "$ref": "#/definitions/resource",
                  "description": "Resource",
                  "order": 1,
                  "title": "Resource"
                },
                "service_version": {
                  "description": "Service version",
                  "order": 2,
                  "title": "Service Version",
                  "type": "string"
                },
                "url": {
                  "description": "URL",
                  "order": 3,
                  "title": "URL",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "373d1431-72bc-46f8-aee0-16c684831b59": {
            "nodeId": "373d1431-72bc-46f8-aee0-16c684831b59",
            "name": "Lat",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.5.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.5.1/icon.png"
            },
            "identifier": "string_to_float",
            "continueOnFailure": true,
            "isDisabled": false,
            "parameters": {
              "input": {
                "input": "{{[fad4a052-fe38-4c97-ac7a-6f1de74fd6a9].[latitude]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "input": {
                  "description": "Type converted input",
                  "order": 1,
                  "title": "Input",
                  "type": "string"
                }
              },
              "required": [
                "input"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "output": {
                  "description": "Type converted output",
                  "order": 1,
                  "title": "Output",
                  "type": "number"
                }
              },
              "required": [
                "output"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "3b7856ab-fe8d-4834-b289-6916e3b497e2": {
            "nodeId": "3b7856ab-fe8d-4834-b289-6916e3b497e2",
            "name": "Alert Summary",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "<img64:{{[350f5810-d5e9-4253-9eeb-70be1f1685c3].[image]}}/>\n## Address: {{[6e6edb3d-28e5-4209-9a50-b0fe30066988].[$item]}}\n___\n\n# Incident Breakdown\n\n## Alert\n{{#if [InsightIDR Event].[description]}}\nDescription: {{[InsightIDR Event].[description]}}\n{{/if}}\n{{#if [InsightIDR Event].[investigationId]}}\nInvestigation ID: {{[InsightIDR Event].[investigationId]}}\n{{/if}}\n{{#if [InsightIDR Event].[name]}}\nName: {{[InsightIDR Event].[name]}}\n{{/if}}\n{{#if [InsightIDR Event].[link]}}\nLink: [{{[InsightIDR Event].[link]}}]({{[InsightIDR Event].[link]}})\n{{/if}}\n{{#if [InsightIDR Event].[timestamp]}}\nTimestamp: {{[InsightIDR Event].[timestamp]}}\n{{/if}}\n{{#if [InsightIDR Event].[type]}}\nType: {{[InsightIDR Event].[type]}}\n{{/if}}\n{{#if [InsightIDR Event].[actors].[users]}}\n{{#each [InsightIDR Event].[actors].[users]}}\n{{#if distinguishedName}}\nActor Users: {{distinguishedName}}\n{{/if}}\n{{/each}}\n{{/if}}\n\n\n## VirusTotal Results\n\n{{[af16772b-d754-4005-9b8e-5f86fff16701].[report].[country]}}\n{{[af16772b-d754-4005-9b8e-5f86fff16701].[report].[verbose_msg]}}\n\n### WhoIs Location Results\n\n#### Country: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[country]}}\n#### State: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[state]}}\n#### City: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[city]}}\n#### Org Registered: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[orgname]}}\n\n### IPStack Location Results\n\n#### Country: {{[fad4a052-fe38-4c97-ac7a-6f1de74fd6a9].[country_name]}}\n#### City: {{[fad4a052-fe38-4c97-ac7a-6f1de74fd6a9].[city]}}\n#### Address: {{[fad4a052-fe38-4c97-ac7a-6f1de74fd6a9].[address]}}\n\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "6e6edb3d-28e5-4209-9a50-b0fe30066988": {
            "nodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
            "name": "IP Lookp",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "innerEdgeId": "306976aa-b477-4b28-a77b-0ac8d22dacfc",
              "nextEdgeId": "348be0f1-7cd6-42aa-8d26-fd29d3ac49b6",
              "repeatVariable": "{{[72df78cb-6afb-4210-b0a9-df6b348e9d6d].[IP]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "72df78cb-6afb-4210-b0a9-df6b348e9d6d": {
            "nodeId": "72df78cb-6afb-4210-b0a9-df6b348e9d6d",
            "name": "IPExtraction",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": true,
              "expressionText": "{{IP:/\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}/}}",
              "expressions": [
                {
                  "type": "variable",
                  "value": {
                    "ident": "IP",
                    "regex": "\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}"
                  }
                }
              ],
              "ignoreCase": true,
              "input": "{{[8fb69bee-42ce-4260-8026-333a73099d41].[description]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "77a8d19e-2896-4007-8d10-9c527f39d080": {
            "nodeId": "77a8d19e-2896-4007-8d10-9c527f39d080",
            "name": "Escalate to Security",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "*IP from Nigeria detected in InsightDR Alert*\n\n{{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[city]}}\n{{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[country]}}\n{{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[orgname]}}\n{{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[netrange]}}",
                "recipient": "#slack-secops",
                "thread_ts": ""
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see https://api.slack.com/docs/message-attachments (Advanced)",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "8f130958-e595-4195-ae3e-ea942286539f": {
            "nodeId": "8f130958-e595-4195-ae3e-ea942286539f",
            "name": "Malicious",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "af6b7602-b5c3-42c3-a70d-c159bed73fea",
              "stepControlParams": [
                {
                  "edgeId": "68b14194-f043-4174-b7b6-d4e54281f522",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "af16772b-d754-4005-9b8e-5f86fff16701.report",
                          "type": "variable"
                        }
                      ],
                      "name": "is_defined",
                      "type": "function"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "is_defined({{[af16772b-d754-4005-9b8e-5f86fff16701].[report]}})=true"
                },
                {
                  "edgeId": "af6b7602-b5c3-42c3-a70d-c159bed73fea",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "8fb69bee-42ce-4260-8026-333a73099d41": {
            "nodeId": "8fb69bee-42ce-4260-8026-333a73099d41",
            "name": "IDR - Impossible Location",
            "type": "trigger",
            "continueOnFailure": false,
            "isDisabled": false,
            "triggerId": "3cb69c96-c26c-40eb-a2e0-c48da963aa93",
            "defaultInputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 2,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 1,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 6,
                  "title": "Actors"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The unique identifier of the investigation",
                  "order": 7,
                  "title": "Investigation ID",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 2,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 1,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 6,
                  "title": "Actors"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The unique identifier of the investigation",
                  "order": 7,
                  "title": "Investigation ID",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/trigger-api-idr.svg",
            "connectionType": "NONE"
          },
          "a65e5a64-f119-498c-9ee8-88c7c24dd435": {
            "nodeId": "a65e5a64-f119-498c-9ee8-88c7c24dd435",
            "name": "Success update",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "{{[6e6edb3d-28e5-4209-9a50-b0fe30066988].[$item]}} successfully blocked",
                "recipient": "#slack-secops",
                "thread_ts": "{{[ac1bb884-eef4-432d-be92-160672da72e4].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see https://api.slack.com/docs/message-attachments (Advanced)",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "ac1bb884-eef4-432d-be92-160672da72e4": {
            "nodeId": "ac1bb884-eef4-432d-be92-160672da72e4",
            "name": "Slack Decision",
            "type": "decision_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "attachments": null,
              "message": "WhoIs Location Results\n\nCountry: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[country]}}\nState: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[state]}}\nCity: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[city]}}\nOrg Registered: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[orgname]}}\n___\n IPStack Location Results\n\nCountry: {{[fad4a052-fe38-4c97-ac7a-6f1de74fd6a9].[country_name]}}\nCity: {{[fad4a052-fe38-4c97-ac7a-6f1de74fd6a9].[city]}}\nAddress: {{[fad4a052-fe38-4c97-ac7a-6f1de74fd6a9].[address]}}\n\n___\n VirusTotal IP Report\n\n{{[af16772b-d754-4005-9b8e-5f86fff16701].[report].[0].[positives]}}",
              "messageType": "button",
              "options": [
                {
                  "answer": "Block in Palo Alto",
                  "buttonStyle": "default",
                  "confirmation": "...",
                  "edgeId": "72b271d5-a2f1-4238-a196-d51a0a87965e",
                  "isTimeoutOnly": false
                },
                {
                  "answer": "Dismiss",
                  "buttonStyle": "default",
                  "confirmation": "...",
                  "edgeId": "e3900c0e-9192-4e70-99f1-89acaa73e763",
                  "isTimeoutOnly": false
                }
              ],
              "question": "How would you like to respond?",
              "recipient": "#slack-secops",
              "timeout": 600,
              "timeoutDisplayUnit": "minutes",
              "timeoutEdgeId": "e3900c0e-9192-4e70-99f1-89acaa73e763"
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see https://api.slack.com/docs/message-attachments (Advanced)",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 3,
                  "title": "Attachments",
                  "type": "string"
                },
                "message": {
                  "description": "Message to send",
                  "order": 1,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "A channel (e.g. #channel) or username",
                  "order": 2,
                  "title": "Recipient",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "$success": {
                  "description": "",
                  "order": 8,
                  "title": "$success",
                  "type": "boolean"
                },
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "message": {
                  "description": "The message that was sent to slack",
                  "order": 4,
                  "title": "Message",
                  "type": "string"
                },
                "path": {
                  "description": "The path taken",
                  "order": 6,
                  "title": "Path",
                  "type": "string"
                },
                "recipient": {
                  "description": "The Channel name or User Name",
                  "order": 3,
                  "title": "Recipient",
                  "type": "string"
                },
                "responding_user": {
                  "description": "The slack username of the user responding to the question",
                  "order": 7,
                  "title": "Response Question",
                  "type": "string"
                },
                "response_question": {
                  "description": "The response question that was sent to slack",
                  "order": 5,
                  "title": "Response Question",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_interactive_message"
          },
          "af16772b-d754-4005-9b8e-5f86fff16701": {
            "nodeId": "af16772b-d754-4005-9b8e-5f86fff16701",
            "name": "VirusTotal Enrichment",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "6.0.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/6.0.0/icon.png"
            },
            "identifier": "ip_address_report",
            "continueOnFailure": true,
            "isDisabled": false,
            "parameters": {
              "input": {
                "address": "{{[6e6edb3d-28e5-4209-9a50-b0fe30066988].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "IP address",
                  "order": 1,
                  "title": "IP Address",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "detected_url": {
                  "properties": {
                    "positives": {
                      "description": "Positives",
                      "order": 2,
                      "title": "Positives",
                      "type": "integer"
                    },
                    "scan_date": {
                      "description": "Date the URL was scanned",
                      "order": 4,
                      "title": "Scan Date",
                      "type": "string"
                    },
                    "total": {
                      "description": "Total scan engines that found the URL malicious",
                      "order": 3,
                      "title": "Total",
                      "type": "integer"
                    },
                    "url": {
                      "description": "URL",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    }
                  },
                  "title": "Detected Url",
                  "type": "object"
                },
                "ip_report": {
                  "properties": {
                    "as_owner": {
                      "description": "As owner",
                      "order": 9,
                      "title": "As Owner",
                      "type": "string"
                    },
                    "asn": {
                      "description": "Autonomous system number",
                      "order": 5,
                      "title": "ASN",
                      "type": "integer"
                    },
                    "country": {
                      "description": "Country",
                      "order": 11,
                      "title": "Country",
                      "type": "string"
                    },
                    "detected_communicating_samples": {
                      "description": "Detected communicating samples",
                      "items": {
                        "$ref": "#/definitions/samples"
                      },
                      "order": 13,
                      "title": "Detected Communicating Samples",
                      "type": "array"
                    },
                    "detected_downloaded_samples": {
                      "description": "Detected downloaded samples",
                      "items": {
                        "$ref": "#/definitions/samples"
                      },
                      "order": 8,
                      "title": "Detected Downloaded Samples",
                      "type": "array"
                    },
                    "detected_referrer_samples": {
                      "description": "Detected referrer samples",
                      "items": {
                        "$ref": "#/definitions/samples"
                      },
                      "order": 10,
                      "title": "Detected Referrer Samples",
                      "type": "array"
                    },
                    "detected_urls": {
                      "description": "Collection of detected URLs and information about them",
                      "items": {
                        "$ref": "#/definitions/detected_url"
                      },
                      "order": 4,
                      "title": "Detected URLs",
                      "type": "array"
                    },
                    "resolutions": {
                      "description": "Collection of historical hostnames resolved to the IP being reported on",
                      "items": {
                        "$ref": "#/definitions/ip_resolution"
                      },
                      "order": 3,
                      "title": "Resolutions",
                      "type": "array"
                    },
                    "response_code": {
                      "description": "Response code from the request",
                      "order": 1,
                      "title": "Response Code",
                      "type": "integer"
                    },
                    "undetected_communicating_samples": {
                      "description": "Undetected communication samples",
                      "items": {
                        "$ref": "#/definitions/samples"
                      },
                      "order": 14,
                      "title": "Undetected Communication Samples",
                      "type": "array"
                    },
                    "undetected_downloaded_samples": {
                      "description": "Undetected downloaded samples",
                      "items": {
                        "$ref": "#/definitions/samples"
                      },
                      "order": 7,
                      "title": "Undetected Downloaded Samples",
                      "type": "array"
                    },
                    "undetected_referrer_samples": {
                      "description": "Undetected referrer samples",
                      "items": {
                        "$ref": "#/definitions/referrer_samples"
                      },
                      "order": 12,
                      "title": "Undetected Referrer Samples",
                      "type": "array"
                    },
                    "undetected_urls": {
                      "description": "Undetected URLs",
                      "items": {},
                      "order": 6,
                      "title": "Undetected URLs",
                      "type": "array"
                    },
                    "verbose_msg": {
                      "description": "Verbose message from the request",
                      "order": 2,
                      "title": "Verbose Message",
                      "type": "string"
                    }
                  },
                  "title": "Ip Report",
                  "type": "object"
                },
                "ip_resolution": {
                  "properties": {
                    "hostname": {
                      "description": "Hostname of the IP at the time it was resolved",
                      "order": 2,
                      "title": "Hostname",
                      "type": "string"
                    },
                    "last_resolved": {
                      "description": "Datetime of when the IP was last resolved",
                      "order": 1,
                      "title": "Last Resolved",
                      "type": "string"
                    }
                  },
                  "title": "Ip Resolution",
                  "type": "object"
                },
                "referrer_samples": {
                  "properties": {
                    "positives": {
                      "description": "Positives",
                      "order": 1,
                      "title": "Positives",
                      "type": "integer"
                    },
                    "sha256": {
                      "description": "SHA256 hash",
                      "order": 2,
                      "title": "SHA256",
                      "type": "string"
                    },
                    "total": {
                      "description": "Total",
                      "order": 3,
                      "title": "Total",
                      "type": "integer"
                    }
                  },
                  "title": "Referrer Samples",
                  "type": "object"
                },
                "samples": {
                  "properties": {
                    "date": {
                      "description": "Date",
                      "order": 1,
                      "title": "Date",
                      "type": "string"
                    },
                    "positives": {
                      "description": "Positives",
                      "order": 2,
                      "title": "Positives",
                      "type": "integer"
                    },
                    "sha256": {
                      "description": "SHA256 hash",
                      "order": 4,
                      "title": "SHA256",
                      "type": "string"
                    },
                    "total": {
                      "description": "Total",
                      "order": 3,
                      "title": "Total",
                      "type": "integer"
                    }
                  },
                  "title": "Samples",
                  "type": "object"
                }
              },
              "properties": {
                "report": {
                  "$ref": "#/definitions/ip_report",
                  "description": "IP address report",
                  "order": 1,
                  "title": "Report"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "bc351a86-8f99-4325-8295-abe2d9e7d707": {
            "nodeId": "bc351a86-8f99-4325-8295-abe2d9e7d707",
            "name": "Incident Summary",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "<img64:{{[350f5810-d5e9-4253-9eeb-70be1f1685c3].[image]}}/>\n## Address: {{[6e6edb3d-28e5-4209-9a50-b0fe30066988].[$item]}}\n___\n\n# Incident Breakdown\n\n## Alert\n{{#if [InsightIDR Event].[description]}}\nDescription: {{[InsightIDR Event].[description]}}\n{{/if}}\n{{#if [InsightIDR Event].[investigationId]}}\nInvestigation ID: {{[InsightIDR Event].[investigationId]}}\n{{/if}}\n{{#if [InsightIDR Event].[name]}}\nName: {{[InsightIDR Event].[name]}}\n{{/if}}\n{{#if [InsightIDR Event].[link]}}\nLink: [{{[InsightIDR Event].[link]}}]({{[InsightIDR Event].[link]}})\n{{/if}}\n{{#if [InsightIDR Event].[timestamp]}}\nTimestamp: {{[InsightIDR Event].[timestamp]}}\n{{/if}}\n{{#if [InsightIDR Event].[type]}}\nType: {{[InsightIDR Event].[type]}}\n{{/if}}\n{{#if [InsightIDR Event].[actors].[users]}}\n{{#each [InsightIDR Event].[actors].[users]}}\n{{#if distinguishedName}}\nActor Users: {{distinguishedName}}\n{{/if}}\n{{/each}}\n{{/if}}\n\n\n## VirusTotal Results\n\n{{[af16772b-d754-4005-9b8e-5f86fff16701].[report].[country]}}\n{{[af16772b-d754-4005-9b8e-5f86fff16701].[report].[verbose_msg]}}\n\n### WhoIs Location Results\n\n#### Country: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[country]}}\n#### State: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[state]}}\n#### City: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[city]}}\n#### Org Registered: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[orgname]}}\n\n### IPStack Location Results\n\n#### Country: {{[fad4a052-fe38-4c97-ac7a-6f1de74fd6a9].[country_name]}}\n#### City: {{[fad4a052-fe38-4c97-ac7a-6f1de74fd6a9].[city]}}\n#### Address: {{[fad4a052-fe38-4c97-ac7a-6f1de74fd6a9].[address]}}\n\n\n## Block Status on {{[6e6edb3d-28e5-4209-9a50-b0fe30066988].[$item]}}\n### PAN-OS: {{[ea71c413-b9fc-48ce-b70c-9adb492b5c4a].[status]}}\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "c5284e9a-11ff-4d58-80e6-a45fcdf6efbe": {
            "nodeId": "c5284e9a-11ff-4d58-80e6-a45fcdf6efbe",
            "name": "Long",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.5.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.5.1/icon.png"
            },
            "identifier": "string_to_float",
            "continueOnFailure": true,
            "isDisabled": false,
            "parameters": {
              "input": {
                "input": "{{[fad4a052-fe38-4c97-ac7a-6f1de74fd6a9].[longitude]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "input": {
                  "description": "Type converted input",
                  "order": 1,
                  "title": "Input",
                  "type": "string"
                }
              },
              "required": [
                "input"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "output": {
                  "description": "Type converted output",
                  "order": 1,
                  "title": "Output",
                  "type": "number"
                }
              },
              "required": [
                "output"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "e335a1b4-2374-4fb8-b034-41ba4e5e4888": {
            "nodeId": "e335a1b4-2374-4fb8-b034-41ba4e5e4888",
            "name": "Location",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "20dcf027-32c3-4d2f-9e14-f75f43bac802",
              "stepControlParams": [
                {
                  "edgeId": "20dcf027-32c3-4d2f-9e14-f75f43bac802",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "e9366456-e066-4f99-a73a-452682e8948c",
                  "expression": {
                    "left": {
                      "name": "fab3f75d-17d8-46b4-bed5-a55a043813d3.country",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": "NI"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[country]}} = \"NI\""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "ea71c413-b9fc-48ce-b70c-9adb492b5c4a": {
            "nodeId": "ea71c413-b9fc-48ce-b70c-9adb492b5c4a",
            "name": "Block Outbound",
            "type": "action",
            "plugin": {
              "name": "Palo Alto PAN-OS",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_pan_os",
              "slugVersion": "1.5.6",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_pan_os/1.5.6/icon.png"
            },
            "identifier": "add_to_policy",
            "continueOnFailure": true,
            "isDisabled": false,
            "parameters": {
              "input": {
                "action": "",
                "application": "",
                "destination": "{{[6e6edb3d-28e5-4209-9a50-b0fe30066988].[$item]}}",
                "dst_zone": "",
                "hip_profiles": "",
                "rule_name": "insightConnect-default",
                "service": "",
                "source": "any",
                "source_user": "",
                "src_zone": "",
                "update_active_or_candidate_configuration": "active",
                "url_category": ""
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "action": {
                  "description": "Action that will occur if an event meets the rule definitions",
                  "order": 12,
                  "title": "Action",
                  "type": "string"
                },
                "application": {
                  "description": "Application for which this rule will be applied e.g. adobe-cloud, dropbox, or  any",
                  "order": 6,
                  "title": "Application",
                  "type": "string"
                },
                "destination": {
                  "description": "A destination for which this rule will be applied e.g. 10.0.0.1, computername, or any",
                  "order": 4,
                  "title": "Destination",
                  "type": "string"
                },
                "dst_zone": {
                  "description": "Zone which the traffic is going to e.g. server zone, or any",
                  "order": 9,
                  "title": "DST Zone",
                  "type": "string"
                },
                "hip_profiles": {
                  "description": "Host information profile",
                  "order": 11,
                  "title": "HIP Profiles",
                  "type": "string"
                },
                "rule_name": {
                  "description": "Name of the rule",
                  "order": 1,
                  "title": "Rule Name",
                  "type": "string"
                },
                "service": {
                  "description": "Service type for which this rule will be applied e.g. HTTP, HTTPS, or any",
                  "order": 5,
                  "title": "Service",
                  "type": "string"
                },
                "source": {
                  "description": "A source for which this rule will be applied e.g. 10.0.0.1, computername, or any",
                  "order": 3,
                  "title": "Source",
                  "type": "string"
                },
                "source_user": {
                  "description": "User that the network traffic originated from e.g. Joe Smith, or any",
                  "order": 7,
                  "title": "Source User",
                  "type": "string"
                },
                "src_zone": {
                  "description": "Zone in which the traffic originated e.g. server zone, or any",
                  "order": 8,
                  "title": "SRC Zone",
                  "type": "string"
                },
                "update_active_or_candidate_configuration": {
                  "description": "Will apply the update to the active or candidate configuration. If active is chosen any uncommitted candidate configuration will be lost",
                  "enum": [
                    "active",
                    "candidate"
                  ],
                  "order": 2,
                  "title": "Update Active or Candidate Configuration",
                  "type": "string"
                },
                "url_category": {
                  "description": "The URL category e.g. adult",
                  "order": 10,
                  "title": "URL Category",
                  "type": "string"
                }
              },
              "required": [
                "update_active_or_candidate_configuration",
                "rule_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "code": {
                  "description": "Response code from PAN-OS",
                  "order": 2,
                  "title": "Code",
                  "type": "string"
                },
                "message": {
                  "description": "A message with more detail about the status",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "status": {
                  "description": "Status of the requested operation e.g. success, error, etc",
                  "order": 1,
                  "title": "Status",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "f22f9c38-cef8-4286-a747-6c4b84836b83": {
            "nodeId": "f22f9c38-cef8-4286-a747-6c4b84836b83",
            "name": "Block Inbound",
            "type": "action",
            "plugin": {
              "name": "Palo Alto PAN-OS",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_pan_os",
              "slugVersion": "1.5.6",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_pan_os/1.5.6/icon.png"
            },
            "identifier": "add_to_policy",
            "continueOnFailure": true,
            "isDisabled": false,
            "parameters": {
              "input": {
                "action": "",
                "application": "",
                "destination": "any",
                "dst_zone": "",
                "hip_profiles": "",
                "rule_name": "insightConnect-default",
                "service": "",
                "source": "{{[6e6edb3d-28e5-4209-9a50-b0fe30066988].[$item]}}",
                "source_user": "",
                "src_zone": "",
                "update_active_or_candidate_configuration": "active",
                "url_category": ""
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "action": {
                  "description": "Action that will occur if an event meets the rule definitions",
                  "order": 12,
                  "title": "Action",
                  "type": "string"
                },
                "application": {
                  "description": "Application for which this rule will be applied e.g. adobe-cloud, dropbox, or  any",
                  "order": 6,
                  "title": "Application",
                  "type": "string"
                },
                "destination": {
                  "description": "A destination for which this rule will be applied e.g. 10.0.0.1, computername, or any",
                  "order": 4,
                  "title": "Destination",
                  "type": "string"
                },
                "dst_zone": {
                  "description": "Zone which the traffic is going to e.g. server zone, or any",
                  "order": 9,
                  "title": "DST Zone",
                  "type": "string"
                },
                "hip_profiles": {
                  "description": "Host information profile",
                  "order": 11,
                  "title": "HIP Profiles",
                  "type": "string"
                },
                "rule_name": {
                  "description": "Name of the rule",
                  "order": 1,
                  "title": "Rule Name",
                  "type": "string"
                },
                "service": {
                  "description": "Service type for which this rule will be applied e.g. HTTP, HTTPS, or any",
                  "order": 5,
                  "title": "Service",
                  "type": "string"
                },
                "source": {
                  "description": "A source for which this rule will be applied e.g. 10.0.0.1, computername, or any",
                  "order": 3,
                  "title": "Source",
                  "type": "string"
                },
                "source_user": {
                  "description": "User that the network traffic originated from e.g. Joe Smith, or any",
                  "order": 7,
                  "title": "Source User",
                  "type": "string"
                },
                "src_zone": {
                  "description": "Zone in which the traffic originated e.g. server zone, or any",
                  "order": 8,
                  "title": "SRC Zone",
                  "type": "string"
                },
                "update_active_or_candidate_configuration": {
                  "description": "Will apply the update to the active or candidate configuration. If active is chosen any uncommitted candidate configuration will be lost",
                  "enum": [
                    "active",
                    "candidate"
                  ],
                  "order": 2,
                  "title": "Update Active or Candidate Configuration",
                  "type": "string"
                },
                "url_category": {
                  "description": "The URL category e.g. adult",
                  "order": 10,
                  "title": "URL Category",
                  "type": "string"
                }
              },
              "required": [
                "update_active_or_candidate_configuration",
                "rule_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "code": {
                  "description": "Response code from PAN-OS",
                  "order": 2,
                  "title": "Code",
                  "type": "string"
                },
                "message": {
                  "description": "A message with more detail about the status",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "status": {
                  "description": "Status of the requested operation e.g. success, error, etc",
                  "order": 1,
                  "title": "Status",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "fab3f75d-17d8-46b4-bed5-a55a043813d3": {
            "nodeId": "fab3f75d-17d8-46b4-bed5-a55a043813d3",
            "name": "WhoIs Lookup",
            "type": "action",
            "plugin": {
              "name": "WHOIS",
              "slugVendor": "rapid7",
              "slugName": "whois",
              "slugVersion": "1.0.7",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/whois/1.0.7/icon.png"
            },
            "identifier": "address",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "address": "{{[6e6edb3d-28e5-4209-9a50-b0fe30066988].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "IP to Lookup",
                  "order": 1,
                  "title": "Address",
                  "type": "string"
                }
              },
              "required": [
                "address"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "address": {
                  "description": "Address",
                  "order": 9,
                  "title": "Address",
                  "type": "string"
                },
                "cidr": {
                  "description": "CIDR",
                  "order": 4,
                  "title": "CIDR",
                  "type": "string"
                },
                "city": {
                  "description": "City",
                  "order": 10,
                  "title": "City",
                  "type": "string"
                },
                "country": {
                  "description": "Country",
                  "order": 13,
                  "title": "Country",
                  "type": "string"
                },
                "netname": {
                  "description": "Network name",
                  "order": 1,
                  "title": "Network Name",
                  "type": "string"
                },
                "netrange": {
                  "description": "Network Range",
                  "order": 3,
                  "title": "Network Range",
                  "type": "string"
                },
                "nettype": {
                  "description": "Network type",
                  "order": 2,
                  "title": "Network Type",
                  "type": "string"
                },
                "org_abuse_email": {
                  "description": "Organization abuse e-mail",
                  "order": 14,
                  "title": "Organization Abuse E-mail",
                  "type": "string"
                },
                "org_abuse_phone": {
                  "description": "Organization abuse phone",
                  "order": 15,
                  "title": "Organization Abuse Phone",
                  "type": "string"
                },
                "org_tech_email": {
                  "description": "Organization tech e-mail",
                  "order": 16,
                  "title": "Organization Tech E-mail",
                  "type": "string"
                },
                "org_tech_phone": {
                  "description": "Organization tech phone",
                  "order": 17,
                  "title": "Organization Tech Phone",
                  "type": "string"
                },
                "organization": {
                  "description": "Organization",
                  "order": 5,
                  "title": "Organization",
                  "type": "string"
                },
                "orgname": {
                  "description": "Organization name",
                  "order": 6,
                  "title": "Organization Name",
                  "type": "string"
                },
                "postal": {
                  "description": "Postal",
                  "order": 11,
                  "title": "Postal",
                  "type": "string"
                },
                "regdate": {
                  "description": "Registration date",
                  "order": 7,
                  "title": "Registration Date",
                  "type": "string"
                },
                "state": {
                  "description": "State",
                  "order": 12,
                  "title": "State",
                  "type": "string"
                },
                "update": {
                  "description": "WHOIS updated date",
                  "order": 8,
                  "title": "WHOIS Updated Date",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "fad4a052-fe38-4c97-ac7a-6f1de74fd6a9": {
            "nodeId": "fad4a052-fe38-4c97-ac7a-6f1de74fd6a9",
            "name": "IPStack",
            "type": "action",
            "plugin": {
              "name": "IPStack",
              "slugVendor": "rapid7",
              "slugName": "ipstack",
              "slugVersion": "1.0.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/ipstack/1.0.1/icon.png"
            },
            "identifier": "lookup",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "host": "{{[6e6edb3d-28e5-4209-9a50-b0fe30066988].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "host": {
                  "description": "Host to Lookup",
                  "order": 1,
                  "title": "Host",
                  "type": "string"
                }
              },
              "required": [
                "host"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "address": {
                  "description": "IP address",
                  "order": 1,
                  "title": "IP Address",
                  "type": "string"
                },
                "city": {
                  "description": "City",
                  "order": 2,
                  "title": "City",
                  "type": "string"
                },
                "country_code": {
                  "description": "Country code",
                  "order": 4,
                  "title": "Country Code",
                  "type": "string"
                },
                "country_name": {
                  "description": "Country name",
                  "order": 3,
                  "title": "Country Name",
                  "type": "string"
                },
                "latitude": {
                  "description": "Latitude",
                  "order": 5,
                  "title": "Latitude",
                  "type": "string"
                },
                "longitude": {
                  "description": "Longitude",
                  "order": 6,
                  "title": "Latitude",
                  "type": "string"
                },
                "metro_code": {
                  "description": "Metro code",
                  "order": 7,
                  "title": "Metro Code",
                  "type": "integer"
                },
                "region_code": {
                  "description": "Region code",
                  "order": 8,
                  "title": "Region Code",
                  "type": "string"
                },
                "region_name": {
                  "description": "Region name",
                  "order": 9,
                  "title": "Region Name",
                  "type": "string"
                },
                "time_zone": {
                  "description": "Time zone",
                  "order": 10,
                  "title": "Public IP Address in Decimal",
                  "type": "string"
                },
                "zip_code": {
                  "description": "ZIP code",
                  "order": 11,
                  "title": "ZIP Code",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          }
        },
        "tags": null,
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": ""
      }
    ],
    "triggers": [
      {
        "id": "3cb69c96-c26c-40eb-a2e0-c48da963aa93",
        "name": "IDR - Impossible Location",
        "description": "",
        "input": null,
        "inputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 2,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 1,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname"
              ],
              "title": "Asset",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 6,
              "title": "Actors"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The unique identifier of the investigation",
              "order": 7,
              "title": "Investigation ID",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 2,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 1,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname"
              ],
              "title": "Asset",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 6,
              "title": "Actors"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The unique identifier of the investigation",
              "order": 7,
              "title": "Investigation ID",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_api_idr"
      }
    ]
  }
}