# Description

Push new vulnerability exception requests to Microsoft Teams for visibility and notification. Vulnerability risk data, exclusion submitter comments, expiration dates, and more details are included in the Teams message to provide contextual details to the reviewer not available in the Vulnerability Exception Approval screen in the InsightVM Console.  Also provides an "auto-approve" facility to assist in approving low-risk vulnerability exception requests without human intervention.

Please note, this workflow does not currently trigger on a re-submission of an existing vulnerability exception. Processing of existing vulnerability exceptions should be handled within the InsightVM Vulnerability Exception Approval screen.

# Key Features

* Receive Teams messages immediately upon a user submitting a new vulnerability exception
* Review vulnerability exception details in a well-formatted Teams message
* Auto-approve vulnerabilities meeting maximum riskscore threshold

# Requirements

* [Teams](https://insightconnect.help.rapid7.com/docs/microsoft-teams)
* InsightVM or Nexpose

# Documentation

## Setup

Import the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.

After import, change the Team and channel parameters to a Team and channel of your choice. The workflow will post new vulnerability exception requests to this channel. Also adjust the `auto-threshold` parameter to indicate the maximum risk score for which vulnerability exception requests will be automatically approved. By default, this workflow will automatically approve vulnerability exception requests for vulnerabilities with a risk score equal to 0. To ensure no exception requests are approved automatically, set this value to a negative number (eg, -1).

Once your parameters have been saved, activate the workflow. It will trigger upon newly submitted vulnerability exception requests.

NOTE: This workflow will NOT trigger on *re*submitted exception requests at this time. Please rely on conventional methods, such as talking to each other, to manage resubmissions.

## Usage

This workflow will trigger automatically on new vulnerability exception requests in the InsightVM Console.

## Technical Details


|Plugin|Version|Count|
|----|----|--------|
|Rapid7 InsightVM|4.9.0|8|
|Microsoft Teams|3.1.2|4|

## Troubleshooting

_There is no troubleshooting information at this time_

# Version History

* 1.1.0 - Added parameters, removed unnecessary steps, udpated plugins
* 1.0.0 - Initial workflow

# Links

## References

* [Teams](https://www.microsoft.com/en-us/microsoft-365/microsoft-teams/group-chat-software)
