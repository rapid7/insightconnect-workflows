{
  "kom": {
    "komandVersion": "1.51.0-0-ge64bd",
    "komFileVersion": "2.0.0",
    "exportedAt": "2020-05-26T22:25:45.30138318Z",
    "workflowVersions": [
      {
        "name": "Check Host Block Status with Palo Alto Firewall from Microsoft Teams",
        "type": "runnable",
        "version": "",
        "description": "This workflow accepts a Microsoft Teams command containing an IP address. This IP address will be checked against a pre-defined address group in a Palo Alto firewall to determine if the IP address is present or not. It is assumed that this address group will be used to store IP addresses for a block policy. A message with the results will be returned.",
        "graph": {
          "edges": {
            "00f26916-43a3-418a-ab98-326391be9993": {
              "id": "00f26916-43a3-418a-ab98-326391be9993",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4448411f-10bf-4898-9b83-75555ce41c13",
              "toNodeId": "a8cb8116-fb29-42af-8c76-61bafea595b4"
            },
            "1c74ba92-5d6e-48db-9e2b-562a0d4cc026": {
              "id": "1c74ba92-5d6e-48db-9e2b-562a0d4cc026",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "c14619d0-89e1-440d-ae65-f85970c06e15",
              "toNodeId": "0fb40255-5bb0-4dee-8b74-7f3ac392bd7c"
            },
            "3292fd53-43d1-4460-b612-b85044c4c819": {
              "id": "3292fd53-43d1-4460-b612-b85044c4c819",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "0fb40255-5bb0-4dee-8b74-7f3ac392bd7c",
              "toNodeId": "1934a549-846f-4e68-b062-3d688e972ab2"
            },
            "355304b4-6277-4ffa-93b6-9a156dedc31c": {
              "id": "355304b4-6277-4ffa-93b6-9a156dedc31c",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "92405a43-74cc-4a86-aa1e-595b54f0f374",
              "toNodeId": ""
            },
            "766efd98-7cb1-40ad-a45e-ad0e3fd49485": {
              "id": "766efd98-7cb1-40ad-a45e-ad0e3fd49485",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4d650a86-639d-4f34-8920-52d3c954152b",
              "toNodeId": "4448411f-10bf-4898-9b83-75555ce41c13"
            },
            "7a188ee0-98bc-4945-b973-74e35f64b47d": {
              "id": "7a188ee0-98bc-4945-b973-74e35f64b47d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8300c579-8aeb-405b-ae13-3bea6c68eb7e",
              "toNodeId": ""
            },
            "8935f832-644a-432f-85d7-992b0061c594": {
              "id": "8935f832-644a-432f-85d7-992b0061c594",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "17ba3e71-3cbd-4995-a0d4-0c3b8974ef15",
              "toNodeId": "13b66114-3d09-471f-b6f1-c4f996bbfc31"
            },
            "8a364fc8-a042-41e6-93b5-f32a659d6bb3": {
              "id": "8a364fc8-a042-41e6-93b5-f32a659d6bb3",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "b5baf6db-0d7d-4fd7-b146-00925635c7f2",
              "toNodeId": "c14619d0-89e1-440d-ae65-f85970c06e15"
            },
            "abb87f31-e4e6-4120-bae7-5dceb3621d7e": {
              "id": "abb87f31-e4e6-4120-bae7-5dceb3621d7e",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "13b66114-3d09-471f-b6f1-c4f996bbfc31",
              "toNodeId": "8c18b523-d755-46d0-a37d-a3caf41e4b78"
            },
            "b5909a47-f97e-4ca1-93b7-7750509a046a": {
              "id": "b5909a47-f97e-4ca1-93b7-7750509a046a",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "95c927b8-9dba-4fb0-9c4c-882501926cea",
              "toNodeId": "92405a43-74cc-4a86-aa1e-595b54f0f374"
            },
            "d3975903-63fb-4a42-b31f-2844d304195a": {
              "id": "d3975903-63fb-4a42-b31f-2844d304195a",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a8cb8116-fb29-42af-8c76-61bafea595b4",
              "toNodeId": "b5baf6db-0d7d-4fd7-b146-00925635c7f2"
            },
            "e1d845ed-6ad1-493a-9275-a822cb4e6ba2": {
              "id": "e1d845ed-6ad1-493a-9275-a822cb4e6ba2",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "95c927b8-9dba-4fb0-9c4c-882501926cea",
              "toNodeId": "8300c579-8aeb-405b-ae13-3bea6c68eb7e"
            },
            "e44f72e2-4358-427e-9336-43968403c7a8": {
              "id": "e44f72e2-4358-427e-9336-43968403c7a8",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "1934a549-846f-4e68-b062-3d688e972ab2",
              "toNodeId": "83782ee6-5362-4b81-8902-9d4904c8ecd8"
            },
            "edf8af0b-8b05-4284-9d01-d32f451ae5e0": {
              "id": "edf8af0b-8b05-4284-9d01-d32f451ae5e0",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8c18b523-d755-46d0-a37d-a3caf41e4b78",
              "toNodeId": "95c927b8-9dba-4fb0-9c4c-882501926cea"
            },
            "f33fb385-16d8-46f8-9a1f-0ea5046a1898": {
              "id": "f33fb385-16d8-46f8-9a1f-0ea5046a1898",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "83782ee6-5362-4b81-8902-9d4904c8ecd8",
              "toNodeId": "17ba3e71-3cbd-4995-a0d4-0c3b8974ef15"
            }
          },
          "nodes": {
            "0fb40255-5bb0-4dee-8b74-7f3ac392bd7c": {
              "id": "0fb40255-5bb0-4dee-8b74-7f3ac392bd7c",
              "parentNodeId": ""
            },
            "13b66114-3d09-471f-b6f1-c4f996bbfc31": {
              "id": "13b66114-3d09-471f-b6f1-c4f996bbfc31",
              "parentNodeId": ""
            },
            "17ba3e71-3cbd-4995-a0d4-0c3b8974ef15": {
              "id": "17ba3e71-3cbd-4995-a0d4-0c3b8974ef15",
              "parentNodeId": ""
            },
            "1934a549-846f-4e68-b062-3d688e972ab2": {
              "id": "1934a549-846f-4e68-b062-3d688e972ab2",
              "parentNodeId": ""
            },
            "4448411f-10bf-4898-9b83-75555ce41c13": {
              "id": "4448411f-10bf-4898-9b83-75555ce41c13",
              "parentNodeId": ""
            },
            "4d650a86-639d-4f34-8920-52d3c954152b": {
              "id": "4d650a86-639d-4f34-8920-52d3c954152b",
              "parentNodeId": ""
            },
            "8300c579-8aeb-405b-ae13-3bea6c68eb7e": {
              "id": "8300c579-8aeb-405b-ae13-3bea6c68eb7e",
              "parentNodeId": ""
            },
            "83782ee6-5362-4b81-8902-9d4904c8ecd8": {
              "id": "83782ee6-5362-4b81-8902-9d4904c8ecd8",
              "parentNodeId": ""
            },
            "8c18b523-d755-46d0-a37d-a3caf41e4b78": {
              "id": "8c18b523-d755-46d0-a37d-a3caf41e4b78",
              "parentNodeId": ""
            },
            "92405a43-74cc-4a86-aa1e-595b54f0f374": {
              "id": "92405a43-74cc-4a86-aa1e-595b54f0f374",
              "parentNodeId": ""
            },
            "95c927b8-9dba-4fb0-9c4c-882501926cea": {
              "id": "95c927b8-9dba-4fb0-9c4c-882501926cea",
              "parentNodeId": ""
            },
            "a8cb8116-fb29-42af-8c76-61bafea595b4": {
              "id": "a8cb8116-fb29-42af-8c76-61bafea595b4",
              "parentNodeId": ""
            },
            "b5baf6db-0d7d-4fd7-b146-00925635c7f2": {
              "id": "b5baf6db-0d7d-4fd7-b146-00925635c7f2",
              "parentNodeId": ""
            },
            "c14619d0-89e1-440d-ae65-f85970c06e15": {
              "id": "c14619d0-89e1-440d-ae65-f85970c06e15",
              "parentNodeId": ""
            }
          }
        },
        "steps": {
          "0fb40255-5bb0-4dee-8b74-7f3ac392bd7c": {
            "nodeId": "0fb40255-5bb0-4dee-8b74-7f3ac392bd7c",
            "name": "Trim Host",
            "type": "action",
            "plugin": {
              "name": "String Operations",
              "slugVendor": "rapid7",
              "slugName": "string",
              "slugVersion": "1.2.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/string/1.2.1/icon.png"
            },
            "identifier": "trim",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "string": "{{[c14619d0-89e1-440d-ae65-f85970c06e15].[list].[1]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "string": {
                  "description": "String to trim",
                  "order": 1,
                  "title": "String Input",
                  "type": "string"
                }
              },
              "required": [
                "string"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "trimmed": {
                  "description": "Trimmed string",
                  "order": 1,
                  "title": "Trimmed",
                  "type": "string"
                }
              },
              "required": [
                "trimmed"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "13b66114-3d09-471f-b6f1-c4f996bbfc31": {
            "nodeId": "13b66114-3d09-471f-b6f1-c4f996bbfc31",
            "name": "Unblock Host Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Unblock Host Command Received"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "17ba3e71-3cbd-4995-a0d4-0c3b8974ef15": {
            "nodeId": "17ba3e71-3cbd-4995-a0d4-0c3b8974ef15",
            "name": "Command",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{[1934a549-846f-4e68-b062-3d688e972ab2].[trimmed]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "1934a549-846f-4e68-b062-3d688e972ab2": {
            "nodeId": "1934a549-846f-4e68-b062-3d688e972ab2",
            "name": "Trim Command",
            "type": "action",
            "plugin": {
              "name": "String Operations",
              "slugVendor": "rapid7",
              "slugName": "string",
              "slugVersion": "1.2.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/string/1.2.1/icon.png"
            },
            "identifier": "trim",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "string": "{{[c14619d0-89e1-440d-ae65-f85970c06e15].[list].[0]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "string": {
                  "description": "String to trim",
                  "order": 1,
                  "title": "String Input",
                  "type": "string"
                }
              },
              "required": [
                "string"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "trimmed": {
                  "description": "Trimmed string",
                  "order": 1,
                  "title": "Trimmed",
                  "type": "string"
                }
              },
              "required": [
                "trimmed"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "4448411f-10bf-4898-9b83-75555ce41c13": {
            "nodeId": "4448411f-10bf-4898-9b83-75555ce41c13",
            "name": "Strip HTML",
            "type": "action",
            "plugin": {
              "name": "HTML",
              "slugVendor": "rapid7",
              "slugName": "html",
              "slugVersion": "1.2.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/html/1.2.1/icon.png"
            },
            "identifier": "text",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "doc": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[body].[content]}}",
                "remove_scripts": true
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "doc": {
                  "description": "Document to transform",
                  "order": 1,
                  "title": "Document",
                  "type": "string"
                },
                "remove_scripts": {
                  "description": "Remove non-HTML scripts from the document",
                  "order": 2,
                  "title": "Remove Scripts",
                  "type": "boolean"
                }
              },
              "required": [
                "doc"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "text": {
                  "description": "String without HTML tags",
                  "order": 1,
                  "title": "Text",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "4d650a86-639d-4f34-8920-52d3c954152b": {
            "nodeId": "4d650a86-639d-4f34-8920-52d3c954152b",
            "name": "Teams Trigger",
            "type": "trigger",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "2.0.2",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/2.0.2/icon.png"
            },
            "identifier": "new_message_received",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "change_me",
                "message_content": "^!block-status.*",
                "team_name": "change_me"
              }
            },
            "triggerId": "8ade6e46-bdfe-4f78-9bfa-98403ecfd7c8",
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "Regex to match new messages against",
                  "order": 3,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION"
          },
          "8300c579-8aeb-405b-ae13-3bea6c68eb7e": {
            "nodeId": "8300c579-8aeb-405b-ae13-3bea6c68eb7e",
            "name": "Host Found in Group",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "2.0.2",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/2.0.2/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "change_me",
                "message_content": "üîç  <b>Host Found</b>  üîç<br>\n<br>\n{{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}} was found in the following address objects: <br>\n<br>\n{{#each [8c18b523-d755-46d0-a37d-a3caf41e4b78].[address_objects]}}\n{{this}}<br>\n{{/each}}\n<br>\n<b>Workflow Complete</b>  ‚úÖ",
                "team_name": "change_me"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 3,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "83782ee6-5362-4b81-8902-9d4904c8ecd8": {
            "nodeId": "83782ee6-5362-4b81-8902-9d4904c8ecd8",
            "name": "Host",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{[0fb40255-5bb0-4dee-8b74-7f3ac392bd7c].[trimmed]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "8c18b523-d755-46d0-a37d-a3caf41e4b78": {
            "nodeId": "8c18b523-d755-46d0-a37d-a3caf41e4b78",
            "name": "Check if IP in Group",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Firewall",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_pan_os",
              "slugVersion": "5.1.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_pan_os/5.1.1/icon.png"
            },
            "identifier": "check_if_address_object_in_group",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "address": "{{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}}",
                "device_name": "localhost.localdomain",
                "enable_search": true,
                "group": "change_me",
                "virtual_system": "vsys1"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "The Address Object name to check. If Enable Search is set to true then we search the addresses (IP, CIDR, doman) within the address object instead of matching the name",
                  "order": 2,
                  "title": "Address",
                  "type": "string"
                },
                "device_name": {
                  "default": "localhost.localdomain",
                  "description": "Device name",
                  "order": 4,
                  "title": "Device Name",
                  "type": "string"
                },
                "enable_search": {
                  "default": false,
                  "description": "When enabled, the Address input will accept a IP, CIDR, or domain name to search across the available Address Objects in the system. This is useful when you don‚Äôt know the Address Object by its name",
                  "order": 3,
                  "title": "Enable Search",
                  "type": "boolean"
                },
                "group": {
                  "description": "Group name",
                  "order": 1,
                  "title": "Group",
                  "type": "string"
                },
                "virtual_system": {
                  "default": "vsys1",
                  "description": "Virtual system name",
                  "order": 5,
                  "title": "Virtual System Name",
                  "type": "string"
                }
              },
              "required": [
                "enable_search",
                "device_name",
                "virtual_system",
                "group",
                "address"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "address_objects": {
                  "description": "The names of the address objects that match or contain address",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Address Objects",
                  "type": "array"
                },
                "found": {
                  "description": "Was address found in group",
                  "order": 1,
                  "title": "Found",
                  "type": "boolean"
                }
              },
              "required": [
                "found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "92405a43-74cc-4a86-aa1e-595b54f0f374": {
            "nodeId": "92405a43-74cc-4a86-aa1e-595b54f0f374",
            "name": "Host was not Found in Group",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "2.0.2",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/2.0.2/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "change_me",
                "message_content": "üîç  <b>Host Not Found</b>  üîç<br>\n<br>\n<b>Host was not in block list:</b> \"{{[83782ee6-5362-4b81-8902-9d4904c8ecd8].[content]}}\"<br> \n<br>\n<b>Workflow Complete</b>  ‚ùó",
                "team_name": "change_me"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 3,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "95c927b8-9dba-4fb0-9c4c-882501926cea": {
            "nodeId": "95c927b8-9dba-4fb0-9c4c-882501926cea",
            "name": "Is IP in Group",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "b5909a47-f97e-4ca1-93b7-7750509a046a",
              "stepControlParams": [
                {
                  "edgeId": "e1d845ed-6ad1-493a-9275-a822cb4e6ba2",
                  "expression": {
                    "name": "8c18b523-d755-46d0-a37d-a3caf41e4b78.found",
                    "type": "variable"
                  },
                  "expressionText": "{{[8c18b523-d755-46d0-a37d-a3caf41e4b78].[found]}}"
                },
                {
                  "edgeId": "b5909a47-f97e-4ca1-93b7-7750509a046a",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "a8cb8116-fb29-42af-8c76-61bafea595b4": {
            "nodeId": "a8cb8116-fb29-42af-8c76-61bafea595b4",
            "name": "Start Workflow Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "2.0.2",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/2.0.2/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "change_me",
                "message_content": "üîç  <b> Starting Search </b>  üîç",
                "team_name": "change_me"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 3,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "b5baf6db-0d7d-4fd7-b146-00925635c7f2": {
            "nodeId": "b5baf6db-0d7d-4fd7-b146-00925635c7f2",
            "name": "Command Received",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{[4448411f-10bf-4898-9b83-75555ce41c13].[text]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "c14619d0-89e1-440d-ae65-f85970c06e15": {
            "nodeId": "c14619d0-89e1-440d-ae65-f85970c06e15",
            "name": "Split Command",
            "type": "action",
            "plugin": {
              "name": "String Operations",
              "slugVendor": "rapid7",
              "slugName": "string",
              "slugVersion": "1.2.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/string/1.2.1/icon.png"
            },
            "identifier": "split_to_list",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "delimiter": " ",
                "string": "{{[4448411f-10bf-4898-9b83-75555ce41c13].[text]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "delimiter": {
                  "description": "The character used to split the string into slices for the list. The default is a newline, if not provided by the user",
                  "order": 2,
                  "title": "Delimiter",
                  "type": "string"
                },
                "string": {
                  "description": "String to convert e.g. Sentence one\nSentence two",
                  "order": 1,
                  "title": "String Input",
                  "type": "string"
                }
              },
              "required": [
                "string"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "list": {
                  "description": "List of string components",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "List",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          }
        },
        "tags": null,
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": ""
      }
    ],
    "triggers": [
      {
        "id": "8ade6e46-bdfe-4f78-9bfa-98403ecfd7c8",
        "identifier": "new_message_received",
        "name": "Teams Trigger",
        "description": "",
        "input": {
          "channel_name": "change_me",
          "message_content": "^!block-status.*",
          "team_name": "change_me"
        },
        "inputJsonSchema": {
          "properties": {
            "channel_name": {
              "description": "Channel",
              "order": 2,
              "title": "Channel Name",
              "type": "string"
            },
            "message_content": {
              "description": "Regex to match new messages against",
              "order": 3,
              "title": "Message Content",
              "type": "string"
            },
            "team_name": {
              "description": "Team name",
              "order": 1,
              "title": "Team Name",
              "type": "string"
            }
          },
          "required": [
            "team_name",
            "channel_name"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "body": {
              "properties": {
                "content": {
                  "description": "Content",
                  "order": 1,
                  "title": "Content",
                  "type": "string"
                },
                "contentType": {
                  "description": "Content type",
                  "order": 2,
                  "title": "Content Type",
                  "type": "string"
                }
              },
              "title": "Body",
              "type": "object"
            },
            "from": {
              "properties": {
                "user": {
                  "$ref": "#/definitions/user",
                  "description": "User",
                  "order": 1,
                  "title": "User"
                }
              },
              "title": "From",
              "type": "object"
            },
            "message": {
              "properties": {
                "body": {
                  "$ref": "#/definitions/body",
                  "description": "Body",
                  "order": 1,
                  "title": "Body"
                },
                "createdDateTime": {
                  "description": "Created date time",
                  "order": 3,
                  "title": "Created Date Time",
                  "type": "string"
                },
                "from": {
                  "$ref": "#/definitions/from",
                  "description": "From",
                  "order": 2,
                  "title": "From"
                },
                "id": {
                  "description": "ID",
                  "order": 8,
                  "title": "ID",
                  "type": "string"
                },
                "importance": {
                  "description": "Importance",
                  "order": 5,
                  "title": "Importance",
                  "type": "string"
                },
                "locale": {
                  "description": "Locale",
                  "order": 7,
                  "title": "Locale",
                  "type": "string"
                },
                "messageType": {
                  "description": "Message type",
                  "order": 6,
                  "title": "Message Type",
                  "type": "string"
                },
                "webUrl": {
                  "description": "Web URL",
                  "order": 4,
                  "title": "Web URL",
                  "type": "string"
                }
              },
              "title": "Message",
              "type": "object"
            },
            "user": {
              "properties": {
                "displayName": {
                  "description": "Display name",
                  "order": 1,
                  "title": "Display name",
                  "type": "string"
                },
                "id": {
                  "description": "ID",
                  "order": 2,
                  "title": "ID",
                  "type": "string"
                }
              },
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "message": {
              "$ref": "#/definitions/message",
              "description": "The message object that was created",
              "order": 1,
              "title": "Message"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_plugin",
        "plugin": {
          "name": "Microsoft Teams",
          "slugVendor": "rapid7",
          "slugName": "microsoft_teams",
          "slugVersion": "2.0.2",
          "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/2.0.2/icon.png"
        }
      }
    ]
  }
}