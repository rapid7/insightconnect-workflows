{
  "kom": {
    "komandVersion": "1.37.0-0-gda4e3",
    "komFileVersion": "2.0.0",
    "exportedAt": "2019-09-12T21:02:43.845817734Z",
    "workflowVersions": [
      {
        "name": "Office 365 Analysis",
        "type": "runnable",
        "version": "",
        "description": "",
        "graph": {
          "edges": {
            "035a7f86-3850-47e4-9055-373c4c9f3a7a": {
              "id": "035a7f86-3850-47e4-9055-373c4c9f3a7a",
              "name": "",
              "description": "This workflow is designed to automatically analyze incoming emails to determine if they are malicious. This workflow assumes a user is using their report phishing button to send an email to an administrative account with the suspicious email attached. The workflow will then analyze any URLs or files in the attached email to find malicious links. If any malicious indicators are found the email will be remediated across the organization.",
              "parentNodeId": "",
              "fromNodeId": "419e96fc-d195-4e15-ba31-c98036bd8617",
              "toNodeId": "f15c9ec4-4e01-4647-91cb-b84e04cdc67c"
            },
            "093d30cf-aff0-4f0b-8194-8587ec40789b": {
              "id": "093d30cf-aff0-4f0b-8194-8587ec40789b",
              "name": "True",
              "description": "",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "fromNodeId": "63487857-be4e-4c1e-9302-6a8c575d9193",
              "toNodeId": "87e72977-6289-4a6e-a73a-8e76b54b63fc"
            },
            "0b8549a1-a6cf-44bf-ba2a-ff380cd23e76": {
              "id": "0b8549a1-a6cf-44bf-ba2a-ff380cd23e76",
              "name": "True",
              "description": "",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "fromNodeId": "61671b98-5732-4d0e-bb12-6fbaa469ae0e",
              "toNodeId": "36750222-5693-4152-a83e-2196bf5571e0"
            },
            "1370aeb1-247b-426d-af1e-fced15c43b23": {
              "id": "1370aeb1-247b-426d-af1e-fced15c43b23",
              "name": "Does Not Have Attachments",
              "description": "The triggering email did not have any attachments. ",
              "parentNodeId": "",
              "fromNodeId": "0df75dc8-0336-43c3-b3d7-18f080a89f19",
              "toNodeId": ""
            },
            "13fbb508-9e1e-4861-ad70-5a84210c4f57": {
              "id": "13fbb508-9e1e-4861-ad70-5a84210c4f57",
              "name": "",
              "description": "",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "fromNodeId": "a7f3eab4-43e2-4a42-bf19-9bc95004bba3",
              "toNodeId": "63487857-be4e-4c1e-9302-6a8c575d9193"
            },
            "14fad1f4-5e4f-492f-9499-5f2882826e67": {
              "id": "14fad1f4-5e4f-492f-9499-5f2882826e67",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e44548ff-3920-4b39-a193-c8edb4f6c117",
              "toNodeId": "61ee7af6-fe69-4995-975c-c69f5bd952b9"
            },
            "1b0439d2-c571-43c0-8db0-e0d43582e5e3": {
              "id": "1b0439d2-c571-43c0-8db0-e0d43582e5e3",
              "name": "",
              "description": "",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "fromNodeId": "3ca29053-84ce-4616-acd3-6fe8fb2f2d03",
              "toNodeId": "1a618ebf-8d61-4472-b2ee-53ac0cf3112f"
            },
            "1b54caa9-a17f-4c0e-97c6-4b1209f7ccdb": {
              "id": "1b54caa9-a17f-4c0e-97c6-4b1209f7ccdb",
              "name": "",
              "description": "",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "fromNodeId": "1a618ebf-8d61-4472-b2ee-53ac0cf3112f",
              "toNodeId": "61671b98-5732-4d0e-bb12-6fbaa469ae0e"
            },
            "1d2aecc6-3962-4d50-bf5b-59987a1e6002": {
              "id": "1d2aecc6-3962-4d50-bf5b-59987a1e6002",
              "name": "",
              "description": "",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "fromNodeId": "323b29a6-ce79-43e0-a0f3-0ab3671d1cd3",
              "toNodeId": "5e08635d-9729-4867-9150-4d012f64b852"
            },
            "32656d03-975b-475a-b10d-105bf4ef29a4": {
              "id": "32656d03-975b-475a-b10d-105bf4ef29a4",
              "name": "",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "89a43e7a-33dd-4fa2-b153-88bd8b90cb6f",
              "toNodeId": "78d534f3-af2e-4942-98c7-2d355b6836f4"
            },
            "3ffbd486-f9e4-41dc-8651-99e69cc04489": {
              "id": "3ffbd486-f9e4-41dc-8651-99e69cc04489",
              "name": "",
              "description": "",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "fromNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "toNodeId": "823eb1a5-9ebf-405f-9324-572605d6dd68"
            },
            "41f9c01b-421f-4d54-9933-0d2a9f26a659": {
              "id": "41f9c01b-421f-4d54-9933-0d2a9f26a659",
              "name": "",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "d1befd02-7fe5-4504-9b16-440fd4658204",
              "toNodeId": "750ba601-fd20-44c6-ac2f-1b7fc29a8e80"
            },
            "4b5263cb-ea27-479c-af7b-673384988e5e": {
              "id": "4b5263cb-ea27-479c-af7b-673384988e5e",
              "name": "",
              "description": "",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "fromNodeId": "87e72977-6289-4a6e-a73a-8e76b54b63fc",
              "toNodeId": ""
            },
            "563c9f5c-44b4-41e9-8b03-839eb4bc71c5": {
              "id": "563c9f5c-44b4-41e9-8b03-839eb4bc71c5",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "17edb1e0-ffca-4ff7-ad48-adbd19429a29",
              "toNodeId": "57940a7a-4779-42cb-a785-a0d37a73ef90"
            },
            "610a5118-6d16-4d71-ad39-d083897f41f3": {
              "id": "610a5118-6d16-4d71-ad39-d083897f41f3",
              "name": "",
              "description": "",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "fromNodeId": "36750222-5693-4152-a83e-2196bf5571e0",
              "toNodeId": "f245b7ef-24e7-4d6d-944c-f48355930e0d"
            },
            "65c194fa-a3b7-432d-abca-5a4f1438fd42": {
              "id": "65c194fa-a3b7-432d-abca-5a4f1438fd42",
              "name": "",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "toNodeId": "b56a1357-8ddb-43b5-af81-6592c15e30e4"
            },
            "721b924a-2524-4a9a-85b9-b3474697dcd9": {
              "id": "721b924a-2524-4a9a-85b9-b3474697dcd9",
              "name": "",
              "description": "",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "fromNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "toNodeId": "a7f3eab4-43e2-4a42-bf19-9bc95004bba3"
            },
            "7885e52a-a487-4510-9364-751a0efcff17": {
              "id": "7885e52a-a487-4510-9364-751a0efcff17",
              "name": "False",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f15c9ec4-4e01-4647-91cb-b84e04cdc67c",
              "toNodeId": ""
            },
            "79f782d4-d168-4e5e-b17d-35256d2c142d": {
              "id": "79f782d4-d168-4e5e-b17d-35256d2c142d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "47496fd4-9310-4fac-b631-ef321f7ef064",
              "toNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d"
            },
            "7c575794-d88b-49ef-a4da-70dc542c4a6b": {
              "id": "7c575794-d88b-49ef-a4da-70dc542c4a6b",
              "name": "",
              "description": "",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "fromNodeId": "09d427ee-4c6e-4b3e-a94f-33323684ca27",
              "toNodeId": "aaebce98-efac-456a-b2a9-2eacbf70858a"
            },
            "81a03dd4-a5e0-4d03-b30c-f3730c95206b": {
              "id": "81a03dd4-a5e0-4d03-b30c-f3730c95206b",
              "name": "Not Malicious",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "750ba601-fd20-44c6-ac2f-1b7fc29a8e80",
              "toNodeId": ""
            },
            "824e0984-e6fa-41be-82b5-87d1cbe761fe": {
              "id": "824e0984-e6fa-41be-82b5-87d1cbe761fe",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "d20e0fc4-3587-4970-8afe-136824f7dc46",
              "toNodeId": "419e96fc-d195-4e15-ba31-c98036bd8617"
            },
            "8b25fca3-2cbf-4219-bf64-a2fe2e5e6544": {
              "id": "8b25fca3-2cbf-4219-bf64-a2fe2e5e6544",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "toNodeId": "d20e0fc4-3587-4970-8afe-136824f7dc46"
            },
            "8ef73434-c3a3-4587-8828-3e3c7933bf81": {
              "id": "8ef73434-c3a3-4587-8828-3e3c7933bf81",
              "name": "",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "78d534f3-af2e-4942-98c7-2d355b6836f4",
              "toNodeId": "a783f2be-fcf7-4f47-a4b5-8167ce048c1d"
            },
            "9207685a-61a1-45a1-8977-9bff1c8ae631": {
              "id": "9207685a-61a1-45a1-8977-9bff1c8ae631",
              "name": "",
              "description": "",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "fromNodeId": "5e08635d-9729-4867-9150-4d012f64b852",
              "toNodeId": "66edc4da-f487-4623-836c-97faea6384c9"
            },
            "9748c50c-303f-4b5b-8f9e-bf50286ad86b": {
              "id": "9748c50c-303f-4b5b-8f9e-bf50286ad86b",
              "name": "False",
              "description": "",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "fromNodeId": "61671b98-5732-4d0e-bb12-6fbaa469ae0e",
              "toNodeId": ""
            },
            "9e8a3175-fc54-4817-9beb-73c6ca4b94bc": {
              "id": "9e8a3175-fc54-4817-9beb-73c6ca4b94bc",
              "name": "Has Attachments",
              "description": "The triggering email has attachments",
              "parentNodeId": "",
              "fromNodeId": "0df75dc8-0336-43c3-b3d7-18f080a89f19",
              "toNodeId": "1074a86c-bc81-415d-8edc-3c387b774420"
            },
            "9ed559c0-3edb-49d2-8f44-41498851ae43": {
              "id": "9ed559c0-3edb-49d2-8f44-41498851ae43",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "7578a1a6-119e-47ef-9ae9-d0e0c24794aa",
              "toNodeId": "e44548ff-3920-4b39-a193-c8edb4f6c117"
            },
            "a4a14e4f-c104-490c-885a-d0ed5477720f": {
              "id": "a4a14e4f-c104-490c-885a-d0ed5477720f",
              "name": "",
              "description": "",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "fromNodeId": "aaebce98-efac-456a-b2a9-2eacbf70858a",
              "toNodeId": ""
            },
            "af99ac93-3b18-47bf-98cb-5e6b39ea0801": {
              "id": "af99ac93-3b18-47bf-98cb-5e6b39ea0801",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "20c2237a-ec86-4eeb-987e-d6e222c6d7e0",
              "toNodeId": "984bb254-4b9b-4f19-9088-40903b948dfb"
            },
            "af9a26e4-2e4a-41ec-b6c2-c5ef0f39f805": {
              "id": "af9a26e4-2e4a-41ec-b6c2-c5ef0f39f805",
              "name": "",
              "description": "",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "fromNodeId": "66edc4da-f487-4623-836c-97faea6384c9",
              "toNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f"
            },
            "b02fb6ba-5495-4c0a-94a5-275f5e8ee34b": {
              "id": "b02fb6ba-5495-4c0a-94a5-275f5e8ee34b",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "toNodeId": "47496fd4-9310-4fac-b631-ef321f7ef064"
            },
            "b0f60fdd-8950-494c-915b-1e46cd3dd118": {
              "id": "b0f60fdd-8950-494c-915b-1e46cd3dd118",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "1b82897d-95a2-4799-87d8-881d201d8fa8",
              "toNodeId": "7578a1a6-119e-47ef-9ae9-d0e0c24794aa"
            },
            "ba365f45-f9cc-4bf7-b979-6c49b0edd9cc": {
              "id": "ba365f45-f9cc-4bf7-b979-6c49b0edd9cc",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "29b6f6b2-baf5-45fe-aa3a-4617650163fd",
              "toNodeId": "20c2237a-ec86-4eeb-987e-d6e222c6d7e0"
            },
            "bfd977f3-03cd-4715-b63c-e10ab642d490": {
              "id": "bfd977f3-03cd-4715-b63c-e10ab642d490",
              "name": "",
              "description": "",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "fromNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "toNodeId": "323b29a6-ce79-43e0-a0f3-0ab3671d1cd3"
            },
            "c7fc61ec-9910-4573-a5b5-9ba200b5f2e2": {
              "id": "c7fc61ec-9910-4573-a5b5-9ba200b5f2e2",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "61ee7af6-fe69-4995-975c-c69f5bd952b9",
              "toNodeId": ""
            },
            "c8087cac-092e-46de-864f-3e386df3e577": {
              "id": "c8087cac-092e-46de-864f-3e386df3e577",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "57940a7a-4779-42cb-a785-a0d37a73ef90",
              "toNodeId": "29b6f6b2-baf5-45fe-aa3a-4617650163fd"
            },
            "d0ddd32f-6772-4265-8732-5a220d5802a8": {
              "id": "d0ddd32f-6772-4265-8732-5a220d5802a8",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "984bb254-4b9b-4f19-9088-40903b948dfb",
              "toNodeId": "0df75dc8-0336-43c3-b3d7-18f080a89f19"
            },
            "d7470a19-5727-4ebf-875d-a6179f1a4ef9": {
              "id": "d7470a19-5727-4ebf-875d-a6179f1a4ef9",
              "name": "Malicious File",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "750ba601-fd20-44c6-ac2f-1b7fc29a8e80",
              "toNodeId": "89a43e7a-33dd-4fa2-b153-88bd8b90cb6f"
            },
            "da6193bb-78c9-4c8e-addf-bbcd12d5e529": {
              "id": "da6193bb-78c9-4c8e-addf-bbcd12d5e529",
              "name": "False",
              "description": "",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "fromNodeId": "63487857-be4e-4c1e-9302-6a8c575d9193",
              "toNodeId": ""
            },
            "e16c3fd8-a96f-46a3-8e5c-bde7a13e0509": {
              "id": "e16c3fd8-a96f-46a3-8e5c-bde7a13e0509",
              "name": "",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "b56a1357-8ddb-43b5-af81-6592c15e30e4",
              "toNodeId": "d1befd02-7fe5-4504-9b16-440fd4658204"
            },
            "e80168fa-4bda-4633-a608-b417f628eaa5": {
              "id": "e80168fa-4bda-4633-a608-b417f628eaa5",
              "name": "",
              "description": "",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "fromNodeId": "f245b7ef-24e7-4d6d-944c-f48355930e0d",
              "toNodeId": "09d427ee-4c6e-4b3e-a94f-33323684ca27"
            },
            "ec27d828-906d-416c-8110-fff852b6c4f3": {
              "id": "ec27d828-906d-416c-8110-fff852b6c4f3",
              "name": "",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "a783f2be-fcf7-4f47-a4b5-8167ce048c1d",
              "toNodeId": ""
            },
            "fae04247-9573-4f9e-ab83-f3829da59453": {
              "id": "fae04247-9573-4f9e-ab83-f3829da59453",
              "name": "",
              "description": "",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "fromNodeId": "823eb1a5-9ebf-405f-9324-572605d6dd68",
              "toNodeId": "3ca29053-84ce-4616-acd3-6fe8fb2f2d03"
            },
            "fceaae38-58dd-4400-96b9-582929fcc93f": {
              "id": "fceaae38-58dd-4400-96b9-582929fcc93f",
              "name": "True",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f15c9ec4-4e01-4647-91cb-b84e04cdc67c",
              "toNodeId": "1b82897d-95a2-4799-87d8-881d201d8fa8"
            }
          },
          "nodes": {
            "09d427ee-4c6e-4b3e-a94f-33323684ca27": {
              "id": "09d427ee-4c6e-4b3e-a94f-33323684ca27",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f"
            },
            "0df75dc8-0336-43c3-b3d7-18f080a89f19": {
              "id": "0df75dc8-0336-43c3-b3d7-18f080a89f19",
              "parentNodeId": ""
            },
            "1074a86c-bc81-415d-8edc-3c387b774420": {
              "id": "1074a86c-bc81-415d-8edc-3c387b774420",
              "parentNodeId": ""
            },
            "17edb1e0-ffca-4ff7-ad48-adbd19429a29": {
              "id": "17edb1e0-ffca-4ff7-ad48-adbd19429a29",
              "parentNodeId": ""
            },
            "1a618ebf-8d61-4472-b2ee-53ac0cf3112f": {
              "id": "1a618ebf-8d61-4472-b2ee-53ac0cf3112f",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f"
            },
            "1b82897d-95a2-4799-87d8-881d201d8fa8": {
              "id": "1b82897d-95a2-4799-87d8-881d201d8fa8",
              "parentNodeId": ""
            },
            "20c2237a-ec86-4eeb-987e-d6e222c6d7e0": {
              "id": "20c2237a-ec86-4eeb-987e-d6e222c6d7e0",
              "parentNodeId": ""
            },
            "29b6f6b2-baf5-45fe-aa3a-4617650163fd": {
              "id": "29b6f6b2-baf5-45fe-aa3a-4617650163fd",
              "parentNodeId": ""
            },
            "323b29a6-ce79-43e0-a0f3-0ab3671d1cd3": {
              "id": "323b29a6-ce79-43e0-a0f3-0ab3671d1cd3",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420"
            },
            "36750222-5693-4152-a83e-2196bf5571e0": {
              "id": "36750222-5693-4152-a83e-2196bf5571e0",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f"
            },
            "3ca29053-84ce-4616-acd3-6fe8fb2f2d03": {
              "id": "3ca29053-84ce-4616-acd3-6fe8fb2f2d03",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f"
            },
            "419e96fc-d195-4e15-ba31-c98036bd8617": {
              "id": "419e96fc-d195-4e15-ba31-c98036bd8617",
              "parentNodeId": ""
            },
            "47496fd4-9310-4fac-b631-ef321f7ef064": {
              "id": "47496fd4-9310-4fac-b631-ef321f7ef064",
              "parentNodeId": ""
            },
            "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d": {
              "id": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "parentNodeId": ""
            },
            "57940a7a-4779-42cb-a785-a0d37a73ef90": {
              "id": "57940a7a-4779-42cb-a785-a0d37a73ef90",
              "parentNodeId": ""
            },
            "5e08635d-9729-4867-9150-4d012f64b852": {
              "id": "5e08635d-9729-4867-9150-4d012f64b852",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420"
            },
            "61671b98-5732-4d0e-bb12-6fbaa469ae0e": {
              "id": "61671b98-5732-4d0e-bb12-6fbaa469ae0e",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f"
            },
            "61ee7af6-fe69-4995-975c-c69f5bd952b9": {
              "id": "61ee7af6-fe69-4995-975c-c69f5bd952b9",
              "parentNodeId": ""
            },
            "63487857-be4e-4c1e-9302-6a8c575d9193": {
              "id": "63487857-be4e-4c1e-9302-6a8c575d9193",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420"
            },
            "66edc4da-f487-4623-836c-97faea6384c9": {
              "id": "66edc4da-f487-4623-836c-97faea6384c9",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420"
            },
            "750ba601-fd20-44c6-ac2f-1b7fc29a8e80": {
              "id": "750ba601-fd20-44c6-ac2f-1b7fc29a8e80",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d"
            },
            "7578a1a6-119e-47ef-9ae9-d0e0c24794aa": {
              "id": "7578a1a6-119e-47ef-9ae9-d0e0c24794aa",
              "parentNodeId": ""
            },
            "78d534f3-af2e-4942-98c7-2d355b6836f4": {
              "id": "78d534f3-af2e-4942-98c7-2d355b6836f4",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d"
            },
            "823eb1a5-9ebf-405f-9324-572605d6dd68": {
              "id": "823eb1a5-9ebf-405f-9324-572605d6dd68",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f"
            },
            "87e72977-6289-4a6e-a73a-8e76b54b63fc": {
              "id": "87e72977-6289-4a6e-a73a-8e76b54b63fc",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420"
            },
            "89a43e7a-33dd-4fa2-b153-88bd8b90cb6f": {
              "id": "89a43e7a-33dd-4fa2-b153-88bd8b90cb6f",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d"
            },
            "984bb254-4b9b-4f19-9088-40903b948dfb": {
              "id": "984bb254-4b9b-4f19-9088-40903b948dfb",
              "parentNodeId": ""
            },
            "a783f2be-fcf7-4f47-a4b5-8167ce048c1d": {
              "id": "a783f2be-fcf7-4f47-a4b5-8167ce048c1d",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d"
            },
            "a7f3eab4-43e2-4a42-bf19-9bc95004bba3": {
              "id": "a7f3eab4-43e2-4a42-bf19-9bc95004bba3",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420"
            },
            "aaebce98-efac-456a-b2a9-2eacbf70858a": {
              "id": "aaebce98-efac-456a-b2a9-2eacbf70858a",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f"
            },
            "b56a1357-8ddb-43b5-af81-6592c15e30e4": {
              "id": "b56a1357-8ddb-43b5-af81-6592c15e30e4",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d"
            },
            "d1befd02-7fe5-4504-9b16-440fd4658204": {
              "id": "d1befd02-7fe5-4504-9b16-440fd4658204",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d"
            },
            "d20e0fc4-3587-4970-8afe-136824f7dc46": {
              "id": "d20e0fc4-3587-4970-8afe-136824f7dc46",
              "parentNodeId": ""
            },
            "e44548ff-3920-4b39-a193-c8edb4f6c117": {
              "id": "e44548ff-3920-4b39-a193-c8edb4f6c117",
              "parentNodeId": ""
            },
            "f15c9ec4-4e01-4647-91cb-b84e04cdc67c": {
              "id": "f15c9ec4-4e01-4647-91cb-b84e04cdc67c",
              "parentNodeId": ""
            },
            "f245b7ef-24e7-4d6d-944c-f48355930e0d": {
              "id": "f245b7ef-24e7-4d6d-944c-f48355930e0d",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f"
            },
            "f70e0bf7-cac7-4467-be3e-5fa3735ee28f": {
              "id": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420"
            }
          }
        },
        "steps": {
          "09d427ee-4c6e-4b3e-a94f-33323684ca27": {
            "nodeId": "09d427ee-4c6e-4b3e-a94f-33323684ca27",
            "name": "Set Malicious Email to True",
            "type": "action",
            "plugin": {
              "name": "Storage",
              "slugVendor": "rapid7",
              "slugName": "storage",
              "slugVersion": "1.0.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg"
            },
            "identifier": "store",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "variable_name": "{{[20c2237a-ec86-4eeb-987e-d6e222c6d7e0].[content]}}",
                "variable_value": "true"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "variable_name": {
                  "description": "Name of the variable to store",
                  "order": 1,
                  "title": "Variable Name",
                  "type": "string"
                },
                "variable_value": {
                  "description": "Value of the variable to store",
                  "order": 2,
                  "title": "Variable Value",
                  "type": "string"
                }
              },
              "required": [
                "variable_name",
                "variable_value"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Was operation successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "0df75dc8-0336-43c3-b3d7-18f080a89f19": {
            "nodeId": "0df75dc8-0336-43c3-b3d7-18f080a89f19",
            "name": "Has attachments",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "1370aeb1-247b-426d-af1e-fced15c43b23",
              "stepControlParams": [
                {
                  "edgeId": "1370aeb1-247b-426d-af1e-fced15c43b23",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "9e8a3175-fc54-4817-9beb-73c6ca4b94bc",
                  "expression": {
                    "name": "17edb1e0-ffca-4ff7-ad48-adbd19429a29.icon_email.has_attachments",
                    "type": "variable"
                  },
                  "expressionText": "{{[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[has_attachments]}}"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "1074a86c-bc81-415d-8edc-3c387b774420": {
            "nodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
            "name": "Email Attachment Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "innerEdgeId": "bfd977f3-03cd-4715-b63c-e10ab642d490",
              "nextEdgeId": "b02fb6ba-5495-4c0a-94a5-275f5e8ee34b",
              "repeatVariable": "[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[flattened_attached_emails]"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "17edb1e0-ffca-4ff7-ad48-adbd19429a29": {
            "nodeId": "17edb1e0-ffca-4ff7-ad48-adbd19429a29",
            "name": "Office 365 New Email Trigger",
            "type": "trigger",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "4.0.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/4.0.0/icon.png"
            },
            "identifier": "email_received",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "flatten_attachments": true,
                "folder_name": "Inbox",
                "interval": 15,
                "mailbox_id": "jschipp@komanddev.onmicrosoft.com",
                "subject_query": ""
              }
            },
            "triggerId": "29c420dd-552a-4615-a944-93bc203c9796",
            "defaultInputJSONSchema": {
              "properties": {
                "flatten_attachments": {
                  "default": false,
                  "description": "Will return all attachments as flat lists instead of nested emails",
                  "order": 5,
                  "title": "Flatten Attachments",
                  "type": "boolean"
                },
                "folder_name": {
                  "description": "Common values are Calendar, Trash, Drafts, Inbox, Outbox, Sent, Junk, Tasks, Contacts. You can also use a completely custom value, for example python_mailing_list. Mailbox names are case-sensitive",
                  "order": 2,
                  "title": "Folder Name",
                  "type": "string"
                },
                "interval": {
                  "default": 15,
                  "description": "How often to poll for new email in seconds",
                  "order": 3,
                  "title": "Interval",
                  "type": "integer"
                },
                "mailbox_id": {
                  "description": "The mailbox to monitor for incoming email e.g. bob@hotmail.com",
                  "order": 1,
                  "title": "Mailbox ID",
                  "type": "string"
                },
                "subject_query": {
                  "default": "",
                  "description": "Query to search for in subject (regex capable). Only these email will activate this trigger",
                  "order": 4,
                  "title": "Subject Query",
                  "type": "string"
                }
              },
              "required": [
                "flatten_attachments",
                "mailbox_id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "attachment_email": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email_nested"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email",
                  "type": "object"
                },
                "attachment_email_nested": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email_nested_two"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email Nested",
                  "type": "object"
                },
                "attachment_email_nested_two": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "type": "object"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email Nested Two",
                  "type": "object"
                },
                "attachment_file": {
                  "properties": {
                    "content": {
                      "order": 2,
                      "title": "Content",
                      "type": "string"
                    },
                    "content_type": {
                      "order": 3,
                      "title": "Content Type",
                      "type": "string"
                    },
                    "file_name": {
                      "order": 1,
                      "title": "File Name",
                      "type": "string"
                    }
                  },
                  "title": "Attachment File",
                  "type": "object"
                },
                "header": {
                  "properties": {
                    "name": {
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "value": {
                      "order": 2,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Header",
                  "type": "object"
                },
                "icon_email": {
                  "properties": {
                    "account": {
                      "description": "Account for which the email was found on",
                      "order": 2,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 6,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 11,
                      "title": "Categories",
                      "type": "array"
                    },
                    "flattened_attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email"
                      },
                      "order": 9,
                      "title": "Flattened Attached Emails",
                      "type": "array"
                    },
                    "flattened_attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 10,
                      "title": "Flattened Attached Files",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 14,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 12,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "is_read": {
                      "description": "Whether or not the email has been read",
                      "order": 3,
                      "title": "Is Read",
                      "type": "boolean"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 13,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 4,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 5,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Icon Email",
                  "type": "object"
                }
              },
              "properties": {
                "icon_email": {
                  "$ref": "#/definitions/icon_email",
                  "description": "Email",
                  "order": 1,
                  "title": "Email"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION"
          },
          "1a618ebf-8d61-4472-b2ee-53ac0cf3112f": {
            "nodeId": "1a618ebf-8d61-4472-b2ee-53ac0cf3112f",
            "name": "Get Result",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "5.0.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/5.0.0/icon.png"
            },
            "identifier": "scan_url_report",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "url": "{{[f70e0bf7-cac7-4467-be3e-5fa3735ee28f].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "url": {
                  "description": "URL scanned",
                  "order": 1,
                  "title": "URL",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "malicious": {
                  "description": "True if one or more positives",
                  "order": 1,
                  "title": "Malicious",
                  "type": "boolean"
                },
                "permalink": {
                  "description": "Permalink",
                  "order": 8,
                  "title": "Permalink",
                  "type": "string"
                },
                "positives": {
                  "description": "Positives",
                  "order": 9,
                  "title": "Positives",
                  "type": "integer"
                },
                "resource": {
                  "description": "Resource",
                  "order": 4,
                  "title": "Resource",
                  "type": "string"
                },
                "response_code": {
                  "description": "Response code",
                  "order": 2,
                  "title": "Response Code",
                  "type": "integer"
                },
                "scan_date": {
                  "description": "Scan date",
                  "order": 7,
                  "title": "Scan Date",
                  "type": "string"
                },
                "scan_id": {
                  "description": "Scan ID",
                  "order": 6,
                  "title": "Scan ID",
                  "type": "string"
                },
                "scans": {
                  "description": "Scans",
                  "order": 11,
                  "title": "Scans",
                  "type": "object"
                },
                "total": {
                  "description": "Total",
                  "order": 10,
                  "title": "Total",
                  "type": "integer"
                },
                "url": {
                  "description": "URL",
                  "order": 5,
                  "title": "URL",
                  "type": "string"
                },
                "verbose_msg": {
                  "description": "Verbose message",
                  "order": 3,
                  "title": "Verbose Message",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "1b82897d-95a2-4799-87d8-881d201d8fa8": {
            "nodeId": "1b82897d-95a2-4799-87d8-881d201d8fa8",
            "name": "# Remediation",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Remediation Goes Here\n\n(this artifact can be removed)\n\nAt this point in the workflow, we've established we have a malicious email. \n\nRemediation steps go on this branch of the flow. They can be email notifications, slack notifications for human follow up. Remediation can also go further and block the sender and delete the email from your organization. \n\nIn this example, I will send a notification via email, and use the Office Admin plugin to both delete the email and block the sender from our organization. "
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "20c2237a-ec86-4eeb-987e-d6e222c6d7e0": {
            "nodeId": "20c2237a-ec86-4eeb-987e-d6e222c6d7e0",
            "name": "Malicious Indicator Variable Name",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{[29b6f6b2-baf5-45fe-aa3a-4617650163fd].[basename]}}-Mailicious Email"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "29b6f6b2-baf5-45fe-aa3a-4617650163fd": {
            "nodeId": "29b6f6b2-baf5-45fe-aa3a-4617650163fd",
            "name": "Job ID Basename",
            "type": "action",
            "plugin": {
              "name": "Basename",
              "slugVendor": "rapid7",
              "slugName": "basename",
              "slugVersion": "1.0.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/basename/1.0.0/icon.png"
            },
            "identifier": "basename",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "path": "{{[$job].[URL]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "path": {
                  "description": "URL or file path",
                  "order": 1,
                  "title": "Path",
                  "type": "string"
                }
              },
              "required": [
                "path"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "basename": {
                  "description": "Basename result",
                  "order": 1,
                  "title": "Basename",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "323b29a6-ce79-43e0-a0f3-0ab3671d1cd3": {
            "nodeId": "323b29a6-ce79-43e0-a0f3-0ab3671d1cd3",
            "name": "Analysis Explanation",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## Analysis Explanation\n\n(This artifact can be removed)\n\nFor each attached email we find, we will attempt to extract the URLs from that email and see if any are malicious. This will be the best indicator of a suspicious email. "
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "36750222-5693-4152-a83e-2196bf5571e0": {
            "nodeId": "36750222-5693-4152-a83e-2196bf5571e0",
            "name": "Malicious Email Found",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Malicious Email Found\n\n(this artifact can be removed)\n\nAt this point, we can be sure that the email we've found is spam. Here you should take remediation steps to remove the email from your organization.\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "3ca29053-84ce-4616-acd3-6fe8fb2f2d03": {
            "nodeId": "3ca29053-84ce-4616-acd3-6fe8fb2f2d03",
            "name": "VirusTotal Scan URL",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "5.0.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/5.0.0/icon.png"
            },
            "identifier": "scan_url",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "url": "{{[f70e0bf7-cac7-4467-be3e-5fa3735ee28f].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "url": {
                  "description": "URL to scan",
                  "order": 1,
                  "title": "URL",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "permalink": {
                  "description": "Permalink",
                  "order": 6,
                  "title": "Permalink",
                  "type": "string"
                },
                "response_code": {
                  "description": "Response code",
                  "order": 3,
                  "title": "Response Code",
                  "type": "integer"
                },
                "scan_date": {
                  "description": "Scan date",
                  "order": 4,
                  "title": "Scan Date",
                  "type": "string"
                },
                "scan_id": {
                  "description": "ID of the report",
                  "order": 1,
                  "title": "Scan ID",
                  "type": "string"
                },
                "url": {
                  "description": "URL",
                  "order": 5,
                  "title": "URL",
                  "type": "string"
                },
                "verbose_msg": {
                  "description": "Message returned from the submission",
                  "order": 2,
                  "title": "Verbose Message",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "419e96fc-d195-4e15-ba31-c98036bd8617": {
            "nodeId": "419e96fc-d195-4e15-ba31-c98036bd8617",
            "name": "Overall Malicious Indicator",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# MALICIOUS INDICATOR: \nWas email malicious: {{[d20e0fc4-3587-4970-8afe-136824f7dc46].[value]}}\n\n\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "47496fd4-9310-4fac-b631-ef321f7ef064": {
            "nodeId": "47496fd4-9310-4fac-b631-ef321f7ef064",
            "name": "File Analysis Overview",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## File Analysis\n\n(This artifact can be removed) \n\nThis loop will analyze files and look for any malicious files. If any are found this email will be marked as malicious. "
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d": {
            "nodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
            "name": "File Analysis Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "innerEdgeId": "65c194fa-a3b7-432d-abca-5a4f1438fd42",
              "nextEdgeId": "8b25fca3-2cbf-4219-bf64-a2fe2e5e6544",
              "repeatVariable": "[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[flattened_attached_files]"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "57940a7a-4779-42cb-a785-a0d37a73ef90": {
            "nodeId": "57940a7a-4779-42cb-a785-a0d37a73ef90",
            "name": "Overview Note",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Overview \n\n(This artifact should be removed)\n\nThis workflow assumes a standard phishing process. The user will push the phish button on a suspicious email that will then be sent to the mailbox this flow is monitoring as an attachment. \n\nWe can assume the base email is benign and any suspicious or malicious content will be in the attachment(s).\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "5e08635d-9729-4867-9150-4d012f64b852": {
            "nodeId": "5e08635d-9729-4867-9150-4d012f64b852",
            "name": "Extract URLs",
            "type": "action",
            "plugin": {
              "name": "ExtractIt",
              "slugVendor": "rapid7",
              "slugName": "extractit",
              "slugVersion": "1.1.6",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/extractit/1.1.6/icon.png"
            },
            "identifier": "url_extractor",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "file": "",
                "str": "{{[1074a86c-bc81-415d-8edc-3c387b774420].[$item].[body]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "file": {
                  "description": "Input file as bytes",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 2,
                  "title": "File",
                  "type": "string"
                },
                "str": {
                  "description": "Input string",
                  "order": 1,
                  "title": "String",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "urls": {
                  "description": "List of extracted URLs",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "URLs",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "61671b98-5732-4d0e-bb12-6fbaa469ae0e": {
            "nodeId": "61671b98-5732-4d0e-bb12-6fbaa469ae0e",
            "name": "Malicious URL",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "9748c50c-303f-4b5b-8f9e-bf50286ad86b",
              "stepControlParams": [
                {
                  "edgeId": "9748c50c-303f-4b5b-8f9e-bf50286ad86b",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "0b8549a1-a6cf-44bf-ba2a-ff380cd23e76",
                  "expression": {
                    "name": "1a618ebf-8d61-4472-b2ee-53ac0cf3112f.malicious",
                    "type": "variable"
                  },
                  "expressionText": "{{[1a618ebf-8d61-4472-b2ee-53ac0cf3112f].[malicious]}}"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "61ee7af6-fe69-4995-975c-c69f5bd952b9": {
            "nodeId": "61ee7af6-fe69-4995-975c-c69f5bd952b9",
            "name": "Purge Email from Org",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office365 Email Security",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email_security",
              "slugVersion": "2.1.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email_security/2.1.0/icon.png"
            },
            "identifier": "mass_search_and_purge",
            "continueOnFailure": false,
            "isDisabled": true,
            "parameters": {
              "input": {
                "compliance_search_name": "{{[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[subject]}}",
                "content_match_query": "subject: \"{{[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[subject]}}\" from: \"{{[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[sender]}}\"",
                "delete_items": true,
                "query_timeout": 60
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "compliance_search_name": {
                  "description": "Name of compliance search",
                  "order": 1,
                  "title": "Compliance Search Name",
                  "type": "string"
                },
                "content_match_query": {
                  "description": "This parameter uses a text search string or a query that's formatted by using the Keyword Query Language (KQL). For more information about KQL, see Keyword Query Language syntax reference (https://go.microsoft.com/fwlink/p/?linkid=269603)",
                  "order": 2,
                  "title": "Content Match Query",
                  "type": "string"
                },
                "delete_items": {
                  "default": false,
                  "description": "The script only executes the delete action if this parameter is true",
                  "order": 4,
                  "title": "Delete Items",
                  "type": "boolean"
                },
                "query_timeout": {
                  "default": 60,
                  "description": "Query timeout in minutes",
                  "order": 3,
                  "title": "Query Timeout",
                  "type": "integer"
                }
              },
              "required": [
                "compliance_search_name",
                "content_match_query"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "63487857-be4e-4c1e-9302-6a8c575d9193": {
            "nodeId": "63487857-be4e-4c1e-9302-6a8c575d9193",
            "name": "Was Malicious URL Found",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "da6193bb-78c9-4c8e-addf-bbcd12d5e529",
              "stepControlParams": [
                {
                  "edgeId": "093d30cf-aff0-4f0b-8194-8587ec40789b",
                  "expression": {
                    "left": {
                      "name": "a7f3eab4-43e2-4a42-bf19-9bc95004bba3.value",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": "true"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[a7f3eab4-43e2-4a42-bf19-9bc95004bba3].[value]}} = 'true'"
                },
                {
                  "edgeId": "da6193bb-78c9-4c8e-addf-bbcd12d5e529",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "66edc4da-f487-4623-836c-97faea6384c9": {
            "nodeId": "66edc4da-f487-4623-836c-97faea6384c9",
            "name": "Extracted URLs",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{#each [5e08635d-9729-4867-9150-4d012f64b852].[urls]}}\n{{this}}\n{{/each}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "750ba601-fd20-44c6-ac2f-1b7fc29a8e80": {
            "nodeId": "750ba601-fd20-44c6-ac2f-1b7fc29a8e80",
            "name": "Is File Malicious",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "81a03dd4-a5e0-4d03-b30c-f3730c95206b",
              "stepControlParams": [
                {
                  "edgeId": "81a03dd4-a5e0-4d03-b30c-f3730c95206b",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "d7470a19-5727-4ebf-875d-a6179f1a4ef9",
                  "expression": {
                    "name": "d1befd02-7fe5-4504-9b16-440fd4658204.found",
                    "type": "variable"
                  },
                  "expressionText": "{{[d1befd02-7fe5-4504-9b16-440fd4658204].[found]}}"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "7578a1a6-119e-47ef-9ae9-d0e0c24794aa": {
            "nodeId": "7578a1a6-119e-47ef-9ae9-d0e0c24794aa",
            "name": "Send Notification Email",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "4.0.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/4.0.0/icon.png"
            },
            "identifier": "send_email",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachment": {
                  "content": "",
                  "filename": ""
                },
                "bcc": [],
                "body": "The following email was found to be malicious. \n\nEmail From: {{[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[sender]}}\nEmail Subject: {{[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[subject]}}\n\nJob URL: {{[$job].[URL]}}",
                "cc": [],
                "email_from": "jschipp@komanddev.onmicrosoft.com",
                "email_to": "jmcadams@rapid7.com",
                "is_html": false,
                "subject": "Malicious Email Found"
              }
            },
            "defaultInputJSONSchema": {
              "definitions": {
                "file": {
                  "description": "File Object",
                  "properties": {
                    "content": {
                      "description": "File contents",
                      "format": "bytes",
                      "title": "Content",
                      "type": "string"
                    },
                    "filename": {
                      "description": "Name of file",
                      "title": "Filename",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                }
              },
              "properties": {
                "attachment": {
                  "$ref": "#/definitions/file",
                  "description": "Attachment",
                  "order": 8,
                  "title": "Attachment"
                },
                "bcc": {
                  "description": "Blind carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "BCC",
                  "type": "array"
                },
                "body": {
                  "description": "Body of the email",
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "cc": {
                  "description": "Carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CC",
                  "type": "array"
                },
                "email_from": {
                  "description": "Email address this email will be sent from",
                  "order": 1,
                  "title": "Email Sender",
                  "type": "string"
                },
                "email_to": {
                  "description": "Email address of recipients",
                  "order": 2,
                  "title": "Email To",
                  "type": "string"
                },
                "is_html": {
                  "description": "Is the body of this email HTML",
                  "order": 5,
                  "title": "Is HTML",
                  "type": "boolean"
                },
                "subject": {
                  "description": "Subject of the email",
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "required": [
                "email_from",
                "email_to",
                "subject",
                "body",
                "is_html"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "78d534f3-af2e-4942-98c7-2d355b6836f4": {
            "nodeId": "78d534f3-af2e-4942-98c7-2d355b6836f4",
            "name": "Set Malicous Email for File",
            "type": "action",
            "plugin": {
              "name": "Storage",
              "slugVendor": "rapid7",
              "slugName": "storage",
              "slugVersion": "1.0.0,
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg"
            },
            "identifier": "store",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "variable_name": "{{[20c2237a-ec86-4eeb-987e-d6e222c6d7e0].[content]}}",
                "variable_value": "true"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "variable_name": {
                  "description": "Name of the variable to store",
                  "order": 1,
                  "title": "Variable Name",
                  "type": "string"
                },
                "variable_value": {
                  "description": "Value of the variable to store",
                  "order": 2,
                  "title": "Variable Value",
                  "type": "string"
                }
              },
              "required": [
                "variable_name",
                "variable_value"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Was operation successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "823eb1a5-9ebf-405f-9324-572605d6dd68": {
            "nodeId": "823eb1a5-9ebf-405f-9324-572605d6dd68",
            "name": "URL to Check",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Checking URL: {{[f70e0bf7-cac7-4467-be3e-5fa3735ee28f].[$item]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "87e72977-6289-4a6e-a73a-8e76b54b63fc": {
            "nodeId": "87e72977-6289-4a6e-a73a-8e76b54b63fc",
            "name": "Break Email Attachment Loop",
            "type": "break",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "4b5263cb-ea27-479c-af7b-673384988e5e",
                "expression": {
                  "left": {
                    "type": "literal",
                    "value": "true"
                  },
                  "op": "=",
                  "right": {
                    "type": "literal",
                    "value": "true"
                  },
                  "type": "binary"
                },
                "expressionText": "\"true\" = \"true\""
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/break.svg",
            "connectionType": "NONE"
          },
          "89a43e7a-33dd-4fa2-b153-88bd8b90cb6f": {
            "nodeId": "89a43e7a-33dd-4fa2-b153-88bd8b90cb6f",
            "name": "Malicious File Report",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Malicious File Found: \n\nName: {{[5476f0ac-2e67-40c5-a2b9-e26dd2fba99d].[$item].[file_name]}}\nType: {{[5476f0ac-2e67-40c5-a2b9-e26dd2fba99d].[$item].[content_type]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "984bb254-4b9b-4f19-9088-40903b948dfb": {
            "nodeId": "984bb254-4b9b-4f19-9088-40903b948dfb",
            "name": "Set Malicious Variable",
            "type": "action",
            "plugin": {
              "name": "Storage",
              "slugVendor": "rapid7",
              "slugName": "storage",
              "slugVersion": "1.0.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg"
            },
            "identifier": "store",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "variable_name": "{{[20c2237a-ec86-4eeb-987e-d6e222c6d7e0].[content]}}",
                "variable_value": "false"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "variable_name": {
                  "description": "Name of the variable to store",
                  "order": 1,
                  "title": "Variable Name",
                  "type": "string"
                },
                "variable_value": {
                  "description": "Value of the variable to store",
                  "order": 2,
                  "title": "Variable Value",
                  "type": "string"
                }
              },
              "required": [
                "variable_name",
                "variable_value"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Was operation successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "a783f2be-fcf7-4f47-a4b5-8167ce048c1d": {
            "nodeId": "a783f2be-fcf7-4f47-a4b5-8167ce048c1d",
            "name": "Break File Analysis on Malicious File",
            "type": "break",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "ec27d828-906d-416c-8110-fff852b6c4f3",
                "expression": {
                  "left": {
                    "type": "literal",
                    "value": "true"
                  },
                  "op": "=",
                  "right": {
                    "type": "literal",
                    "value": "true"
                  },
                  "type": "binary"
                },
                "expressionText": "\"true\"=\"true\""
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/break.svg",
            "connectionType": "NONE"
          },
          "a7f3eab4-43e2-4a42-bf19-9bc95004bba3": {
            "nodeId": "a7f3eab4-43e2-4a42-bf19-9bc95004bba3",
            "name": "Is URL malicious",
            "type": "action",
            "plugin": {
              "name": "Storage",
              "slugVendor": "rapid7",
              "slugName": "storage",
              "slugVersion": "1.0.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg"
            },
            "identifier": "retrieve",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "variable_name": "{{[20c2237a-ec86-4eeb-987e-d6e222c6d7e0].[content]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "variable_name": {
                  "description": "Variable to get value from",
                  "order": 1,
                  "title": "Variable Name",
                  "type": "string"
                }
              },
              "required": [
                "variable_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "value": {
                  "description": "Value",
                  "order": 1,
                  "title": "Variable Value",
                  "type": "string"
                }
              },
              "required": [
                "value"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "aaebce98-efac-456a-b2a9-2eacbf70858a": {
            "nodeId": "aaebce98-efac-456a-b2a9-2eacbf70858a",
            "name": "Malicious URL Break",
            "type": "break",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "a4a14e4f-c104-490c-885a-d0ed5477720f",
                "expression": {
                  "left": {
                    "type": "literal",
                    "value": "true"
                  },
                  "op": "=",
                  "right": {
                    "type": "literal",
                    "value": "true"
                  },
                  "type": "binary"
                },
                "expressionText": "\"true\"=\"true\""
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/break.svg",
            "connectionType": "NONE"
          },
          "b56a1357-8ddb-43b5-af81-6592c15e30e4": {
            "nodeId": "b56a1357-8ddb-43b5-af81-6592c15e30e4",
            "name": "HashIT",
            "type": "action",
            "plugin": {
              "name": "HashIt",
              "slugVendor": "rapid7",
              "slugName": "hashit",
              "slugVersion": "2.0.1",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/hashit/2.0.1/icon.png"
            },
            "identifier": "bytes",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "bytes": "{{[5476f0ac-2e67-40c5-a2b9-e26dd2fba99d].[$item].[content]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "bytes": {
                  "description": "Base64 encoded file bytes to hash",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 1,
                  "title": "Bytes",
                  "type": "string"
                }
              },
              "required": [
                "bytes"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "md5": {
                  "description": "MD5 hash",
                  "order": 1,
                  "title": "MD5 Hash",
                  "type": "string"
                },
                "sha1": {
                  "description": "SHA1 hash",
                  "order": 2,
                  "title": "SHA1 Hash",
                  "type": "string"
                },
                "sha256": {
                  "description": "SHA256 hash",
                  "order": 3,
                  "title": "SHA256 Hash",
                  "type": "string"
                },
                "sha512": {
                  "description": "SHA512 hash",
                  "order": 4,
                  "title": "SHA512 Hash",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "d1befd02-7fe5-4504-9b16-440fd4658204": {
            "nodeId": "d1befd02-7fe5-4504-9b16-440fd4658204",
            "name": "Check Hash",
            "type": "action",
            "plugin": {
              "name": "Hybrid Analysis",
              "slugVendor": "rapid7",
              "slugName": "hybrid_analysis",
              "slugVersion": "2.0.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/hybrid_analysis/2.0.0/icon.png"
            },
            "identifier": "lookup_hash",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "hash": "{{[b56a1357-8ddb-43b5-af81-6592c15e30e4].[sha256]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "hash": {
                  "description": "MD5/SHA1/SHA256 Hash",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                }
              },
              "required": [
                "hash"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "report": {
                  "properties": {
                    "analysis_start_time": {
                      "order": 14,
                      "title": "Analysis Start Time",
                      "type": "string"
                    },
                    "compromised_hosts": {
                      "description": "Compromised Hosts",
                      "items": {
                        "type": "string"
                      },
                      "order": 18,
                      "title": "Compromised Hosts",
                      "type": "array"
                    },
                    "domains": {
                      "description": "Domains",
                      "items": {
                        "type": "string"
                      },
                      "order": 19,
                      "title": "Domains",
                      "type": "array"
                    },
                    "environmentDescription": {
                      "description": "Environment Description",
                      "order": 6,
                      "title": "EnvironmentDescription",
                      "type": "string"
                    },
                    "environment_id": {
                      "description": "Environment ID",
                      "order": 1,
                      "title": "Environment Id",
                      "type": "string"
                    },
                    "hosts": {
                      "description": "Hosts",
                      "items": {
                        "type": "string"
                      },
                      "order": 20,
                      "title": "Hosts",
                      "type": "array"
                    },
                    "isinteresting": {
                      "description": "Is Interesting",
                      "order": 16,
                      "title": "Isinteresting",
                      "type": "boolean"
                    },
                    "isurlanalysis": {
                      "order": 13,
                      "title": "Isurlanalysis",
                      "type": "boolean"
                    },
                    "md5": {
                      "description": "MD5",
                      "order": 3,
                      "title": "Md5",
                      "type": "string"
                    },
                    "multiscan_detectrate_pcnt": {
                      "order": 10,
                      "title": "Multiscan Detectrate Pcnt",
                      "type": "number"
                    },
                    "sha1": {
                      "description": "SHA1",
                      "order": 2,
                      "title": "Sha1",
                      "type": "string"
                    },
                    "sha256": {
                      "description": "SHA256",
                      "order": 4,
                      "title": "Sha256",
                      "type": "string"
                    },
                    "size": {
                      "description": "Size",
                      "order": 7,
                      "title": "Size",
                      "type": "integer"
                    },
                    "submitname": {
                      "description": "Submission Name",
                      "order": 5,
                      "title": "Submitname",
                      "type": "string"
                    },
                    "targeturl": {
                      "description": "Target URL",
                      "order": 9,
                      "title": "Targeturl",
                      "type": "string"
                    },
                    "threatlevel": {
                      "description": "Threat Level",
                      "order": 17,
                      "title": "Threatlevel",
                      "type": "integer"
                    },
                    "threatscore": {
                      "order": 15,
                      "title": "Threatscore",
                      "type": "integer"
                    },
                    "type": {
                      "description": "ASCII Text",
                      "order": 8,
                      "title": "Type",
                      "type": "string"
                    },
                    "virustotal_detectrate_pcnt": {
                      "description": "VT Detect Rate Percent",
                      "order": 12,
                      "title": "Virustotal Detectrate Pcnt",
                      "type": "number"
                    },
                    "virustotal_familyname": {
                      "description": "VT Family Name",
                      "order": 11,
                      "title": "Virustotal Familyname",
                      "type": "string"
                    }
                  },
                  "title": "Report",
                  "type": "object"
                }
              },
              "properties": {
                "found": {
                  "description": "True if found",
                  "order": 1,
                  "title": "Found",
                  "type": "boolean"
                },
                "reports": {
                  "description": "Reports",
                  "items": {
                    "$ref": "#/definitions/report"
                  },
                  "order": 3,
                  "title": "Reports",
                  "type": "array"
                },
                "threatscore": {
                  "description": "Threat Score (max found)",
                  "order": 2,
                  "title": "Threatscore",
                  "type": "integer"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "d20e0fc4-3587-4970-8afe-136824f7dc46": {
            "nodeId": "d20e0fc4-3587-4970-8afe-136824f7dc46",
            "name": "Is Email Malicious",
            "type": "action",
            "plugin": {
              "name": "Storage",
              "slugVendor": "rapid7",
              "slugName": "storage",
              "slugVersion": "1.0.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg"
            },
            "identifier": "retrieve",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "variable_name": "{{[20c2237a-ec86-4eeb-987e-d6e222c6d7e0].[content]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "variable_name": {
                  "description": "Variable to get value from",
                  "order": 1,
                  "title": "Variable Name",
                  "type": "string"
                }
              },
              "required": [
                "variable_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "value": {
                  "description": "Value",
                  "order": 1,
                  "title": "Variable Value",
                  "type": "string"
                }
              },
              "required": [
                "value"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "e44548ff-3920-4b39-a193-c8edb4f6c117": {
            "nodeId": "e44548ff-3920-4b39-a193-c8edb4f6c117",
            "name": "Block Sender from Org",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office365 Email Security",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email_security",
              "slugVersion": "2.1.0",
              "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email_security/2.1.0/icon.png"
            },
            "identifier": "block_sender_transport_rule",
            "continueOnFailure": false,
            "isDisabled": true,
            "parameters": {
              "input": {
                "domain_or_email_to_block": "{{[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[sender]}}",
                "transport_rule_name": "Block {{[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[sender]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "domain_or_email_to_block": {
                  "description": "Domain or email address to block",
                  "order": 1,
                  "title": "Domain or Email to Block",
                  "type": "string"
                },
                "transport_rule_name": {
                  "default": "InsightConnect Block List",
                  "description": "Transport rule name",
                  "order": 2,
                  "title": "Transport Rule Name",
                  "type": "string"
                }
              },
              "required": [
                "domain_or_email_to_block",
                "transport_rule_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result": {
                  "description": "Result",
                  "order": 1,
                  "title": "Result",
                  "type": "string"
                }
              },
              "required": [
                "result"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "f15c9ec4-4e01-4647-91cb-b84e04cdc67c": {
            "nodeId": "f15c9ec4-4e01-4647-91cb-b84e04cdc67c",
            "name": "Was overall mail malicious",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "7885e52a-a487-4510-9364-751a0efcff17",
              "stepControlParams": [
                {
                  "edgeId": "7885e52a-a487-4510-9364-751a0efcff17",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "fceaae38-58dd-4400-96b9-582929fcc93f",
                  "expression": {
                    "left": {
                      "name": "d20e0fc4-3587-4970-8afe-136824f7dc46.value",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": "true"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[d20e0fc4-3587-4970-8afe-136824f7dc46].[value]}} = \"true\""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "f245b7ef-24e7-4d6d-944c-f48355930e0d": {
            "nodeId": "f245b7ef-24e7-4d6d-944c-f48355930e0d",
            "name": "Malicious URL Report",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## Malicious URL Found\n\nURL: {{[f70e0bf7-cac7-4467-be3e-5fa3735ee28f].[$item]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "f70e0bf7-cac7-4467-be3e-5fa3735ee28f": {
            "nodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
            "name": "URL Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "innerEdgeId": "3ffbd486-f9e4-41dc-8651-99e69cc04489",
              "nextEdgeId": "721b924a-2524-4a9a-85b9-b3474697dcd9",
              "repeatVariable": "[5e08635d-9729-4867-9150-4d012f64b852].[urls]"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "defaultImageData": "https://us.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          }
        },
        "tags": null,
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": ""
      }
    ],
    "triggers": [
      {
        "id": "29c420dd-552a-4615-a944-93bc203c9796",
        "identifier": "email_received",
        "name": "Office 365 New Email Trigger",
        "description": "",
        "input": {
          "flatten_attachments": true,
          "folder_name": "Inbox",
          "interval": 15,
          "mailbox_id": "jschipp@komanddev.onmicrosoft.com",
          "subject_query": ""
        },
        "inputJsonSchema": {
          "properties": {
            "flatten_attachments": {
              "default": false,
              "description": "Will return all attachments as flat lists instead of nested emails",
              "order": 5,
              "title": "Flatten Attachments",
              "type": "boolean"
            },
            "folder_name": {
              "description": "Common values are Calendar, Trash, Drafts, Inbox, Outbox, Sent, Junk, Tasks, Contacts. You can also use a completely custom value, for example python_mailing_list. Mailbox names are case-sensitive",
              "order": 2,
              "title": "Folder Name",
              "type": "string"
            },
            "interval": {
              "default": 15,
              "description": "How often to poll for new email in seconds",
              "order": 3,
              "title": "Interval",
              "type": "integer"
            },
            "mailbox_id": {
              "description": "The mailbox to monitor for incoming email e.g. bob@hotmail.com",
              "order": 1,
              "title": "Mailbox ID",
              "type": "string"
            },
            "subject_query": {
              "default": "",
              "description": "Query to search for in subject (regex capable). Only these email will activate this trigger",
              "order": 4,
              "title": "Subject Query",
              "type": "string"
            }
          },
          "required": [
            "flatten_attachments",
            "mailbox_id"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "attachment_email": {
              "properties": {
                "account": {
                  "order": 9,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email_nested"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Categories",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 11,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 6,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 2,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Attachment Email",
              "type": "object"
            },
            "attachment_email_nested": {
              "properties": {
                "account": {
                  "order": 9,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email_nested_two"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Categories",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 11,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 6,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 2,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Attachment Email Nested",
              "type": "object"
            },
            "attachment_email_nested_two": {
              "properties": {
                "account": {
                  "order": 9,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "type": "object"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Categories",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 11,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 6,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 2,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Attachment Email Nested Two",
              "type": "object"
            },
            "attachment_file": {
              "properties": {
                "content": {
                  "order": 2,
                  "title": "Content",
                  "type": "string"
                },
                "content_type": {
                  "order": 3,
                  "title": "Content Type",
                  "type": "string"
                },
                "file_name": {
                  "order": 1,
                  "title": "File Name",
                  "type": "string"
                }
              },
              "title": "Attachment File",
              "type": "object"
            },
            "header": {
              "properties": {
                "name": {
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                },
                "value": {
                  "order": 2,
                  "title": "Value",
                  "type": "string"
                }
              },
              "title": "Header",
              "type": "object"
            },
            "icon_email": {
              "properties": {
                "account": {
                  "description": "Account for which the email was found on",
                  "order": 2,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 6,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 11,
                  "title": "Categories",
                  "type": "array"
                },
                "flattened_attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email"
                  },
                  "order": 9,
                  "title": "Flattened Attached Emails",
                  "type": "array"
                },
                "flattened_attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 10,
                  "title": "Flattened Attached Files",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 14,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 12,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "is_read": {
                  "description": "Whether or not the email has been read",
                  "order": 3,
                  "title": "Is Read",
                  "type": "boolean"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 13,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 4,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 5,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Icon Email",
              "type": "object"
            }
          },
          "properties": {
            "icon_email": {
              "$ref": "#/definitions/icon_email",
              "description": "Email",
              "order": 1,
              "title": "Email"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_plugin",
        "plugin": {
          "name": "Microsoft Office 365 Email",
          "slugVendor": "rapid7",
          "slugName": "microsoft_office365_email",
          "slugVersion": "4.0.0",
          "imageData": "https://us.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/4.0.0/icon.png"
        }
      }
    ]
  }
}